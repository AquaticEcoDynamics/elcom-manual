<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="This is a draft of the ELCOM manual.">

<title>7&nbsp; ELCOM Operation – ELCOM Manual</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-notation.html" rel="next">
<link href="./02-pre.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d9ea66fcd6c317012447f26e9c021348.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-pre.html">Using ELCOM</a></li><li class="breadcrumb-item"><a href="./03-elcom.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">ELCOM Operation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">ELCOM Manual</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Science Description</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sci-hydrodynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Hydrodynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sci-transport.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Transport and Mixing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sci-thermodynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Surface Thermodynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sci-turbulence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Turbulence Closure</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Using ELCOM</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-pre.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Pre-Processor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-elcom.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">ELCOM Operation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Notation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Examples</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-application.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">7.1</span> Introduction</a></li>
  <li><a href="#files-for-elcom" id="toc-files-for-elcom" class="nav-link" data-scroll-target="#files-for-elcom"><span class="header-section-number">7.2</span> Files for ELCOM</a></li>
  <li><a href="#simulation-modules" id="toc-simulation-modules" class="nav-link" data-scroll-target="#simulation-modules"><span class="header-section-number">7.3</span> Simulation modules</a>
  <ul class="collapse">
  <li><a href="#stratification" id="toc-stratification" class="nav-link" data-scroll-target="#stratification"><span class="header-section-number">7.3.1</span> Stratification</a></li>
  <li><a href="#tracers" id="toc-tracers" class="nav-link" data-scroll-target="#tracers"><span class="header-section-number">7.3.2</span> Tracers</a></li>
  <li><a href="#surface-thermodynamics" id="toc-surface-thermodynamics" class="nav-link" data-scroll-target="#surface-thermodynamics"><span class="header-section-number">7.3.3</span> Surface thermodynamics</a></li>
  <li><a href="#rain" id="toc-rain" class="nav-link" data-scroll-target="#rain"><span class="header-section-number">7.3.4</span> Rain</a></li>
  <li><a href="#wind" id="toc-wind" class="nav-link" data-scroll-target="#wind"><span class="header-section-number">7.3.5</span> Wind</a></li>
  <li><a href="#inflowoutflow" id="toc-inflowoutflow" class="nav-link" data-scroll-target="#inflowoutflow"><span class="header-section-number">7.3.6</span> Inflow/Outflow</a></li>
  <li><a href="#conservation-of-background-potential-energy" id="toc-conservation-of-background-potential-energy" class="nav-link" data-scroll-target="#conservation-of-background-potential-energy"><span class="header-section-number">7.3.7</span> Conservation of Background Potential Energy</a></li>
  <li><a href="#bubble-plume-destratification" id="toc-bubble-plume-destratification" class="nav-link" data-scroll-target="#bubble-plume-destratification"><span class="header-section-number">7.3.8</span> Bubble Plume Destratification</a></li>
  <li><a href="#underflow" id="toc-underflow" class="nav-link" data-scroll-target="#underflow"><span class="header-section-number">7.3.9</span> Underflow</a></li>
  <li><a href="#water-age-modelling" id="toc-water-age-modelling" class="nav-link" data-scroll-target="#water-age-modelling"><span class="header-section-number">7.3.10</span> Water Age Modelling</a></li>
  <li><a href="#drifters-particles" id="toc-drifters-particles" class="nav-link" data-scroll-target="#drifters-particles"><span class="header-section-number">7.3.11</span> Drifters / Particles</a></li>
  <li><a href="#jetspumps" id="toc-jetspumps" class="nav-link" data-scroll-target="#jetspumps"><span class="header-section-number">7.3.12</span> Jets/Pumps</a></li>
  <li><a href="#drafttubes" id="toc-drafttubes" class="nav-link" data-scroll-target="#drafttubes"><span class="header-section-number">7.3.13</span> Drafttubes</a></li>
  <li><a href="#non-hydrostatic-code" id="toc-non-hydrostatic-code" class="nav-link" data-scroll-target="#non-hydrostatic-code"><span class="header-section-number">7.3.14</span> Non-hydrostatic code</a></li>
  </ul></li>
  <li><a href="#sec-initfiles" id="toc-sec-initfiles" class="nav-link" data-scroll-target="#sec-initfiles"><span class="header-section-number">7.4</span> Initialization</a>
  <ul class="collapse">
  <li><a href="#uniform-initial-conditions" id="toc-uniform-initial-conditions" class="nav-link" data-scroll-target="#uniform-initial-conditions"><span class="header-section-number">7.4.1</span> Uniform initial conditions</a></li>
  <li><a href="#vertical-profile" id="toc-vertical-profile" class="nav-link" data-scroll-target="#vertical-profile"><span class="header-section-number">7.4.2</span> Vertical Profile</a></li>
  <li><a href="#sec-multiProf" id="toc-sec-multiProf" class="nav-link" data-scroll-target="#sec-multiProf"><span class="header-section-number">7.4.3</span> Multiple Vertical Profiles</a></li>
  <li><a href="#horizontal-variation" id="toc-horizontal-variation" class="nav-link" data-scroll-target="#horizontal-variation"><span class="header-section-number">7.4.4</span> Horizontal Variation</a></li>
  <li><a href="#user-subroutines" id="toc-user-subroutines" class="nav-link" data-scroll-target="#user-subroutines"><span class="header-section-number">7.4.5</span> User subroutines</a></li>
  </ul></li>
  <li><a href="#configuration-controls" id="toc-configuration-controls" class="nav-link" data-scroll-target="#configuration-controls"><span class="header-section-number">7.5</span> Configuration controls</a>
  <ul class="collapse">
  <li><a href="#time-step" id="toc-time-step" class="nav-link" data-scroll-target="#time-step"><span class="header-section-number">7.5.1</span> Time step</a></li>
  <li><a href="#number-of-steps" id="toc-number-of-steps" class="nav-link" data-scroll-target="#number-of-steps"><span class="header-section-number">7.5.2</span> Number of steps</a></li>
  <li><a href="#start-date" id="toc-start-date" class="nav-link" data-scroll-target="#start-date"><span class="header-section-number">7.5.3</span> Start date</a></li>
  <li><a href="#cgm-tolerance" id="toc-cgm-tolerance" class="nav-link" data-scroll-target="#cgm-tolerance"><span class="header-section-number">7.5.4</span> CGM tolerance</a></li>
  <li><a href="#turbulence" id="toc-turbulence" class="nav-link" data-scroll-target="#turbulence"><span class="header-section-number">7.5.5</span> Turbulence</a></li>
  </ul></li>
  <li><a href="#output-frequency" id="toc-output-frequency" class="nav-link" data-scroll-target="#output-frequency"><span class="header-section-number">7.6</span> Output frequency</a></li>
  <li><a href="#sec-runelcom" id="toc-sec-runelcom" class="nav-link" data-scroll-target="#sec-runelcom"><span class="header-section-number">7.7</span> Configuration using file <code>run_elcom.dat</code></a>
  <ul class="collapse">
  <li><a href="#file-headers" id="toc-file-headers" class="nav-link" data-scroll-target="#file-headers"><span class="header-section-number">7.7.1</span> File headers</a></li>
  <li><a href="#simulation-module-controls" id="toc-simulation-module-controls" class="nav-link" data-scroll-target="#simulation-module-controls"><span class="header-section-number">7.7.2</span> Simulation module controls</a></li>
  <li><a href="#initialization-and-update-options" id="toc-initialization-and-update-options" class="nav-link" data-scroll-target="#initialization-and-update-options"><span class="header-section-number">7.7.3</span> Initialization and update options</a></li>
  <li><a href="#turbulence-modeling" id="toc-turbulence-modeling" class="nav-link" data-scroll-target="#turbulence-modeling"><span class="header-section-number">7.7.4</span> Turbulence modeling</a></li>
  <li><a href="#meteorological-sensor-heights" id="toc-meteorological-sensor-heights" class="nav-link" data-scroll-target="#meteorological-sensor-heights"><span class="header-section-number">7.7.5</span> Meteorological Sensor Heights</a></li>
  <li><a href="#model-settings-and-controls" id="toc-model-settings-and-controls" class="nav-link" data-scroll-target="#model-settings-and-controls"><span class="header-section-number">7.7.6</span> Model Settings and Controls</a></li>
  <li><a href="#scalar-maximum-and-minimum-for-debugging" id="toc-scalar-maximum-and-minimum-for-debugging" class="nav-link" data-scroll-target="#scalar-maximum-and-minimum-for-debugging"><span class="header-section-number">7.7.7</span> Scalar Maximum and Minimum for Debugging</a></li>
  <li><a href="#debugging-controls" id="toc-debugging-controls" class="nav-link" data-scroll-target="#debugging-controls"><span class="header-section-number">7.7.8</span> Debugging controls</a></li>
  <li><a href="#output-frequency-1" id="toc-output-frequency-1" class="nav-link" data-scroll-target="#output-frequency-1"><span class="header-section-number">7.7.9</span> Output Frequency</a></li>
  <li><a href="#output-start-time" id="toc-output-start-time" class="nav-link" data-scroll-target="#output-start-time"><span class="header-section-number">7.7.10</span> Output Start Time</a></li>
  <li><a href="#time-controls" id="toc-time-controls" class="nav-link" data-scroll-target="#time-controls"><span class="header-section-number">7.7.11</span> Time Controls</a></li>
  <li><a href="#iterative-solver-controls" id="toc-iterative-solver-controls" class="nav-link" data-scroll-target="#iterative-solver-controls"><span class="header-section-number">7.7.12</span> Iterative Solver Controls</a></li>
  <li><a href="#scalar-filtering" id="toc-scalar-filtering" class="nav-link" data-scroll-target="#scalar-filtering"><span class="header-section-number">7.7.13</span> Scalar Filtering</a></li>
  <li><a href="#default-values" id="toc-default-values" class="nav-link" data-scroll-target="#default-values"><span class="header-section-number">7.7.14</span> Default Values</a></li>
  <li><a href="#input-file-names" id="toc-input-file-names" class="nav-link" data-scroll-target="#input-file-names"><span class="header-section-number">7.7.15</span> Input File Names</a></li>
  <li><a href="#file-directories" id="toc-file-directories" class="nav-link" data-scroll-target="#file-directories"><span class="header-section-number">7.7.16</span> File Directories</a></li>
  <li><a href="#output-file-names" id="toc-output-file-names" class="nav-link" data-scroll-target="#output-file-names"><span class="header-section-number">7.7.17</span> Output File Names</a></li>
  </ul></li>
  <li><a href="#input-files" id="toc-input-files" class="nav-link" data-scroll-target="#input-files"><span class="header-section-number">7.8</span> Input files</a>
  <ul class="collapse">
  <li><a href="#sparsedata.unf-and-usedata.unf" id="toc-sparsedata.unf-and-usedata.unf" class="nav-link" data-scroll-target="#sparsedata.unf-and-usedata.unf"><span class="header-section-number">7.8.1</span> sparsedata.unf and usedata.unf</a></li>
  <li><a href="#sec-tempBCfiles" id="toc-sec-tempBCfiles" class="nav-link" data-scroll-target="#sec-tempBCfiles"><span class="header-section-number">7.8.2</span> Temporal boundary condition (1D) files</a></li>
  <li><a href="#temporal-profile-boundary-condition-2d-files" id="toc-temporal-profile-boundary-condition-2d-files" class="nav-link" data-scroll-target="#temporal-profile-boundary-condition-2d-files"><span class="header-section-number">7.8.3</span> Temporal profile boundary condition (2D) files</a></li>
  <li><a href="#sec-updateBCfiles" id="toc-sec-updateBCfiles" class="nav-link" data-scroll-target="#sec-updateBCfiles"><span class="header-section-number">7.8.4</span> Update boundary condition files</a></li>
  <li><a href="#sec-tempFiltFiles" id="toc-sec-tempFiltFiles" class="nav-link" data-scroll-target="#sec-tempFiltFiles"><span class="header-section-number">7.8.5</span> Temporal filter constant files</a></li>
  <li><a href="#drifter-files" id="toc-drifter-files" class="nav-link" data-scroll-target="#drifter-files"><span class="header-section-number">7.8.6</span> Drifter files</a></li>
  <li><a href="#drifter-initial-files" id="toc-drifter-initial-files" class="nav-link" data-scroll-target="#drifter-initial-files"><span class="header-section-number">7.8.7</span> Drifter Initial Files</a></li>
  <li><a href="#valid-keywords" id="toc-valid-keywords" class="nav-link" data-scroll-target="#valid-keywords"><span class="header-section-number">7.8.8</span> Valid keywords:</a></li>
  <li><a href="#drifter-update-files" id="toc-drifter-update-files" class="nav-link" data-scroll-target="#drifter-update-files"><span class="header-section-number">7.8.9</span> Drifter Update Files</a></li>
  <li><a href="#valid-keywords-for-updates" id="toc-valid-keywords-for-updates" class="nav-link" data-scroll-target="#valid-keywords-for-updates"><span class="header-section-number">7.8.10</span> Valid keywords for updates:</a></li>
  <li><a href="#jet-files" id="toc-jet-files" class="nav-link" data-scroll-target="#jet-files"><span class="header-section-number">7.8.11</span> Jet Files</a></li>
  <li><a href="#drafttube-files" id="toc-drafttube-files" class="nav-link" data-scroll-target="#drafttube-files"><span class="header-section-number">7.8.12</span> Drafttube Files</a></li>
  </ul></li>
  <li><a href="#definition-of-culvert-characteristics-dynamic-boundary-conditions" id="toc-definition-of-culvert-characteristics-dynamic-boundary-conditions" class="nav-link" data-scroll-target="#definition-of-culvert-characteristics-dynamic-boundary-conditions"><span class="header-section-number">7.9</span> Definition of Culvert Characteristics – Dynamic Boundary Conditions</a>
  <ul class="collapse">
  <li><a href="#supported-culvert-keywords-and-defaults" id="toc-supported-culvert-keywords-and-defaults" class="nav-link" data-scroll-target="#supported-culvert-keywords-and-defaults"><span class="header-section-number">7.9.1</span> Supported Culvert Keywords and Defaults</a></li>
  <li><a href="#example-file" id="toc-example-file" class="nav-link" data-scroll-target="#example-file"><span class="header-section-number">7.9.2</span> Example File</a></li>
  <li><a href="#sec-datablock" id="toc-sec-datablock" class="nav-link" data-scroll-target="#sec-datablock"><span class="header-section-number">7.9.3</span> Output definition file (Datablock.db)</a></li>
  <li><a href="#group-time-list" id="toc-group-time-list" class="nav-link" data-scroll-target="#group-time-list"><span class="header-section-number">7.9.4</span> Group Time List</a></li>
  <li><a href="#set-cell-data" id="toc-set-cell-data" class="nav-link" data-scroll-target="#set-cell-data"><span class="header-section-number">7.9.5</span> Set Cell Data</a></li>
  </ul></li>
  <li><a href="#sec-runexe" id="toc-sec-runexe" class="nav-link" data-scroll-target="#sec-runexe"><span class="header-section-number">7.10</span> Running ELCOM</a>
  <ul class="collapse">
  <li><a href="#sec-postproc" id="toc-sec-postproc" class="nav-link" data-scroll-target="#sec-postproc"><span class="header-section-number">7.10.1</span> Post-Processing</a></li>
  </ul></li>
  <li><a href="#save-and-restart-output-files" id="toc-save-and-restart-output-files" class="nav-link" data-scroll-target="#save-and-restart-output-files"><span class="header-section-number">7.11</span> Save and Restart output files</a></li>
  <li><a href="#culvert-outputs---dynamic-boundary-conditions" id="toc-culvert-outputs---dynamic-boundary-conditions" class="nav-link" data-scroll-target="#culvert-outputs---dynamic-boundary-conditions"><span class="header-section-number">7.12</span> Culvert Outputs - Dynamic Boundary Conditions</a></li>
  <li><a href="#sec-validScalars" id="toc-sec-validScalars" class="nav-link" data-scroll-target="#sec-validScalars"><span class="header-section-number">7.13</span> ELCOM Valid Scalars</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-pre.html">Using ELCOM</a></li><li class="breadcrumb-item"><a href="./03-elcom.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">ELCOM Operation</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-elcom" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">ELCOM Operation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">7.1</span> Introduction</h2>
<p>Running an ELCOM simulation requires the user to provide several types of data:</p>
<ol type="1">
<li>Initial conditions</li>
<li>Temporal boundary conditions</li>
<li>Configuration parameters</li>
<li>Output control</li>
</ol>
<p>ELCOM obtains this data from the user through user-prepared input files and pre-processor prepared input files.</p>
</section>
<section id="files-for-elcom" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="files-for-elcom"><span class="header-section-number">7.2</span> Files for ELCOM</h2>
<p>ELCOM is a command-line executable that communicates with the user through files. <a href="#tbl-elcomFiles" class="quarto-xref">Table&nbsp;<span>7.1</span></a> provides a summary of file types, whether their presence is required or optional, the purpose of the file, and responsibility for preparation of the file.</p>
<ul>
<li>File names in <code>courier bold</code> font without brackets are fixed named files (i.e., the file must be present with exactly that name).</li>
<li>File names such as <code>[data_name].unf</code> use square brackets to indicate that ELCOM may substitute various names in the bracketed section (see following sections).</li>
<li>File names such as <em><datablock></datablock></em>.db use angle brackets to indicate sections of file names that the user can customize at the command line.</li>
</ul>
<div class="cell">
<div id="tbl-elcomFiles" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-elcomFiles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.1: Files for ELCOM.
</figcaption>
<div aria-describedby="tbl-elcomFiles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 31%">
<col style="width: 10%">
<col style="width: 31%">
<col style="width: 16%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">File.Name</th>
<th style="text-align: left;">Presence</th>
<th style="text-align: left;">Usage</th>
<th style="text-align: left;">Preparation</th>
<th style="text-align: left;">Number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>run_elcom.dat</code></td>
<td style="text-align: left;">required</td>
<td style="text-align: left;">configuration control</td>
<td style="text-align: left;">user</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><em><datablock></datablock></em>.db</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">output control</td>
<td style="text-align: left;">user</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em><environment></environment></em>.dat</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">boundary control</td>
<td style="text-align: left;">user</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;"><em><initial></initial></em>.dat</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">initial condition</td>
<td style="text-align: left;">user</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em><update></update></em>.dat</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">scalar updates</td>
<td style="text-align: left;">user</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;"><em><drifter_properties></drifter_properties></em>.dat</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">drifter properties</td>
<td style="text-align: left;">user</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em><drifter_initial></drifter_initial></em>.dat</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">drifter initial conditions</td>
<td style="text-align: left;">user</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;"><em><drifter_update></drifter_update></em>.dat</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">drifter updates</td>
<td style="text-align: left;">user</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em><jet></jet></em>.dat</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">jet/pump file</td>
<td style="text-align: left;">user</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;"><em><drafttube></drafttube></em>.dat</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">drafttube file</td>
<td style="text-align: left;">user</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em><filter></filter></em>.dat</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">temporal filter constants</td>
<td style="text-align: left;">user</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;"><em><sparsedata></sparsedata></em>.unf</td>
<td style="text-align: left;">required</td>
<td style="text-align: left;">geometry data</td>
<td style="text-align: left;">pre-processor</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em><usedata></usedata></em>.unf</td>
<td style="text-align: left;">required</td>
<td style="text-align: left;">geometry data</td>
<td style="text-align: left;">pre-processor</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><em><group_name></group_name></em>.unf</td>
<td style="text-align: left;">output</td>
<td style="text-align: left;">datablock output</td>
<td style="text-align: left;">ELCOM</td>
<td style="text-align: left;">no limit</td>
</tr>
<tr class="odd">
<td style="text-align: left;">[data_name].unf</td>
<td style="text-align: left;">output</td>
<td style="text-align: left;">3D data type output</td>
<td style="text-align: left;">ELCOM</td>
<td style="text-align: left;">no limit</td>
</tr>
<tr class="even">
<td style="text-align: left;">[time_]<em><save></save></em>.unf</td>
<td style="text-align: left;">output</td>
<td style="text-align: left;">simulation space output</td>
<td style="text-align: left;">ELCOM</td>
<td style="text-align: left;">no limit</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em><restart_out></restart_out></em>.unf</td>
<td style="text-align: left;">output</td>
<td style="text-align: left;">restart file</td>
<td style="text-align: left;">ELCOM</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>elcom.exe</code></td>
<td style="text-align: left;">required</td>
<td style="text-align: left;">executable</td>
<td style="text-align: left;">make</td>
<td style="text-align: left;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="simulation-modules" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="simulation-modules"><span class="header-section-number">7.3</span> Simulation modules</h2>
<p>ELCOM is organized into simulation modules that can be turned off/on depending on the type of simulation that is desired. A module is turned off/on by setting the value of control keywords. This is done within the <code>run_elcom.dat</code> file. These controls provide a simple method for modifying the simulation.</p>
<p>For example: a boundary condition file can be set up to include both meteorological data and inflow data. As a simple test, the user decides to turn off the inflow. One approach would be to return to the pre-processor, eliminate the inflow boundary cell set, re-run the pre-processor, then modify the temporal boundary condition file to remove the inflow data. As a simpler approach, the user need only set <code>iflow = 0</code>, and the inflow data and boundary cell sets will be ignored.</p>
<p>This section provides a brief overview of the modules within <code>ELCOM</code> and their corresponding keywords set within the <code>run_elcom.dat</code> file.</p>
<section id="stratification" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="stratification"><span class="header-section-number">7.3.1</span> Stratification</h3>
<p>Density stratification in ELCOM can be through temperature, salinity, or both by using the controls <code>itemperature</code> and <code>isalinity</code> in combination with <code>idensity = 1</code>. If desired, temperature and salinity can be treated as passive tracers by setting <code>idensity = 0</code>. If temperature and/or salinity are turned on, they must be initialized throughout the simulation domain using the <code>default_***</code> controls, initial condition files, or associated subroutines in <code>elcom_user.f90</code>.</p>
</section>
<section id="tracers" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="tracers"><span class="header-section-number">7.3.2</span> Tracers</h3>
<p>Up to 10 passive tracers may be transported in a simulation. They may be initialized in the domain using initial condition files or may flow into the domain through an inflow boundary using keywords <code>TRACER_**</code> in a temporal boundary condition file.</p>
</section>
<section id="surface-thermodynamics" class="level3" data-number="7.3.3">
<h3 data-number="7.3.3" class="anchored" data-anchor-id="surface-thermodynamics"><span class="header-section-number">7.3.3</span> Surface thermodynamics</h3>
<p>This module controls the heat transfer across the free surface. Required inputs (in temporal boundary condition files) include: solar radiation, wind speed, air temperature, and relative humidity.</p>
</section>
<section id="rain" class="level3" data-number="7.3.4">
<h3 data-number="7.3.4" class="anchored" data-anchor-id="rain"><span class="header-section-number">7.3.4</span> Rain</h3>
<p>The rain module controls rain input into the free surface. Rain data in <em>m/day</em> must be provided in a temporal boundary condition file.</p>
</section>
<section id="wind" class="level3" data-number="7.3.5">
<h3 data-number="7.3.5" class="anchored" data-anchor-id="wind"><span class="header-section-number">7.3.5</span> Wind</h3>
<p>Wind affects ELCOM simulations in three ways:</p>
<ol type="1">
<li>Evaporative cooling in the surface thermodynamics module</li>
<li>Wind stress on the free surface</li>
<li>Wind-induced momentum source in the wind-mixed layer</li>
</ol>
<p>Use <code>WIND_SPEED</code> and <code>WIND_DIR</code> (linked to boundary cell set 0 for uniform application) or define multiple sections via <code>section_top</code> in <code>bc.dat</code>. ELCOM interpolates wind speed and direction in time. Vector interpolation isn’t supported, so consistent time intervals are recommended. Alternatively, use <code>WIND_U</code> and <code>WIND_V</code>.</p>
</section>
<section id="inflowoutflow" class="level3" data-number="7.3.6">
<h3 data-number="7.3.6" class="anchored" data-anchor-id="inflowoutflow"><span class="header-section-number">7.3.6</span> Inflow/Outflow</h3>
<p>Inflow/outflow boundaries must be defined in <code>bc.dat</code>. Temporal boundary conditions for flow rate must be provided. Inflow conditions must also include scalar values.</p>
</section>
<section id="conservation-of-background-potential-energy" class="level3" data-number="7.3.7">
<h3 data-number="7.3.7" class="anchored" data-anchor-id="conservation-of-background-potential-energy"><span class="header-section-number">7.3.7</span> Conservation of Background Potential Energy</h3>
<p>Numerical diffusion can destratify the domain, increasing background potential energy. A vertical sharpening filter can conserve energy but not mass. The filter applies to salinity (<code>IFILTER = 2</code>) or temperature (<code>IFILTER = 3</code>). Alternatively, use <code>FILTER_&lt;SCALAR&gt;</code> in <code>run_elcom.dat</code> with <code>IFILTER = 1</code>. Temporally varying filters are also supported.</p>
</section>
<section id="bubble-plume-destratification" class="level3" data-number="7.3.8">
<h3 data-number="7.3.8" class="anchored" data-anchor-id="bubble-plume-destratification"><span class="header-section-number">7.3.8</span> Bubble Plume Destratification</h3>
<p>To simulate bubble destratification, define outlet locations in <code>bc.dat</code>. Temporal boundary conditions must specify airflow rates and the number of ports.</p>
</section>
<section id="underflow" class="level3" data-number="7.3.9">
<h3 data-number="7.3.9" class="anchored" data-anchor-id="underflow"><span class="header-section-number">7.3.9</span> Underflow</h3>
<p>To simulate dense inflow using Dallimore et al.&nbsp;(2001)’s 2D model, define inflow boundaries and temporal conditions, including <code>INFLOW_HEIGHT</code>. Set <code>IUNDERFLOW</code> in <code>run_elcom.dat</code>. <strong>Note:</strong> Not compatible with CAEDYM.</p>
</section>
<section id="water-age-modelling" class="level3" data-number="7.3.10">
<h3 data-number="7.3.10" class="anchored" data-anchor-id="water-age-modelling"><span class="header-section-number">7.3.10</span> Water Age Modelling</h3>
<p>Enable using <code>IRETENTION</code> in <code>run_elcom.dat</code>. Water age starts at zero and increments by <code>del_t</code> each timestep. Transported as a scalar.</p>
</section>
<section id="drifters-particles" class="level3" data-number="7.3.11">
<h3 data-number="7.3.11" class="anchored" data-anchor-id="drifters-particles"><span class="header-section-number">7.3.11</span> Drifters / Particles</h3>
<p>Simulate Lagrangian or semi-Lagrangian particles using <code>NDRIFTERS</code> in <code>run_elcom.dat</code>. Define properties in <code>drifter_properties_file</code> and <code>drifter_in_file</code>. Updates via <code>update_drifter_file</code>.</p>
</section>
<section id="jetspumps" class="level3" data-number="7.3.12">
<h3 data-number="7.3.12" class="anchored" data-anchor-id="jetspumps"><span class="header-section-number">7.3.12</span> Jets/Pumps</h3>
<p>To simulate jet/pump destratification, provide thrust, radius, and depth data in jet files. Controlled via <code>IJET</code> in <code>run_elcom.dat</code>.</p>
</section>
<section id="drafttubes" class="level3" data-number="7.3.13">
<h3 data-number="7.3.13" class="anchored" data-anchor-id="drafttubes"><span class="header-section-number">7.3.13</span> Drafttubes</h3>
<p>For destratification impellors with draft tubes, specify thrust, radius, depth, and tube length in drafttube files. Controlled via <code>ITUBE</code> in <code>run_elcom.dat</code>.</p>
</section>
<section id="non-hydrostatic-code" class="level3" data-number="7.3.14">
<h3 data-number="7.3.14" class="anchored" data-anchor-id="non-hydrostatic-code"><span class="header-section-number">7.3.14</span> Non-hydrostatic code</h3>
<p>To simulate non-hydrostatic pressure effects (as in Bothel et al.), note that finer horizontal resolution (~10m) is required and simulation runtime increases significantly.</p>
</section>
</section>
<section id="sec-initfiles" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="sec-initfiles"><span class="header-section-number">7.4</span> Initialization</h2>
<section id="uniform-initial-conditions" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="uniform-initial-conditions"><span class="header-section-number">7.4.1</span> Uniform initial conditions</h3>
<p>For simple initial conditions (e.g., distributing a scalar or setting a flat surface), use <code>DEFAULT_****</code> keywords in <code>run_elcom.dat</code>. Default values can be overwritten by profile or horizontal files or initialization subroutines.</p>
</section>
<section id="vertical-profile" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="vertical-profile"><span class="header-section-number">7.4.2</span> Vertical Profile</h3>
<p>Vertical scalar variation is defined using <code>initial_profile_file</code> (in the <code>infiles</code> directory). Format:</p>
<ul>
<li>Four header lines:
<ol type="1">
<li>Number of datasets (excluding depth)</li>
<li>Number of depths (first column is <code>DEPTH</code>)</li>
<li>i and j coordinates</li>
<li>Column keywords (first must be <code>DEPTH</code>, rest valid scalar keywords)</li>
</ol></li>
<li>Data rows: Depth (in meters) and scalar values.</li>
<li>Depths must start at zero and increase monotonically.</li>
<li>Linear interpolation is used during simulation.</li>
</ul>
<blockquote class="blockquote">
<p>Comments (<code>!</code>) can appear at the top of the file but not within the data block. Comment rows in headers must match column count.</p>
</blockquote>
<pre class="plaintext"><code>! Example: ic.dat
2   data sets
4   number of depths
15 20   i,j
DEPTH   WTR_TEMP    SALINITY
0.0     25.0        0.0
5.1     23.1        15.1
6.2     20.2        35.0
10.4    18.3        35.2</code></pre>
</section>
<section id="sec-multiProf" class="level3" data-number="7.4.3">
<h3 data-number="7.4.3" class="anchored" data-anchor-id="sec-multiProf"><span class="header-section-number">7.4.3</span> Multiple Vertical Profiles</h3>
<p>To increase the flexibility of initialization, ELCOM Version 2 allows for multiple profile initial condition files. If more than one initial condition file is specified for any scalar, then ELCOM interpolates between files to initialize the domain. Each profile is first linearly interpolated onto the vertical layers, and then each point is horizontally interpolated using the inverse distance weighting method such that</p>
<p><span class="math display">\[
S_{i,j,k} = \sum_{n=1}^N \frac{S_{n,k}r_{n}^\alpha}{r_{n}^\alpha}
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is the distance weighting specified by the flag <code>IC_DIST_WEIGHTING</code> in <code>run_elcom.dat</code> (default = 2.0), <span class="math inline">\(r\)</span> is the distance between the column and profile <span class="math inline">\(n\)</span>, and <span class="math inline">\(N\)</span> is the number of profiles.</p>
</section>
<section id="horizontal-variation" class="level3" data-number="7.4.4">
<h3 data-number="7.4.4" class="anchored" data-anchor-id="horizontal-variation"><span class="header-section-number">7.4.4</span> Horizontal Variation</h3>
<p>A horizontal variation in the initial conditions for any valid transportable scalar can be defined using an input file (keyword = <code>initial_horiz_file</code>). The input file may have any name but must be located in the <code>infiles</code> directory.</p>
<p>These files require a format that consists of three header lines followed by a value for each <code>(i,j)</code> column of the domain. The file may have as many comment lines (preceded by <code>!</code>) at the top of the file as desired. Comment lines within the header data must have as many items as there are columns (i.e., if there are 3 columns, a valid comment line is <code>!  - -</code>). No comment lines are allowed within the columns of data. The columns must be completely dense with data (i.e., there may not be “missing” data such that a row has fewer items than the number of columns).</p>
<p>The first header line contains two numbers: the number of x rows and the number of y columns. These must match the number of rows and columns in the bathymetry file.</p>
<p>The second line gives a land value for land cells.</p>
<p>The third line in the header contains the keyword that describes the scalar to be initialized. This keyword should be a valid transportable scalar given in the Valid Scalars table in <a href="#sec-validScalars" class="quarto-xref"><span>Section 7.13</span></a>.</p>
<p>The remaining lines in the file contain the data. The matrix should be the same size as the bathymetry data in your bathymetry file.</p>
<pre class="plaintext"><code>! Example:  ic.dat
8 13    xrows   yrows
1e+16   land    val
SALINITY
1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16
1e+16 1e+16   9.0   9.5 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16
1e+16   8.1   8.5   9.3   9.5  10.0  10.2  11.0  11.6  11.8 1e+16 1e+16 1e+16
1e+16   8.0   8.5   9.2   9.5  10.0  10.3  10.6  11.3  11.6  11.8  12.0 1e+16
1e+16   8.0   8.5   9.1   9.3   9.5   9.5   9.7   9.8  10.0  10.2  11.2 1e+16
1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16  10.0  10.0  10.5 1e+16
1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16   9.1   9.2   9.5 1e+16
1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16</code></pre>
</section>
<section id="user-subroutines" class="level3" data-number="7.4.5">
<h3 data-number="7.4.5" class="anchored" data-anchor-id="user-subroutines"><span class="header-section-number">7.4.5</span> User subroutines</h3>
<p>For ELCOM users who are willing to modify and compile source code, the ability to set up complex initial conditions is available through the addition of code to subroutines in the <code>elcom_user.f90</code> file. The subroutines in this file are only called if the appropriate <code>user_init_***</code> control in the <code>run_elcom.dat</code> file is non-zero.</p>
<p>The stub routines supplied with ELCOM are designed to be executed with the <code>user_init_***</code> controls set to 1. However, this can be modified by the user so that different initializations are performed for different values of <code>user_init_***</code>.</p>
</section>
</section>
<section id="configuration-controls" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="configuration-controls"><span class="header-section-number">7.5</span> Configuration controls</h2>
<section id="time-step" class="level3" data-number="7.5.1">
<h3 data-number="7.5.1" class="anchored" data-anchor-id="time-step"><span class="header-section-number">7.5.1</span> Time step</h3>
<p>The time step (keyword = <code>del_t</code>) is the number of seconds that the simulation advances in time for each simulation step.</p>
</section>
<section id="number-of-steps" class="level3" data-number="7.5.2">
<h3 data-number="7.5.2" class="anchored" data-anchor-id="number-of-steps"><span class="header-section-number">7.5.2</span> Number of steps</h3>
<p>The total number of time steps to be computed in the present simulation run is set using the keyword <code>iter_max</code> in the <code>run_elcom.dat</code> file.</p>
</section>
<section id="start-date" class="level3" data-number="7.5.3">
<h3 data-number="7.5.3" class="anchored" data-anchor-id="start-date"><span class="header-section-number">7.5.3</span> Start date</h3>
<p>The start date is entered in <strong>CWR Julian Day</strong> format, which specifies the year and day using a real number with 7 digits to the left of the decimal place as <code>yyyyddd.ddd</code>. The first 4 digits are the year and the subsequent 3 digits are the Julian Day (days since January 1st). Hours, minutes, and seconds are represented as fractions of a day (e.g., 1 AM on January 1st, 2000 is represented as <code>2000001.041667</code>).</p>
</section>
<section id="cgm-tolerance" class="level3" data-number="7.5.4">
<h3 data-number="7.5.4" class="anchored" data-anchor-id="cgm-tolerance"><span class="header-section-number">7.5.4</span> CGM tolerance</h3>
<p>The <code>CGM_TOL</code> is the residual at which iteration of the <strong>conjugate gradient method</strong> (used for the free-surface solution) is stopped.</p>
</section>
<section id="turbulence" class="level3" data-number="7.5.5">
<h3 data-number="7.5.5" class="anchored" data-anchor-id="turbulence"><span class="header-section-number">7.5.5</span> Turbulence</h3>
<p>For stratified flow, the base closure scheme can be supplemented by unstable mixing (<code>iclosure = 1</code>) algorithms. The unstable mixing algorithm mixes momentum and transported scalars in vertical cells where an unstable gradient of potential density exists (i.e., Ri &lt; 0.0).</p>
<p>For stratified flows driven by surface wind, the <strong>wind-mixed-layer closure scheme with energy transport</strong> (<code>iclosure = 6</code>) is recommended. This approach computes the turbulent kinetic energy due to wind stirring, convective overturns, and wind shear, then uses this to compute vertical mixing.</p>
</section>
</section>
<section id="output-frequency" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="output-frequency"><span class="header-section-number">7.6</span> Output frequency</h2>
<p>Outputs of data that are not controlled by the datablock file are set through the <code>iter_out_***</code> and <code>start_output_***</code> keywords. The former controls the time step interval for providing output, while the latter controls the first step on which output will be provided.</p>
</section>
<section id="sec-runelcom" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="sec-runelcom"><span class="header-section-number">7.7</span> Configuration using file <code>run_elcom.dat</code></h2>
<p>An up-to-date copy of <code>run_elcom.dat</code> is included in the examples.</p>
<p>ELCOM looks for the file <code>run_elcom.dat</code> in the local directory to set the configuration of the simulation run. The <code>run_elcom.dat</code> configuration file controls execution of optional modules and models within ELCOM, allowing the user to set the parameters that govern the physical and numerical simulation.</p>
<p>The format of the file is flexible: lines may occur in any order, and not all items must be present. Comment lines (preceded by <code>!</code>) may occur anywhere in the file. <strong>Blank lines are not allowed</strong> in the file (the code stops reading at a blank line). Each line (including comment lines) must have at least two items separated by a blank space.</p>
<p>The comment marker <code>!</code> counts as an item, so a valid line is <code>!  !</code> or <code>! -</code>, while <code>!!</code> (no space between) is not valid.</p>
<p>The general format for the file is a series of lines, with each line listing a user setting followed by a keyword that defines the parameter. The individual keywords and settings are explained briefly below:</p>
<section id="file-headers" class="level3" data-number="7.7.1">
<h3 data-number="7.7.1" class="anchored" data-anchor-id="file-headers"><span class="header-section-number">7.7.1</span> File headers</h3>
<ul>
<li><code>FILE</code>: file name for this file (must be <code>run_elcom.dat</code>)</li>
<li><code>ANALYST</code>: user name (must be inside single quotes <code>' '</code>)</li>
<li><code>ORGANIZATION</code>: user company name (must be inside single quotes <code>' '</code>)</li>
<li><code>COMMENT</code>: user comment (must be inside single quotes <code>' '</code>)</li>
<li><code>CASE_KEYWORD</code>: allows user to add code to be executed for a particular simulation case. Must be a string without blank spaces enclosed in single quotes.</li>
</ul>
</section>
<section id="simulation-module-controls" class="level3" data-number="7.7.2">
<h3 data-number="7.7.2" class="anchored" data-anchor-id="simulation-module-controls"><span class="header-section-number">7.7.2</span> Simulation module controls</h3>
<ul>
<li><code>iheat_input</code>: controls surface thermodynamics
<ul>
<li>0 = no surface thermodynamics</li>
<li>1 = surface thermodynamics model (input solar radiation is measured; longwave model determined by input keywords)</li>
</ul></li>
<li><code>iatmstability</code>: controls atmospheric stability correction in thermodynamics
<ul>
<li>0 = no correction</li>
<li>1 = apply correction</li>
</ul></li>
<li><code>irain</code>: controls rainfall input
<ul>
<li>0 = no rain</li>
<li>1 = rain enabled</li>
</ul></li>
<li><code>iflow</code>: controls inflow/outflow (Dirichlet boundaries); overrides boundary condition files
<ul>
<li>0 = no inflow/outflow</li>
<li>1 = inflow/outflow model 1</li>
</ul></li>
<li><code>iunderflow</code>: controls 2D underflow model; overrides boundary condition files
<ul>
<li>0 = standard inflow modelling</li>
<li>1 = use underflow model where <code>INFLOW_HEIGHT</code> is specified</li>
</ul></li>
<li><code>ibubbler</code>: controls bubble plume destratification
<ul>
<li>0 = no bubble plume</li>
<li>1 = enable destratification model</li>
</ul></li>
<li><code>itemperature</code>: controls whether temperature is transported
<ul>
<li>0 = no temperature</li>
<li>1 = temperature as scalar</li>
</ul></li>
<li><code>isalinity</code>: controls whether salinity is transported
<ul>
<li>0 = no salinity</li>
<li>1 = salinity as scalar</li>
</ul></li>
<li><code>idensity</code>: controls inclusion of buoyancy (density) in simulation
<ul>
<li>0 = no buoyancy</li>
<li>1 = use UNESCO equation of state for buoyancy</li>
</ul></li>
<li><code>ntracer</code>: number of passive tracers
<ul>
<li>0 = none</li>
<li>1 to 10 = number of tracers initialized or supplied via inflow</li>
</ul></li>
<li><code>ndrifters</code>: number of drifters or particles
<ul>
<li>0 = none</li>
<li><blockquote class="blockquote">
<p>=1 = number of drifters</p>
</blockquote></li>
</ul></li>
<li><code>ijet</code>: include jets/pumps
<ul>
<li>0 = no jets</li>
<li>1 = simulate jets</li>
</ul></li>
<li><code>itube</code>: include drafttube pump destratification
<ul>
<li>0 = no drafttubes</li>
<li>1 = simulate drafttubes</li>
</ul></li>
<li><code>ICAEDYM</code>: enable CAEDYM water quality module
<ul>
<li>0 = off</li>
<li>1 = on</li>
</ul></li>
<li><code>icoriolis</code>: include Coriolis force from <code>bathymetry.dat</code> latitude
<ul>
<li>0 = off</li>
<li>1 = on</li>
</ul></li>
<li><code>inonhydrostatic</code>: use non-hydrostatic approximations of Botelho et al.
<ul>
<li>0 = hydrostatic</li>
<li>1 = non-hydrostatic</li>
</ul></li>
</ul>
</section>
<section id="initialization-and-update-options" class="level3" data-number="7.7.3">
<h3 data-number="7.7.3" class="anchored" data-anchor-id="initialization-and-update-options"><span class="header-section-number">7.7.3</span> Initialization and update options</h3>
<ul>
<li><code>irestart</code>: use restart file for initial conditions
<ul>
<li>0 = do not use</li>
<li>1 = use file specified by <code>restart_in_file</code></li>
</ul></li>
<li><code>user_init_u_vel</code>: user subroutine for x velocity
<ul>
<li>0 = ignore</li>
<li>1 = call <code>user_u_init</code> with <code>USER_START_U = 1</code></li>
</ul></li>
<li><code>user_init_v_vel</code>: user subroutine for y velocity
<ul>
<li>0 = ignore</li>
<li>1 = call <code>user_v_init</code> with <code>USER_START_V = 1</code></li>
</ul></li>
<li><code>user_init_w_vel</code>: user subroutine for z velocity
<ul>
<li>0 = ignore</li>
<li>1 = call <code>user_w_init</code> with <code>USER_START_W = 1</code></li>
</ul></li>
<li><code>user_init_temperature</code>: user subroutine for temperature
<ul>
<li>0 = ignore</li>
<li>1 = call <code>user_temperature_init</code> with <code>USER_START_TEMPERATURE = 1</code></li>
</ul></li>
<li><code>user_init_salinity</code>: user subroutine for salinity
<ul>
<li>0 = ignore</li>
<li>1 = call <code>user_salinity_init</code> with <code>USER_START_SALINITY = 1</code></li>
</ul></li>
<li><code>user_init_tracer</code>: user subroutine for tracer
<ul>
<li>0 = ignore</li>
<li>1 = call <code>user_tracer_init</code> with <code>USER_START_TRACER = 1</code></li>
</ul></li>
<li><code>user_init_height</code>: user subroutine for surface height
<ul>
<li>0 = ignore</li>
<li>1 = call <code>user_height_init</code> with <code>USER_START_HEIGHT = 1</code></li>
</ul></li>
<li><code>user_init_extinction</code>: user subroutine for light extinction coefficient
<ul>
<li>0 = ignore</li>
<li>1 = call <code>user_extinction_init</code> with <code>USER_START_EXTINCTION = 1</code></li>
</ul></li>
<li><code>latitude</code>: optional simulation latitude (overrides value in <code>bathymetry.dat</code>)</li>
</ul>
</section>
<section id="turbulence-modeling" class="level3" data-number="7.7.4">
<h3 data-number="7.7.4" class="anchored" data-anchor-id="turbulence-modeling"><span class="header-section-number">7.7.4</span> Turbulence modeling</h3>
<ul>
<li><p><code>iclosure</code>: controls the type of closure scheme used</p>
<ul>
<li>0 = constant eddy viscosity</li>
<li>1 = closure model 1 (includes mixing of unstable stratification)</li>
<li>6 = wind-mixed layer model with energy transport — <strong>RECOMMENDED</strong></li>
</ul></li>
<li><p><code>DIFFUSIVITY&lt;SCALAR&gt;</code>: horizontal diffusivity for a scalar in X and Y (same). <code>&lt;SCALAR&gt;</code> must be uppercase and valid.</p></li>
<li><p><code>DIFFUSIVITY_X_&lt;SCALAR&gt;</code>, <code>DIFFUSIVITY_Y_&lt;SCALAR&gt;</code>: horizontal diffusivities in X and Y directions separately.</p></li>
<li><p><code>DEFAULT_DIFFUSIVITY</code>: default horizontal diffusivity for scalars; overridden by scalar-specific settings.</p></li>
</ul>
</section>
<section id="meteorological-sensor-heights" class="level3" data-number="7.7.5">
<h3 data-number="7.7.5" class="anchored" data-anchor-id="meteorological-sensor-heights"><span class="header-section-number">7.7.5</span> Meteorological Sensor Heights</h3>
<ul>
<li><code>WIND_SPEED_HEIGHT</code>: height (m) of wind speed measurements. Default is 10 m.</li>
<li><code>SCALAR_HEIGHT</code>: height (m) for air temperature and humidity data. Default is 10 m.</li>
</ul>
</section>
<section id="model-settings-and-controls" class="level3" data-number="7.7.6">
<h3 data-number="7.7.6" class="anchored" data-anchor-id="model-settings-and-controls"><span class="header-section-number">7.7.6</span> Model Settings and Controls</h3>
<ul>
<li><code>mean_albedo</code>: mean albedo of water</li>
<li><code>drag_btm_cd</code>: bottom drag coefficient</li>
<li><code>model_grav_damp_x</code>: damping for x-baroclinic term</li>
<li><code>model_grav_damp_y</code>: damping for y-baroclinic term</li>
</ul>
</section>
<section id="scalar-maximum-and-minimum-for-debugging" class="level3" data-number="7.7.7">
<h3 data-number="7.7.7" class="anchored" data-anchor-id="scalar-maximum-and-minimum-for-debugging"><span class="header-section-number">7.7.7</span> Scalar Maximum and Minimum for Debugging</h3>
<ul>
<li><code>min_&lt;SCALAR&gt;</code> and <code>max_&lt;SCALAR&gt;</code>: bounds for debugging. <code>&lt;SCALAR&gt;</code> must be uppercase.</li>
<li><code>ihardlimit</code>:
<ul>
<li>0 = no limits</li>
<li>1 = apply scalar bounds</li>
</ul></li>
</ul>
</section>
<section id="debugging-controls" class="level3" data-number="7.7.8">
<h3 data-number="7.7.8" class="anchored" data-anchor-id="debugging-controls"><span class="header-section-number">7.7.8</span> Debugging controls</h3>
<ul>
<li><code>debug_check</code>:
<ul>
<li>0 = off</li>
<li>1 = stop on fatal</li>
<li>2 = high check, stop on fatal</li>
<li>3 = high check, stop on warning</li>
</ul></li>
<li><code>debug_print</code>:
<ul>
<li>0 = none</li>
<li>1 = minimal</li>
<li>2 = moderate</li>
<li>10 = extensive</li>
</ul></li>
<li><code>debug_point</code>: sparse data index point for debug output</li>
<li><code>debug_baroclinic_x</code>, <code>debug_baroclinic_y</code>:
<ul>
<li>0 = off</li>
<li>1 = on</li>
</ul></li>
</ul>
</section>
<section id="output-frequency-1" class="level3" data-number="7.7.9">
<h3 data-number="7.7.9" class="anchored" data-anchor-id="output-frequency-1"><span class="header-section-number">7.7.9</span> Output Frequency</h3>
<ul>
<li><code>iter_out_monitor</code>: output interval for monitoring</li>
<li><code>iter_out_save</code>: output interval for saved simulation</li>
<li><code>iter_out_restart</code>: output interval for restart files</li>
</ul>
</section>
<section id="output-start-time" class="level3" data-number="7.7.10">
<h3 data-number="7.7.10" class="anchored" data-anchor-id="output-start-time"><span class="header-section-number">7.7.10</span> Output Start Time</h3>
<ul>
<li><code>start_output_monitor</code>: time step to start monitoring output</li>
<li><code>start_output_save</code>: time step to start save files</li>
<li><code>start_output_restart</code>: time step to start restart files</li>
</ul>
</section>
<section id="time-controls" class="level3" data-number="7.7.11">
<h3 data-number="7.7.11" class="anchored" data-anchor-id="time-controls"><span class="header-section-number">7.7.11</span> Time Controls</h3>
<ul>
<li><code>start_date_CWR</code>: start in Julian format <code>yyyyddd.ddd</code></li>
<li><code>del_t</code>: time step (seconds)</li>
<li><code>iter_max</code>: max time steps</li>
</ul>
</section>
<section id="iterative-solver-controls" class="level3" data-number="7.7.12">
<h3 data-number="7.7.12" class="anchored" data-anchor-id="iterative-solver-controls"><span class="header-section-number">7.7.12</span> Iterative Solver Controls</h3>
<ul>
<li><code>CGM_TOL</code>: tolerance for conjugate gradient method</li>
<li><code>CGM_MIN</code>: minimum iterations</li>
<li><code>CGM_MAX</code>: maximum iterations</li>
</ul>
</section>
<section id="scalar-filtering" class="level3" data-number="7.7.13">
<h3 data-number="7.7.13" class="anchored" data-anchor-id="scalar-filtering"><span class="header-section-number">7.7.13</span> Scalar Filtering</h3>
<ul>
<li><code>IFILTER</code>:
<ul>
<li>1 = off (default)</li>
<li>2 = BPE filter for salinity</li>
<li>3 = BPE filter for temperature</li>
</ul></li>
<li><code>filter_bPE_threshold</code>: max BPE change (e.g., 1e-9 for Lake Kinneret)</li>
<li><code>filter_mass_threshold</code>: max mass change (e.g., 1e-7 for Lake Kinneret)</li>
<li><code>FILTER&lt;SCALAR&gt;</code>: constant filter value for scalar</li>
<li><code>DEFAULT_FILTER</code>: default filter value for all scalars</li>
</ul>
</section>
<section id="default-values" class="level3" data-number="7.7.14">
<h3 data-number="7.7.14" class="anchored" data-anchor-id="default-values"><span class="header-section-number">7.7.14</span> Default Values</h3>
<ul>
<li><code>DEFAULT_HEIGHT</code>: default water height (m)</li>
<li><code>DEFAULT_WIND_SPEED</code>: default wind speed (m/s)</li>
<li><code>DEFAULT_WIND_DIR</code>: wind direction (degrees from North)</li>
<li><code>DEFAULT_&lt;SCALAR&gt;</code>: default scalar value</li>
<li><code>DEFAULT_PAR_EXTINCTION</code>, <code>DEFAULT_NIR_EXTINCTION</code>, <code>DEFAULT_UVA_EXTINCTION</code>, <code>DEFAULT_UVB_EXTINCTION</code>: extinction coefficients</li>
<li><code>DEFAULT_BC</code>: boundary condition preset (1-9)</li>
</ul>
</section>
<section id="input-file-names" class="level3" data-number="7.7.15">
<h3 data-number="7.7.15" class="anchored" data-anchor-id="input-file-names"><span class="header-section-number">7.7.15</span> Input File Names</h3>
<ul>
<li><code>3D_data_file</code>, <code>preprocessor_file</code>: grid and map files</li>
<li><code>initial_profile_file</code>, <code>initial_horiz_file</code>: initial condition files</li>
<li><code>boundary_condition_file</code>, <code>profile_boundary_condition_file</code>: boundary files</li>
<li><code>update_file</code>, <code>filter_file</code>: updates and filter files</li>
<li><code>drifter_properties_file</code>, <code>drifter_in_file</code>, <code>update_drifter_file</code>: drifter config</li>
<li><code>jet_file</code>, <code>drafttube_file</code>: destratification devices</li>
<li><code>datablock_file</code>: output configuration</li>
</ul>
</section>
<section id="file-directories" class="level3" data-number="7.7.16">
<h3 data-number="7.7.16" class="anchored" data-anchor-id="file-directories"><span class="header-section-number">7.7.16</span> File Directories</h3>
<ul>
<li><code>infile_dir</code>: directory of input files</li>
<li><code>outfile_unf_dir</code>: binary output directory</li>
<li><code>outfile_txt_dir</code>: text output directory</li>
</ul>
</section>
<section id="output-file-names" class="level3" data-number="7.7.17">
<h3 data-number="7.7.17" class="anchored" data-anchor-id="output-file-names"><span class="header-section-number">7.7.17</span> Output File Names</h3>
<ul>
<li><code>restart_save_file</code>: base name for save files</li>
<li><code>restart_out_file</code>: base name for restart output</li>
</ul>
</section>
</section>
<section id="input-files" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="input-files"><span class="header-section-number">7.8</span> Input files</h2>
<section id="sparsedata.unf-and-usedata.unf" class="level3" data-number="7.8.1">
<h3 data-number="7.8.1" class="anchored" data-anchor-id="sparsedata.unf-and-usedata.unf"><span class="header-section-number">7.8.1</span> sparsedata.unf and usedata.unf</h3>
<p>The files <code>sparsedata.unf</code> and <code>usedata.unf</code> are required files for ELCOM. These are the Fortran unformatted (binary) files produced by the pre-processor. The user may rename these files, but must keep track of which file is the <code>sparsedata</code> file (<code>3D_data_file</code>) and which is the <code>usedata</code> file (<code>preprocessor_file</code>). ELCOM will look for the files specified in the <code>run_elcom.dat</code> file. If the incorrect files are used, the simulation will crash.</p>
</section>
<section id="sec-tempBCfiles" class="level3" data-number="7.8.2">
<h3 data-number="7.8.2" class="anchored" data-anchor-id="sec-tempBCfiles"><span class="header-section-number">7.8.2</span> Temporal boundary condition (1D) files</h3>
<p>The one-dimensional temporal boundary condition files (<code>boundary_condition_file</code>) are created by the user to provide environmental forcing information that varies with time. These files must follow a specific format:</p>
<ul>
<li>Four header lines followed by data columns.</li>
<li>First column = time in CWR format (<code>yyyyddd.dd</code>).</li>
<li>Each row represents data for a specific time.</li>
<li>Comment lines (starting with <code>!</code>) may appear at the top.</li>
<li>Header comment lines must have the same number of items as data columns.</li>
<li>No comments allowed within the data block.</li>
<li>All columns must be fully populated (no missing values).</li>
</ul>
<section id="header-line-meanings" class="level4" data-number="7.8.2.1">
<h4 data-number="7.8.2.1" class="anchored" data-anchor-id="header-line-meanings"><span class="header-section-number">7.8.2.1</span> Header line meanings:</h4>
<ol type="1">
<li>Number of data columns (excluding the time column).</li>
<li><code>0</code> indicating CWR time format (first data column should be <code>TIME</code>).</li>
<li>Boundary cell set reference numbers (from <code>bc.dat</code>).</li>
<li>Keywords describing the type of data in each column.</li>
</ol>
<p><strong>Interpolation:</strong> ELCOM linearly interpolates between provided time values to match simulation time steps (<code>del_t</code>).</p>
</section>
<section id="table-temporal-boundary-condition-data-types" class="level4" data-number="7.8.2.2">
<h4 data-number="7.8.2.2" class="anchored" data-anchor-id="table-temporal-boundary-condition-data-types"><span class="header-section-number">7.8.2.2</span> Table: Temporal Boundary Condition Data-types</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 12%">
<col style="width: 64%">
</colgroup>
<thead>
<tr class="header">
<th>Keyword</th>
<th>Units</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>HEIGHT</code></td>
<td>m</td>
<td>Water height for open boundary condition</td>
</tr>
<tr class="even">
<td><code>INFLOW</code></td>
<td>m<sup>3</sup>/s</td>
<td>Inflow volume</td>
</tr>
<tr class="odd">
<td><code>INFLOW_MAXDEPTH</code></td>
<td>m</td>
<td>Max depth for inflow</td>
</tr>
<tr class="even">
<td><code>INFLOW_MINDEPTH</code></td>
<td>m</td>
<td>Min depth for inflow</td>
</tr>
<tr class="odd">
<td><code>INFLOW_HEIGHT</code></td>
<td>m</td>
<td>Inflow height for underflow model</td>
</tr>
<tr class="even">
<td><code>OUTFLOW</code></td>
<td>m<sup>3</sup>/s</td>
<td>Outflow volume</td>
</tr>
<tr class="odd">
<td><code>GATE_&lt;n&gt;_TOP</code></td>
<td>m</td>
<td>Top of an inflow/outflow gate</td>
</tr>
<tr class="even">
<td><code>GATE_&lt;n&gt;_BOTTOM</code></td>
<td>m</td>
<td>Bottom of an inflow/outflow gate</td>
</tr>
<tr class="odd">
<td><code>GATE_&lt;n&gt;_OPEN</code></td>
<td>-</td>
<td>Status of gate (1=open, 0=closed)</td>
</tr>
<tr class="even">
<td><code>AIRFLOW</code></td>
<td>m<sup>3</sup>/s</td>
<td>Airflow rate for bubble destratification</td>
</tr>
<tr class="odd">
<td><code>N_PORTS</code></td>
<td></td>
<td>Number of ports in destratification device</td>
</tr>
<tr class="even">
<td><code>RAIN</code></td>
<td>m/day</td>
<td>Rainfall rate</td>
</tr>
<tr class="odd">
<td><code>WIND_SPEED</code></td>
<td>m/s</td>
<td>Wind speed</td>
</tr>
<tr class="even">
<td><code>WIND_DIR</code></td>
<td>deg</td>
<td>Wind direction (deg clockwise from north)</td>
</tr>
<tr class="odd">
<td><code>SOLAR_RAD</code></td>
<td>W/m<sup>2</sup></td>
<td>Solar radiation at water surface</td>
</tr>
<tr class="even">
<td><code>LW_RAD_IN</code></td>
<td>W/m<sup>2</sup></td>
<td>Incoming longwave radiation</td>
</tr>
<tr class="odd">
<td><code>LW_RAD_NET</code></td>
<td>W/m<sup>2</sup></td>
<td>Net longwave radiation (positive incoming)</td>
</tr>
<tr class="even">
<td><code>ATM_PRESS</code></td>
<td>Pascals</td>
<td>Atmospheric pressure</td>
</tr>
<tr class="odd">
<td><code>CLOUDS</code></td>
<td></td>
<td>Fractional cloud cover (0 to 1)</td>
</tr>
<tr class="even">
<td><code>REL_HUM</code></td>
<td></td>
<td>Relative humidity (0 to 1)</td>
</tr>
<tr class="odd">
<td><code>AIR_TEMP</code></td>
<td>deg C</td>
<td>Air temperature</td>
</tr>
<tr class="even">
<td><code>&lt;SCALAR&gt;</code></td>
<td>-</td>
<td>Valid transportable scalar</td>
</tr>
</tbody>
</table>
</section>
<section id="notes" class="level4" data-number="7.8.2.3">
<h4 data-number="7.8.2.3" class="anchored" data-anchor-id="notes"><span class="header-section-number">7.8.2.3</span> Notes:</h4>
<ul>
<li><code>INFLOW_MAXDEPTH</code> and <code>INFLOW_MINDEPTH</code>: allow control of inflow depths, enabling inflow at the surface of a thalweg cell even as surface level varies.</li>
<li><code>GATE_&lt;n&gt;_TOP</code>, <code>GATE_&lt;n&gt;_BOTTOM</code>, <code>GATE_&lt;n&gt;_OPEN</code>: specify selective withdrawal gates. <code>n</code> is the gate number (e.g.&nbsp;<code>GATE_1_TOP</code>), with <code>OPEN</code> = 1 (open) or 0 (closed). Flow is distributed among open gates based on area.</li>
</ul>
<p>These features allow for more realistic simulation of systems like reservoirs with variable surface height or dam withdrawal structures.</p>
</section>
</section>
<section id="temporal-profile-boundary-condition-2d-files" class="level3" data-number="7.8.3">
<h3 data-number="7.8.3" class="anchored" data-anchor-id="temporal-profile-boundary-condition-2d-files"><span class="header-section-number">7.8.3</span> Temporal profile boundary condition (2D) files</h3>
<p>The two-dimensional temporal profile boundary condition files (<code>profile_boundary_condition_file</code>) are used to provide scalar boundary information that varies with both time and depth. These files consist of:</p>
<ul>
<li>Four header lines</li>
<li>Sections of data, each representing a profile at a specific time</li>
</ul>
<section id="header-lines" class="level4" data-number="7.8.3.1">
<h4 data-number="7.8.3.1" class="anchored" data-anchor-id="header-lines"><span class="header-section-number">7.8.3.1</span> Header lines:</h4>
<ol type="1">
<li>Number of data sets per section (including <code>DEPTH</code>, excluding the <code>TIME</code> row)</li>
<li>Must contain <code>0</code> to indicate CWR time format; data section starts with <code>TIME</code></li>
<li>Boundary cell set reference numbers (including <code>TIME</code> and <code>DEPTH</code>) — each file may apply to only <strong>one</strong> boundary set</li>
<li>Keywords for each column (<code>TIME</code>, <code>DEPTH</code>, and valid scalar keywords)</li>
</ol>
</section>
<section id="data-section" class="level4" data-number="7.8.3.2">
<h4 data-number="7.8.3.2" class="anchored" data-anchor-id="data-section"><span class="header-section-number">7.8.3.2</span> Data section:</h4>
<p>Each section contains:</p>
<ul>
<li>One header row: the profile time (<code>yyyyddd.dd</code>) and number of depths</li>
<li>One row for <code>DEPTH</code> values (depths in meters below the surface)</li>
<li>Subsequent rows: one per scalar, with values at each depth</li>
</ul>
<p>All sections must:</p>
<ul>
<li>Contain the same number of data rows (one per scalar)</li>
<li>Maintain the same order of keywords per section</li>
</ul>
<hr>
</section>
</section>
<section id="sec-updateBCfiles" class="level3" data-number="7.8.4">
<h3 data-number="7.8.4" class="anchored" data-anchor-id="sec-updateBCfiles"><span class="header-section-number">7.8.4</span> Update boundary condition files</h3>
<p>The update boundary condition files (<code>update_file</code>) are used to update scalar values on boundaries during specified time intervals (e.g., tracer releases). Format is the same as 1D temporal boundary condition files, <strong>except</strong>:</p>
<ul>
<li>Two <code>TIME</code> columns per row are provided</li>
<li>Scalar values are applied during timesteps between the first and second time column</li>
</ul>
<p>If a timestep doesn’t fall within any of these intervals, no update is applied.</p>
<hr>
</section>
<section id="sec-tempFiltFiles" class="level3" data-number="7.8.5">
<h3 data-number="7.8.5" class="anchored" data-anchor-id="sec-tempFiltFiles"><span class="header-section-number">7.8.5</span> Temporal filter constant files</h3>
<p>Temporal filter constant files (<code>filter_file</code>) provide time-varying filter constants for scalars. They follow the same format as the 1D temporal boundary condition files.</p>
<ul>
<li>Third header line still includes boundary cell set reference, <strong>but it is ignored</strong></li>
<li>All keywords must be valid transportable scalars</li>
</ul>
<hr>
</section>
<section id="drifter-files" class="level3" data-number="7.8.6">
<h3 data-number="7.8.6" class="anchored" data-anchor-id="drifter-files"><span class="header-section-number">7.8.6</span> Drifter files</h3>
<section id="drifter-properties-files" class="level4" data-number="7.8.6.1">
<h4 data-number="7.8.6.1" class="anchored" data-anchor-id="drifter-properties-files"><span class="header-section-number">7.8.6.1</span> Drifter Properties Files</h4>
<p>The drifter properties file (<code>drifter_properties_file</code>) provides physical properties of semi-Lagrangian drifters. If only Lagrangian particles are simulated, this file can be blank.</p>
<p>Each line contains <strong>four columns</strong>:</p>
<ol type="1">
<li>Value</li>
<li>Target drifters (e.g., <code>:</code>, or <code>n1:n2</code>)</li>
<li>Target components (e.g., <code>:</code>, or <code>n1:n2</code>)</li>
<li>Property keyword</li>
</ol>
</section>
<section id="valid-property-keywords" class="level4" data-number="7.8.6.2">
<h4 data-number="7.8.6.2" class="anchored" data-anchor-id="valid-property-keywords"><span class="header-section-number">7.8.6.2</span> Valid property keywords:</h4>
<ul>
<li><code>mass</code>: mass of the component (kg)</li>
<li><code>area</code>: cross-sectional area (m<sup>2</sup>)</li>
<li><code>length</code>: vertical length (m)</li>
<li><code>drag_cd</code>: drag coefficient</li>
<li><code>distance</code>: vertical distance from probe base to component base (m)</li>
</ul>
</section>
<section id="shape-keyword-values" class="level4" data-number="7.8.6.3">
<h4 data-number="7.8.6.3" class="anchored" data-anchor-id="shape-keyword-values"><span class="header-section-number">7.8.6.3</span> <code>shape</code> keyword values:</h4>
<ul>
<li>1 = sphere</li>
<li>2 = cylinder</li>
<li>3 = rectangle</li>
</ul>
</section>
<section id="type-keyword-values" class="level4" data-number="7.8.6.4">
<h4 data-number="7.8.6.4" class="anchored" data-anchor-id="type-keyword-values"><span class="header-section-number">7.8.6.4</span> <code>type</code> keyword values:</h4>
<ul>
<li>1 = submerged — forced by modeled water velocities</li>
<li>2 = subsurface — forced by surface wind shear velocity</li>
<li>3 = surface — forced by wind</li>
</ul>
<p>Therefore an example file for drifters consisting of five components (antenna, surface buoy, subsurface buoy, pole connecting the drogue to the subsurface buoy and the drifter sails) may look something like:</p>
<pre class="plaintext"><code>! - - - -
! ! Example Drifter Properties File
! ! NB each comment line should have 4 words
! - - - -
! Component 1 sail
26.0   :    1    mass
1.5    :    1    area
1.0    :    1    length
0.3    :    1    drag_cd
0.0    :    1    distance
3      :    1    shape
1      :    1    type
! Component 2 Pole
3.0    :    2    mass
0.001  :    2    area
1.0    :    2    length
0.3    :    2    drag_cd
1.0    :    2    distance
2      :    2    shape
1      :    2    type
! Component 3 sub-surface float
0.2    :    3    mass
0.2    :    3    area
0.2    :    3    length
0.3    :    3    drag_cd
2.3    :    3    distance
3      :    3    shape
2      :    3    type
! Component 4 surface float
0.1    :    4    mass
0.01   :    4    area
0.1    :    4    length
0.3    :    4    drag_cd
2.5    :    4    distance
3      :    4    shape
3      :    4    type
! Component 5 antennea
1.0    :    5    mass
0.01   :    5    area
0.3    :    5    length
0.3    :    5    drag_cd
2.6    :    5    distance
2      :    5    shape
3      :    5    type</code></pre>
</section>
</section>
<section id="drifter-initial-files" class="level3" data-number="7.8.7">
<h3 data-number="7.8.7" class="anchored" data-anchor-id="drifter-initial-files"><span class="header-section-number">7.8.7</span> Drifter Initial Files</h3>
<p>The drifter initial files (<code>drifter_in_file</code>) are used to provide initial conditions and simulation properties for drifters and particles.</p>
<p>Each line of the <code>drifter_in_file</code> should contain <strong>three columns</strong>: 1. A value 2. Target drifters (<code>:</code> for all, or <code>n1:n2</code> for a range) 3. A keyword that specifies the property to set</p>
</section>
<section id="valid-keywords" class="level3" data-number="7.8.8">
<h3 data-number="7.8.8" class="anchored" data-anchor-id="valid-keywords"><span class="header-section-number">7.8.8</span> Valid keywords:</h3>
<ul>
<li><p><code>start_t</code>: starting timestep for the drifter</p></li>
<li><p><code>end_t</code>: ending timestep for the drifter</p></li>
<li><p><code>solution_method</code>: type of drifter</p>
<ul>
<li>1 = Drifter with constant elevation</li>
<li>2 = Drifter with constant depth</li>
<li>3 = Drifter with constant density</li>
<li>4 = Lagrangian Particle with constant elevation</li>
<li>5 = Lagrangian Particle with constant depth</li>
<li>6 = Lagrangian Particle with constant density</li>
<li>7 = 3D Lagrangian Particle</li>
</ul></li>
<li><p><code>beach_method</code>:</p>
<ul>
<li>1 = Remove drifter when it hits land</li>
<li>2 = Drifter continues if it hits land &gt; <strong>Note:</strong> Drifters are always removed if they cross an open boundary.</li>
</ul></li>
<li><p><code>cfl_max</code>: maximum timestep for drifter (sub-timestepped if CFL &gt; <code>cfl_max</code>)</p></li>
<li><p><code>drogue_density</code>: density of drogue/particle (used for constant density solutions)</p></li>
<li><p><code>centre_of_mass</code>: distance of centre of mass from bottom of drogue (used for constant density solutions)</p></li>
<li><p><code>depth</code>: depth of bottom of drogue/particle (used for constant depth solutions)</p></li>
<li><p><code>start_i</code>, <code>start_j</code>, <code>start_k</code>: starting position in <code>i, j, k</code> grid coordinates</p>
<ul>
<li>Example: <code>start_i = 8.5</code>, <code>start_j = 8.5</code>, <code>start_k = 5.5</code> places the drifter in the center of cell <code>(i = 8, j = 8, k = 5)</code></li>
</ul></li>
<li><p><code>start_x</code>, <code>start_y</code>, <code>start_z</code>: starting position in physical <code>x, y, z</code> coordinates</p></li>
<li><p><code>start_cell</code>: starting cell number (in 1D sparse array)</p></li>
</ul>
<hr>
<p>An example file may look something like:</p>
<pre class="plaintext"><code>! - - - -
! ! Example Drifter Initial File
! ! NB each comment line should have 3 words
! - - - -
8.5    :    start_i
14.5   :    start_j
6.7    :    start_k
2      :    solution_method
2      :    beach_method
1.5    :    depth</code></pre>
</section>
<section id="drifter-update-files" class="level3" data-number="7.8.9">
<h3 data-number="7.8.9" class="anchored" data-anchor-id="drifter-update-files"><span class="header-section-number">7.8.9</span> Drifter Update Files</h3>
<p>The drifter update files (<code>update_drifter_file</code>) are used to update drifter positions or solution methods during a simulation. These files are primarily designed to incorporate real-time position updates from measurements.</p>
<p>The format is the same as standard update boundary condition files, <strong>except</strong>:</p>
<ul>
<li>The third header line contains a <strong>drifter number</strong> instead of a boundary condition set number.</li>
<li>The update is applied to the specified drifter for all timesteps between the two time values on each row.</li>
</ul>
<p>If the current timestep is not between the two specified time values of a row, no update is made.</p>
</section>
<section id="valid-keywords-for-updates" class="level3" data-number="7.8.10">
<h3 data-number="7.8.10" class="anchored" data-anchor-id="valid-keywords-for-updates"><span class="header-section-number">7.8.10</span> Valid keywords for updates:</h3>
<ul>
<li><code>solution_method</code>: (see earlier for method options)</li>
<li><code>beach_method</code>: (see earlier for options)</li>
<li><code>cfl_max</code>: maximum timestep (drifter is sub-timestepped if CFL &gt; <code>cfl_max</code>)</li>
<li><code>drogue_density</code>: density of drogue/particle (for constant density mode)</li>
<li><code>centre_of_mass</code>: vertical offset from bottom of drogue to its center of mass</li>
<li><code>depth</code>: depth of drogue/particle (for constant depth solutions)</li>
<li><code>i, j, k</code>: updated grid coordinates for drifter position</li>
<li><code>x, y, z</code>: updated physical coordinates</li>
<li><code>cell</code>: updated cell index in 1D sparse array</li>
</ul>
<hr>
<p>An example file may look something like:</p>
<pre class="plaintext"><code>! - - - -
! ! Example Drifter Update File
! ! NB each comment line  should have 3 words
! - - - -
2 data sets
0 seconds between data
0          0          1   1
TIME       TIME       i   j
2005001.50 2005001.60 6.7 7.2</code></pre>
</section>
<section id="jet-files" class="level3" data-number="7.8.11">
<h3 data-number="7.8.11" class="anchored" data-anchor-id="jet-files"><span class="header-section-number">7.8.11</span> Jet Files</h3>
<p>The jet files (<code>jet_file</code>) are used to define the properties of a jet or pump employed for artificial destratification.</p>
<p>These files must follow a specific format:</p>
<ul>
<li><strong>Three header lines</strong></li>
<li><strong>Four columns of data</strong></li>
<li>Data corresponds to specific instants of time and applies to a particular jet</li>
<li>Comments (<code>!</code>) are allowed at the top of the file</li>
<li>All data rows must be fully populated — <strong>no missing values allowed</strong></li>
</ul>
<section id="header-line-definitions" class="level4" data-number="7.8.11.1">
<h4 data-number="7.8.11.1" class="anchored" data-anchor-id="header-line-definitions"><span class="header-section-number">7.8.11.1</span> Header line definitions:</h4>
<ol type="1">
<li><strong>Jet reference number</strong> (used for debugging purposes only)</li>
<li><strong>i and j location</strong> of the jet (two integers)</li>
<li><strong>Column headers</strong> for the data that follows</li>
</ol>
<blockquote class="blockquote">
<p><em>Note: The expected structure of the third header line and the data columns can include variables like time, thrust, radius, and depth or height depending on the configuration, although this was not specified completely in the original text.</em></p>
</blockquote>
<pre class="plaintext"><code> TIME THRUST RADIUS DEPTH</code></pre>
<pre class="plaintext"><code> TIME THRUST RADIUS HEIGHT</code></pre>
<p>The four data columns are</p>
</section>
<section id="data-column-descriptions-jet-files" class="level4" data-number="7.8.11.2">
<h4 data-number="7.8.11.2" class="anchored" data-anchor-id="data-column-descriptions-jet-files"><span class="header-section-number">7.8.11.2</span> Data Column Descriptions (Jet Files)</h4>
<ul>
<li><code>TIME</code>: The date in CWR Julian Day format (<code>yyyyddd.ddd</code>)</li>
<li><code>THRUST</code>: Force of the pump in Newtons</li>
<li><code>RADIUS</code>: Radius of the pump in metres</li>
<li><code>DEPTH</code> or <code>HEIGHT</code>: Either the depth of the pump from the surface level or the height from the bottom (in metres)</li>
</ul>
<pre class="plaintext"><code>! - - - -
! Example Jet File
! - - - -
1 jet ID number
6 12 i,j location of jet data
TIME      THRUST RADIUS DEPTH
2005001.0 3000   2.0    2.2
2005011.0 3000   2.0    2.2</code></pre>
</section>
</section>
<section id="drafttube-files" class="level3" data-number="7.8.12">
<h3 data-number="7.8.12" class="anchored" data-anchor-id="drafttube-files"><span class="header-section-number">7.8.12</span> Drafttube Files</h3>
<p>The drafttube files (<code>drafttube_file</code>) are used to define the properties of a pump with a drafttube used for artificial destratification.</p>
<p>These files must follow this structure:</p>
<ul>
<li><strong>Three header lines</strong></li>
<li><strong>Five columns of data</strong></li>
<li>Each row provides values at specific time instances for a single device</li>
<li>Comment lines (starting with <code>!</code>) may appear at the top of the file</li>
<li><strong>All data columns must be complete</strong> — no missing values in any row</li>
</ul>
<section id="header-line-definitions-1" class="level4" data-number="7.8.12.1">
<h4 data-number="7.8.12.1" class="anchored" data-anchor-id="header-line-definitions-1"><span class="header-section-number">7.8.12.1</span> Header line definitions:</h4>
<ol type="1">
<li>A <strong>drafttube reference number</strong> (used for debugging only)</li>
<li>Two integers indicating the <strong>i and j location</strong> of the device</li>
<li>A line containing the <strong>column headers</strong> for the data that follows</li>
</ol>
<blockquote class="blockquote">
<p><em>Note: The exact headers for the data columns (e.g., <code>TIME</code>, <code>THRUST</code>, <code>RADIUS</code>, <code>DEPTH</code>, <code>LENGTH</code>) should follow this third line, depending on what is specified for each simulation setup.</em></p>
</blockquote>
<pre class="plaintext"><code> TIME FLOW RADIUS DEPTH LENGTH</code></pre>
<p>The four data columns are</p>
</section>
<section id="data-column-descriptions-drafttube-files" class="level4" data-number="7.8.12.2">
<h4 data-number="7.8.12.2" class="anchored" data-anchor-id="data-column-descriptions-drafttube-files"><span class="header-section-number">7.8.12.2</span> Data Column Descriptions (Drafttube Files)</h4>
<ul>
<li><code>TIME</code>: The date in CWR Julian Day format (<code>yyyyddd.ddd</code>)</li>
<li><code>FLOW</code>: Flow rate through the pump in m<sup>3</sup>/s <em>Note: This value should be negative (i.e., pumping downward through the tube).</em></li>
<li><code>RADIUS</code>: Radius of the pump and tube in metres</li>
<li><code>DEPTH</code>: Depth of the pump from the surface level (in metres)</li>
<li><code>LENGTH</code>: Length of the draft tube in metres</li>
</ul>
<pre class="plaintext"><code>! - - - -
! Example drafttube File
! - - - -
1 drafttube ID number
6 12 i,j location of jet data
TIME      FLOW RADIUS DEPTH  LENGTH
2005001.0 -5   2.0    2.2    5.0
2005011.0 -5   2.0    2.2    5.0</code></pre>
</section>
</section>
</section>
<section id="definition-of-culvert-characteristics-dynamic-boundary-conditions" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="definition-of-culvert-characteristics-dynamic-boundary-conditions"><span class="header-section-number">7.9</span> Definition of Culvert Characteristics – Dynamic Boundary Conditions</h2>
<p>When dynamic boundary conditions are defined in <code>pre_elcom</code>, the characteristics of the culvert connecting the pair of boundary conditions must be provided. These characteristics are supplied in a file specified in <code>run_elcom.dat</code> using the keyword <code>dynamic_boundary_condition_file</code>.</p>
<p>These files require:</p>
<ul>
<li>Three header lines</li>
<li>One line listing culvert characteristics to be defined</li>
<li>One or more data rows for each culvert</li>
</ul>
<p><strong>Header Format:</strong></p>
<ol type="1">
<li>Two values – boundary condition reference numbers (as defined in <code>pre_elcom</code>)</li>
<li>One value – number of characteristics being specified (between 3 and 12)</li>
<li>One value – number of pipes in the set (only circular pipes supported)</li>
<li>One line – column headers for culvert characteristics</li>
</ol>
<section id="supported-culvert-keywords-and-defaults" class="level3" data-number="7.9.1">
<h3 data-number="7.9.1" class="anchored" data-anchor-id="supported-culvert-keywords-and-defaults"><span class="header-section-number">7.9.1</span> Supported Culvert Keywords and Defaults</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 11%">
<col style="width: 69%">
</colgroup>
<thead>
<tr class="header">
<th><code>KEYWORD</code></th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>PIPE_K</code></td>
<td>0.098</td>
<td>Inlet control factor K – unsubmerged pipe</td>
</tr>
<tr class="even">
<td><code>PIPE_M</code></td>
<td>2.000</td>
<td>Inlet control exponent M – unsubmerged pipe</td>
</tr>
<tr class="odd">
<td><code>PIPE_C</code></td>
<td>0.398</td>
<td>Inlet control factor C – submerged pipe</td>
</tr>
<tr class="even">
<td><code>PIPE_Y</code></td>
<td>0.670</td>
<td>Inlet control term Y – submerged pipe</td>
</tr>
<tr class="odd">
<td><code>EPS_ENTRY</code></td>
<td>0.500</td>
<td>Head loss at pipe inlet</td>
</tr>
<tr class="even">
<td><code>EPS_EXIT</code></td>
<td>1.000</td>
<td>Head loss at pipe outlet</td>
</tr>
<tr class="odd">
<td><code>EPS_FLAP_IN</code></td>
<td>0.000</td>
<td>Head loss for flapped gate at first boundary</td>
</tr>
<tr class="even">
<td><code>EPS_FLAP_OUT</code></td>
<td>0.000</td>
<td>Head loss for flapped gate at second boundary</td>
</tr>
<tr class="odd">
<td><code>PIPE_MAN</code></td>
<td>0.015</td>
<td>Manning’s coefficient</td>
</tr>
<tr class="even">
<td><code>PIPE_PHI</code></td>
<td>required</td>
<td>Pipe diameter</td>
</tr>
<tr class="odd">
<td><code>PIPE_LEN</code></td>
<td>required</td>
<td>Pipe length</td>
</tr>
<tr class="even">
<td><code>PIPE_HEIGHT</code></td>
<td>required</td>
<td>Pipe bottom height (relative to domain reference level)</td>
</tr>
</tbody>
</table>
</section>
<section id="example-file" class="level3" data-number="7.9.2">
<h3 data-number="7.9.2" class="anchored" data-anchor-id="example-file"><span class="header-section-number">7.9.2</span> Example File</h3>
<pre class="plaintext"><code>! Boundary Condition file for Culverts
2 1 ! Pair of dynamic sets
7   ! data sets
10  ! number of pipes
EPS_ENTRY  EPS_EXIT EPS_FLAP_IN  PIPE_PHI  PIPE_LEN  PIPE_MAN  PIPE_HEIGHT
0.500      1.000      0.100      0.500     15.0       0.015       2.750</code></pre>
</section>
<section id="sec-datablock" class="level3" data-number="7.9.3">
<h3 data-number="7.9.3" class="anchored" data-anchor-id="sec-datablock"><span class="header-section-number">7.9.3</span> Output definition file (Datablock.db)</h3>
<p>The file <code>datablock.db</code> is a text file produced by the user, and contains the configuration data used to set up the users output. The name for this file is specified by the user.</p>
<p>A <code>datablock.db</code> file is structured as a series of blocks of instructions. Each block requires an exact number of lines, with specific instructions on each line. Each line contains a single instruction followed by a comment. The comment must begin with a “!” character. In manually editing <code>datablock.db</code> files, it is important to keep in mind that while blocks of instructions may be added or removed, lines within a block can only be modified, but not removed. The following will discuss the structure of each block of instructions.</p>
<section id="datablock-description" class="level4" data-number="7.9.3.1">
<h4 data-number="7.9.3.1" class="anchored" data-anchor-id="datablock-description"><span class="header-section-number">7.9.3.1</span> Datablock Description</h4>
<p>The first 4 lines of a <code>datablock.db</code> are the datablock description. In order, they are the block descriptor, the current datablock version number, the number of output groups, and the number of output sets. Output groups and sets are described below.</p>
</section>
<section id="group-description" class="level4" data-number="7.9.3.2">
<h4 data-number="7.9.3.2" class="anchored" data-anchor-id="group-description"><span class="header-section-number">7.9.3.2</span> Group Description</h4>
<p>Following the datablock description are the group description blocks. A group represents a group of data to be output. A data group is defined as an output filename, datatypes to be output (i.e.&nbsp;<code>TEMPERATURE, SALINITY</code>, etc…), the location within the simulation domain of the points at which data is to be output, and the time at which data is to be output. If several groups are desired, the group descriptions must follow each other without breaks between them.</p>
<p>A group description block contains 11 lines, which are as follows:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th>Line</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><code>BEGIN GROUP_DESCRIPTION</code> — begin block statement</td>
</tr>
<tr class="even">
<td>2</td>
<td>Group reference number — an integer labelling the group, this can have any value</td>
</tr>
<tr class="odd">
<td>3</td>
<td>User label — a name containing no blank spaces labelling the group</td>
</tr>
<tr class="even">
<td>4</td>
<td>Output filename — should include <code>.unf</code> suffix</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Set reference number — an integer corresponding to a description of a set of points at which the data are to be output (sets will be described after groups)</td>
</tr>
<tr class="even">
<td>6</td>
<td>Number of datatypes in group — an integer indicating the desired number of datatypes to be output (i.e.&nbsp;<code>TEMPERATURE, SALINITY</code>, etc…)</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Should read <code>.TRUE.</code>, do not modify</td>
</tr>
<tr class="even">
<td>8</td>
<td>Output interval — an integer indicating the desired number of timesteps between outputs</td>
</tr>
<tr class="odd">
<td>9</td>
<td>Output start time — an integer indicating which time step to begin outputting data</td>
</tr>
<tr class="even">
<td>10</td>
<td>Output end time — an integer indicating which time step to stop outputting data, <code>0</code> indicates entire run</td>
</tr>
<tr class="odd">
<td>11</td>
<td>Should read <code>0</code>, do not modify</td>
</tr>
</tbody>
</table>
</section>
<section id="set-description" class="level4" data-number="7.9.3.3">
<h4 data-number="7.9.3.3" class="anchored" data-anchor-id="set-description"><span class="header-section-number">7.9.3.3</span> Set Description</h4>
<p>A set is a set of points at which data are to be output. This can include a vertical column of points, a contiguous series of columns of points (curtain), a horizontal sheet of points, a collection of drifters, a collection of outflows, or any group of points in the three-dimensional domain. The valid set types are:</p>
<pre><code>PROFILE_1D
CURTAIN_2D
SHEET_2D
DRIFTER
OUTFLOW
ALL_3D
GENERAL_3D</code></pre>
<p>Profiles and curtains require only the (x, y) locations of the base of each column to describe their location. Sheets can be referenced to a layer, a height above user datum, a height above bottom, or a height below the free-surface. Drifters are referenced by their drifter number from 1 to <code>n_drifters</code>. <code>OUTFLOW</code> outputs total flow and average scalar concentrations for flow out of the domain. Outflows are referred to by their bc reference number in <code>bc.dat</code>. <code>ALL_3D</code> simply outputs all points in the domain, and <code>GENERAL_3D</code> at points whose coordinates are individually specified.</p>
<p>A set description block contains 16 lines, which are as follows:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th>Line</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><code>BEGIN SET_DESCRIPTION</code> — begin set statement</td>
</tr>
<tr class="even">
<td>2</td>
<td>Set reference number — an integer labelling the set, this can have any value</td>
</tr>
<tr class="odd">
<td>3</td>
<td>User label — a name containing no blank spaces labelling the set</td>
</tr>
<tr class="even">
<td>4</td>
<td>Type of set — one of the 7 valid set type names described above</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Number of cells in set — varies by set type: <code>PROFILE</code>: number of vertical columns; <code>CURTAIN2D</code>: number of columns making up the curtain; <code>DRIFTER</code>: number of drifters to output; <code>OUTFLOW</code>: number of outflow bc sets to output; <code>SHEET_2D</code>, <code>ALL_3D</code>: use <code>0</code></td>
</tr>
<tr class="even">
<td>6</td>
<td>Sheet type — only for <code>SHEET_2D</code>. Valid keywords: <code>LAYER</code>: referenced as layer number up from bottom; <code>HEIGHT</code>: height in meters above datum; <code>BOTTOM</code>: meters above bottom; <code>SURFACE</code>: meters below free-surface (evolves in time); <code>FLAT</code>: flat calculation layer</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Sheet calc — only for <code>SHEET_2D</code>. Valid options: <code>NEAREST</code>: nearest vertical grid point; <code>MAX</code>: maximum in column (only with <code>FLAT</code>); <code>MIN</code>: minimum in column (only with <code>FLAT</code>); <code>AVG</code>: average in column (only with <code>FLAT</code>); <code>TOTAL</code>: integrated column value (only with <code>FLAT</code>)</td>
</tr>
<tr class="even">
<td>8</td>
<td>Sheet value — <code>LAYER</code>: layer number; <code>HEIGHT</code>, <code>BOTTOM</code>, <code>SURFACE</code>: vertical distance in meters; <code>FLAT</code>: use <code>0</code></td>
</tr>
<tr class="odd">
<td>9–16</td>
<td>Not implemented, do not modify</td>
</tr>
</tbody>
</table>
</section>
<section id="group-data-types" class="level4" data-number="7.9.3.4">
<h4 data-number="7.9.3.4" class="anchored" data-anchor-id="group-data-types"><span class="header-section-number">7.9.3.4</span> Group data types</h4>
<p>This block begins with the desired number of data types, followed by a listing of the desired data types.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th>Line</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><code>BEGIN GROUP_DATA_TYPES</code> — Begin data type description</td>
</tr>
<tr class="even">
<td>2</td>
<td>Group reference number — An integer referencing the group number defined in the group description</td>
</tr>
<tr class="odd">
<td>3–n</td>
<td>Data types — One data type descriptor per line. The possible data type descriptors are:</td>
</tr>
</tbody>
</table>
<pre><code>&lt;TEMPERATURE&gt;
&lt;SALINITY&gt;
U_VELOCITY
V_VELOCITY
W_VELOCITY
DENSITY
EXTINCTION
F_PRESSURE
T_PRESSURE
RI
SHEAR
MIX_ENERGY
MIX_FRACTION
MIX_REGIME
SHEAR_ENERGY
WIND_ENERGY
BBL_ENERGY
DISSIPATION
RETENTION_T
HEIGHT
SLOPE_X
SLOPE_Y
WIND_SPEED
WIND_DIR
WIND_U
WIND_V
RAIN
REL_HUM
LW_RAD_IN
LW_RAD_NET
SOLAR_RAD
ATM_PRESS
CLOUDS
AIR_TEMP
AUX_1
AUX_2
AUX_3
AUX_4
AUX_5
EVAP_VOL_FLUX
EVAP_MASS_FLUX
EVAP_HEAT_FLUX
SENS_HEAT_FLUX
HUMIDITY_ALT
HUMIDITY_SURF
C_WIND
C_HEAT</code></pre>
<p><strong>Underflow Variables</strong>:</p>
<pre><code>&lt;SCALAR&gt;_UND
H_UND
U_UND
V_UND
DENSITY_UND
PRESSURE_UND
E_COEFF_UND
RI_UND
E_VOLUME_UND
E_VEL_XS_UND
XP_F_UND_INDEX
YP_F_UND_INDEX
XN_F_UND_INDEX
YN_F_UND_INDEX</code></pre>
<p>For <code>DRIFTER</code> set types the value output is the value at the location of the bottom of the drifter.</p>
<p>For <code>OUTFLOW</code> set types the scalar value output is the average value for the total flow out. <strong>Note:</strong> Scalar is actually estimated using a first-order upwind scheme rather than the actual ULTIMATE-QUICKEST flux values.</p>
</section>
</section>
<section id="group-time-list" class="level3" data-number="7.9.4">
<h3 data-number="7.9.4" class="anchored" data-anchor-id="group-time-list"><span class="header-section-number">7.9.4</span> Group Time List</h3>
<p>This block is required to initialize a time stamp for each group. It requires only two lines as follows:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th>Line</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><code>BEGIN GROUP_TIME_LIST</code> — Begin group time list</td>
</tr>
<tr class="even">
<td>2</td>
<td>Group reference number — An integer referencing the group number defined in the group description</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="set-cell-data" class="level3" data-number="7.9.5">
<h3 data-number="7.9.5" class="anchored" data-anchor-id="set-cell-data"><span class="header-section-number">7.9.5</span> Set Cell Data</h3>
<p>This block describes the spatial location of each datablock set. The locations are described as row, column, and/or layer number.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th>Line</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><code>BEGIN SET_CELL_DATA</code> — Begin set cell data</td>
</tr>
<tr class="even">
<td>2</td>
<td>Set reference number — An integer referencing the set number defined in the set description</td>
</tr>
<tr class="odd">
<td>3–n</td>
<td>Cell locations — This input varies for different set types as follows:</td>
</tr>
</tbody>
</table>
<p><strong>Set type-specific input formats:</strong></p>
<ul>
<li><p><code>PROFILE</code>: Each profile requires a row of input. Each row requires 4 integers: <code>x-row</code>, <code>y-column</code>, <code>0</code>, <code>0</code></p></li>
<li><p><code>CURTAIN_2D</code>: Each profile making up the curtain requires a row of input. Each row requires 4 integers: <code>x-row</code>, <code>y-column</code>, <code>0</code>, <code>0</code></p></li>
<li><p><code>SHEET_2D</code>: No input required.</p></li>
<li><p><code>DRIFTER</code>: The drifters to be output. Each row requires 4 integers: <code>drifter number</code>, <code>0</code>, <code>0</code>, <code>0</code></p></li>
<li><p><code>OUTFLOW</code>: The bc sets to be output. Each row requires 4 integers: <code>bcset number (from bc.dat)</code>, <code>0</code>, <code>0</code>, <code>0</code></p></li>
<li><p><code>ALL_3D</code>: No input required.</p></li>
<li><p><code>GENERAL_3D</code>: Each point requires a row of input. Each row requires 3 integers: <code>x-row</code>, <code>y-column</code>, <code>z-layer</code></p></li>
</ul>
</section>
</section>
<section id="sec-runexe" class="level2" data-number="7.10">
<h2 data-number="7.10" class="anchored" data-anchor-id="sec-runexe"><span class="header-section-number">7.10</span> Running ELCOM</h2>
<p>ELCOM is executed at the command line by typing <code>elcom.exe</code> within the directory <em>where the <code>run_elcom.dat</code> and all the appropriate input data files</em> are located. The monitoring/debugging output is sent to the standard output of the computer (the display terminal on most computers). Unless the simulation run is very short, it is recommended that the user redirect the output to a file with a execution redirection such as:</p>
<pre><code>elcom.exe &gt;&amp; run_output.txt</code></pre>
<section id="sec-postproc" class="level3" data-number="7.10.1">
<h3 data-number="7.10.1" class="anchored" data-anchor-id="sec-postproc"><span class="header-section-number">7.10.1</span> Post-Processing</h3>
<section id="conversion-of-datablock-file-to-netcdf" class="level4" data-number="7.10.1.1">
<h4 data-number="7.10.1.1" class="anchored" data-anchor-id="conversion-of-datablock-file-to-netcdf"><span class="header-section-number">7.10.1.1</span> Conversion of datablock file to NETCDF</h4>
<p>The datablock output files are named and configured through the <code>datablock.db</code> file. ELCOM produces Fortran unformatted (binary) files as specified by the datablock output configuration. In general, one datablock output file contains one or more data types (e.g.&nbsp;velocity, temperature) applied to a set of points at a specified time interval. These files can be reprocessed into NETCDF files using the command-line program <code>dbconv.exe</code>.</p>
<p>The program <code>dbconv.exe</code> is used for converting datablock unformatted binary files created by ELCOM to NETCDF files which can then be processed and viewed in a program such as Matlab. The <code>dbconv.exe</code> executable should be placed either in the working directory or as recommended in the <code>/bin</code> directory which is in the operating system’s search path. <code>dbconv</code> is run through a configuration file called <code>run_dbconv.dat</code>.</p>
<p>The <code>run_dbconv.dat</code> file contains 9 lines as follows:</p>
<pre><code> Comment line, up to 64 characters
 .unf file name and path
 sparsedata.unf file name and path
 .nc netcdf output file name and path
 Start time step, -1 for beginning
 End time step, -1 for end of file
 Overwriting of .nc file? -  clobber for overwriting, no_clobber for no overwriting
 Output mapping info to text file? -  map for writing, no_map for no overwriting
 Output diagnosics to monitor?  -  echo to output to monitor, no_echo to not output to monitor</code></pre>
<p>An example <code>run_dbconv.dat</code> file would be:</p>
<pre><code> Example dbconv
 unfiles/curtain.unf
 infiles/sparsedata.unf
 ncfiles/curtain.nc
 -1
 -1
 clobber
 no_map
 no_echo</code></pre>
<p>Once the <code>run_dbconv.dat</code> file is correctly configured, <code>dbconv</code> can be executed at the command line by typing:</p>
<pre><code>dbconv.exe run_dbconv.dat</code></pre>
<p><strong>Notes:</strong></p>
<ul>
<li><code>run_dbconv.dat</code> can have any file name, however the correct file name must be invoked at run time.</li>
<li>The <code>run_dbconv.dat</code> can only be configured for one file at a time.</li>
</ul>
<p>For batch processing of several <code>.unf</code> files, it is recommended that a <code>run_dbconv.dat</code> file be created for each <code>.unf</code> to be converted and <code>dbconv.exe</code> be invoked for each <code>run_dbconv.dat</code> using a batch file.</p>
</section>
</section>
</section>
<section id="save-and-restart-output-files" class="level2" data-number="7.11">
<h2 data-number="7.11" class="anchored" data-anchor-id="save-and-restart-output-files"><span class="header-section-number">7.11</span> Save and Restart output files</h2>
<p>Save and Restart output files are Fortran unformatted (binary) files that contain run configuration information used to allow the user to restart ELCOM runs from a certain point. As described in the <code>run_elcom.dat</code> section, the kernel name and output frequency of save and restart files are defined in the <code>run_elcom.dat</code> file.</p>
<p>The save files are created starting at the time step specified by the value assigned to the <code>run_elcom.dat</code> keyword <code>start_output_save</code>, and subsequently at intervals defined by <code>iter_out_save</code>. The file name of the save files begins with the user-specified kernel, given by <code>restart_save_file</code>, appended by a time stamp, and appended by <code>.unf</code>.</p>
<p>The restart files are created at intervals defined by <code>iter_out_restart</code>, starting from the first time step. Subsequent restart files overwrite existing restart files. The file name of the restart files begins with the user-specified kernel, given by <code>restart_out_file</code>, appended by <code>.unf</code>. All start and restart files are written in the outfiles directory specified in the <code>run_elcom.dat</code> file.</p>
<p>To restart an ELCOM simulation using a save or restart file, the user must place a copy of the desired save or restart file in the infiles directory as specified in the <code>run_elcom.dat</code> file. In the <code>run_elcom.dat</code> file the name of the desired save or restart file must be assigned to the <code>restart_infile</code> keyword, and keyword <code>irestart</code> must be assigned the value <code>1</code>.</p>
</section>
<section id="culvert-outputs---dynamic-boundary-conditions" class="level2" data-number="7.12">
<h2 data-number="7.12" class="anchored" data-anchor-id="culvert-outputs---dynamic-boundary-conditions"><span class="header-section-number">7.12</span> Culvert Outputs - Dynamic Boundary Conditions</h2>
<p>In the current implementation, the flow rates and scalars calculated for each pipe in each of the pairs of dynamic boundary condition sets are output to an <code>ASCII</code> file located in the <code>outfile_txt_dir</code> directory.</p>
<p>The output files are named <code>culvert_bcset_[$set$].out</code>, where <code>$set$</code> is each of the dynamic boundary condition sets present in the simulation.</p>
<p>The format of the files is as follows. 16 header lines explain the format of the file.</p>
<pre><code> % number of pipes in set = n (repeats n times)
 % set ref 1 (repeats n times)
 % set ref 2 (repeats n times)
 % pipe heights 1 to n
 % pipe diameters 1 to n
 % number of scalars (repeats n times)
 % names of scalars (repeats n times)
 % Then, for each time step
 % time step (repeats n times)
 % height set upstream
 % height set downstream (repeats n times)
 % total flow (repeats n times)
 % shift in set (repeats n times)
 % regime pipe 1 to n
 % flow pipe 1 to n
 % each scalars flowing through the culverts (repeats n times)</code></pre>
<p>The percentage symbols at the beginning of each text line were used to make it easier to load the numeric data into a Matlab environment.</p>
<p>The next 7 lines give the set and pipe information.</p>
<ul>
<li><strong>First line</strong> gives the number of pipes (<code>n</code>) in the dynamic boundary condition output set. The information repeats <code>n</code> times for easier loading into Matlab.</li>
<li><strong>Second line</strong> gives the first defined set reference number in the dynamic boundary condition output set <code>ref 1</code>. The information repeats <code>n</code> times.</li>
<li><strong>Third line</strong> gives the second defined set reference number in the dynamic boundary condition output set <code>ref 2</code>. The information repeats <code>n</code> times.</li>
<li><strong>Fourth line</strong> gives the bottom height for each of the pipes in the boundary condition set.</li>
<li><strong>Fifth line</strong> gives the pipe diameter for each of the pipes in the dynamic boundary condition output set.</li>
<li><strong>Sixth line</strong> gives the number of transportable scalars used in the simulation. The information repeats <code>n</code> times.</li>
<li><strong>Seventh line</strong> gives the names of transportable scalars used in the simulation. The information repeats <code>n</code> times and the line is preceded by a percentage symbol.</li>
</ul>
<p>Then, for each time step in the simulation, <code>7 + number of scalars</code> lines are output.</p>
<ul>
<li><strong>First line</strong> gives the time step of the output <code>t</code>. The information repeats <code>n</code> times.</li>
</ul>
<pre><code> % flow pipe 1 to n
 % each scalar flowing through the culverts (repeats n times)</code></pre>
<ul>
<li><strong>Second line</strong> gives the water height in the upstream cell of the dynamic boundary condition set at time step <code>t</code>. Repeats <code>n</code> times.</li>
<li><strong>Third line</strong> gives the water height in the downstream cell of the dynamic boundary condition set at time step <code>t</code>. Repeats <code>n</code> times.</li>
<li><strong>Fourth line</strong> gives the sum of the flow in all the pipes in the dynamic boundary condition set at time step <code>t</code>. Repeats <code>n</code> times.</li>
<li><strong>Fifth line</strong> tells if there was a shift in the direction of the flow. A value <code>1</code> means there was a shift (flow is from cells defined in reference set <code>ref 2</code> to <code>ref 1</code>), and a value <code>0</code> means no shift. Repeats <code>n</code> times.</li>
<li><strong>Sixth line</strong> gives the flow regime in each of the pipes (see the science manual for a description of flow regimes).</li>
<li><strong>Seventh line</strong> gives the flow in each of the pipes.</li>
</ul>
<p>Then, <code>number of scalars</code> lines are output for each of the transportable scalars defined in the header.</p>
</section>
<section id="sec-validScalars" class="level2" data-number="7.13">
<h2 data-number="7.13" class="anchored" data-anchor-id="sec-validScalars"><span class="header-section-number">7.13</span> ELCOM Valid Scalars</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 10%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th>Scalar Keyword</th>
<th>Units</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>SALINITY</code></td>
<td>PSU</td>
<td>salinity (<em>practical salinity units which can be treated as parts per thousand within the numerical resolution of the model</em>)</td>
</tr>
<tr class="even">
<td><code>WTR_TEMP</code></td>
<td>degC</td>
<td>water temperature for inflowing water</td>
</tr>
<tr class="odd">
<td><code>TRACER_1</code> - <code>TRACER_10</code></td>
<td>concentration</td>
<td>tracer input</td>
</tr>
<tr class="even">
<td><code>&lt;CAEDYM&gt;</code></td>
<td>concentration</td>
<td>CAEDYM Scalars</td>
</tr>
</tbody>
</table>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-pre.html" class="pagination-link" aria-label="Pre-Processor">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Pre-Processor</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-notation.html" class="pagination-link" aria-label="Notation">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Notation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>