<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Section 4 ELCOM Operartion | ELCOM manual</title>
<meta name="author" content="">
<meta name="description" content="4.1 Introduction Running an ELCOM simulation requires the user to provide several types of data: Initial conditions Temporal boundary conditions Configuration parameters Output control ELCOM...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content="Section 4 ELCOM Operartion | ELCOM manual">
<meta property="og:type" content="book">
<meta property="og:description" content="4.1 Introduction Running an ELCOM simulation requires the user to provide several types of data: Initial conditions Temporal boundary conditions Configuration parameters Output control ELCOM...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Section 4 ELCOM Operartion | ELCOM manual">
<meta name="twitter:description" content="4.1 Introduction Running an ELCOM simulation requires the user to provide several types of data: Initial conditions Temporal boundary conditions Configuration parameters Output control ELCOM...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.0/transition.js"></script><script src="libs/bs3compat-0.5.0/tabs.js"></script><script src="libs/bs3compat-0.5.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">ELCOM manual</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="pre.html"><span class="header-section-number">3</span> Pre-Processor</a></li>
<li><a class="active" href="elcom.html"><span class="header-section-number">4</span> ELCOM Operartion</a></li>
<li><a class="" href="notation.html"><span class="header-section-number">5</span> Notation</a></li>
<li><a class="" href="applications.html"><span class="header-section-number">6</span> Applications</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="elcom" class="section level1" number="4">
<h1>
<span class="header-section-number">Section 4</span> ELCOM Operartion<a class="anchor" aria-label="anchor" href="#elcom"><i class="fas fa-link"></i></a>
</h1>
<div id="introduction-5" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-5"><i class="fas fa-link"></i></a>
</h2>
<p>Running an ELCOM simulation requires the user to provide several types of data:</p>
<ol style="list-style-type: decimal">
<li>Initial conditions<br>
</li>
<li>Temporal boundary conditions<br>
</li>
<li>Configuration parameters<br>
</li>
<li>Output control</li>
</ol>
<p>ELCOM obtains this data from the user through user-prepared input files and pre-processor prepared input files.</p>
</div>
<div id="files-for-elcom" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Files for ELCOM<a class="anchor" aria-label="anchor" href="#files-for-elcom"><i class="fas fa-link"></i></a>
</h2>
<p>ELCOM is a command-line executable that communicates with the user through files.<br>
Table <a href="elcom.html#tab:elcomFiles">4.1</a> provides a summary of file types, whether their presence is required or optional, the purpose of the file, and responsibility for preparation of the file.</p>
<ul>
<li>File names in <code>courier bold</code> font without brackets are fixed named files (i.e., the file must be present with exactly that name).<br>
</li>
<li>File names such as <code>[data_name].unf</code> use square brackets to indicate that ELCOM may substitute various names in the bracketed section (see following sections).<br>
</li>
<li>File names such as <em><datablock></datablock></em>.db use angle brackets to indicate sections of file names that the user can customize at the command line.</li>
</ul>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:elcomFiles">Table 4.1: </span>Files for ELCOM.</caption>
<colgroup>
<col width="31%">
<col width="10%">
<col width="31%">
<col width="16%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">File.Name</th>
<th align="left">Presence</th>
<th align="left">Usage</th>
<th align="left">Preparation</th>
<th align="left">Number</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>run_elcom.dat</code></td>
<td align="left">required</td>
<td align="left">configuration control</td>
<td align="left">user</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">
<em><datablock></datablock></em>.db</td>
<td align="left">optional</td>
<td align="left">output control</td>
<td align="left">user</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">
<em><environment></environment></em>.dat</td>
<td align="left">optional</td>
<td align="left">boundary control</td>
<td align="left">user</td>
<td align="left">10</td>
</tr>
<tr class="even">
<td align="left">
<em><initial></initial></em>.dat</td>
<td align="left">optional</td>
<td align="left">initial condition</td>
<td align="left">user</td>
<td align="left">10</td>
</tr>
<tr class="odd">
<td align="left">
<em><update></update></em>.dat</td>
<td align="left">optional</td>
<td align="left">scalar updates</td>
<td align="left">user</td>
<td align="left">10</td>
</tr>
<tr class="even">
<td align="left">
<em><drifter_properties></drifter_properties></em>.dat</td>
<td align="left">optional</td>
<td align="left">drifter properties</td>
<td align="left">user</td>
<td align="left">10</td>
</tr>
<tr class="odd">
<td align="left">
<em><drifter_initial></drifter_initial></em>.dat</td>
<td align="left">optional</td>
<td align="left">drifter initial conditions</td>
<td align="left">user</td>
<td align="left">10</td>
</tr>
<tr class="even">
<td align="left">
<em><drifter_update></drifter_update></em>.dat</td>
<td align="left">optional</td>
<td align="left">drifter updates</td>
<td align="left">user</td>
<td align="left">10</td>
</tr>
<tr class="odd">
<td align="left">
<em><jet></jet></em>.dat</td>
<td align="left">optional</td>
<td align="left">jet/pump file</td>
<td align="left">user</td>
<td align="left">100</td>
</tr>
<tr class="even">
<td align="left">
<em><drafttube></drafttube></em>.dat</td>
<td align="left">optional</td>
<td align="left">drafttube file</td>
<td align="left">user</td>
<td align="left">100</td>
</tr>
<tr class="odd">
<td align="left">
<em><filter></filter></em>.dat</td>
<td align="left">optional</td>
<td align="left">temporal filter constants</td>
<td align="left">user</td>
<td align="left">10</td>
</tr>
<tr class="even">
<td align="left">
<em><sparsedata></sparsedata></em>.unf</td>
<td align="left">required</td>
<td align="left">geometry data</td>
<td align="left">pre-processor</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">
<em><usedata></usedata></em>.unf</td>
<td align="left">required</td>
<td align="left">geometry data</td>
<td align="left">pre-processor</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">
<em><group_name></group_name></em>.unf</td>
<td align="left">output</td>
<td align="left">datablock output</td>
<td align="left">ELCOM</td>
<td align="left">no limit</td>
</tr>
<tr class="odd">
<td align="left">[data_name].unf</td>
<td align="left">output</td>
<td align="left">3D data type output</td>
<td align="left">ELCOM</td>
<td align="left">no limit</td>
</tr>
<tr class="even">
<td align="left">[time_]<em><save></save></em>.unf</td>
<td align="left">output</td>
<td align="left">simulation space output</td>
<td align="left">ELCOM</td>
<td align="left">no limit</td>
</tr>
<tr class="odd">
<td align="left">
<em><restart_out></restart_out></em>.unf</td>
<td align="left">output</td>
<td align="left">restart file</td>
<td align="left">ELCOM</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left"><code>elcom.exe</code></td>
<td align="left">required</td>
<td align="left">executable</td>
<td align="left">make</td>
<td align="left">1</td>
</tr>
</tbody>
</table></div>
</div>
<div id="simulation-modules" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Simulation modules<a class="anchor" aria-label="anchor" href="#simulation-modules"><i class="fas fa-link"></i></a>
</h2>
<p>ELCOM is organized into simulation modules that can be turned off/on depending on the type of simulation that is desired. A module is turned off/on by setting the value of control keywords. This is done within the <code>run_elcom.dat</code> file. These controls provide a simple method for modifying the simulation.</p>
<p>For example: a boundary condition file can be set up to include both meteorological data and inflow data. As a simple test, the user decides to turn off the inflow. One approach would be to return to the pre-processor, eliminate the inflow boundary cell set, re-run the pre-processor, then modify the temporal boundary condition file to remove the inflow data. As a simpler approach, the user need only set <code>iflow = 0</code>, and the inflow data and boundary cell sets will be ignored.</p>
<p>This section provides a brief overview of the modules within <code>ELCOM</code> and their corresponding keywords set within the <code>run_elcom.dat</code> file.</p>
<div id="stratification" class="section level3" number="4.3.1">
<h3>
<span class="header-section-number">4.3.1</span> Stratification<a class="anchor" aria-label="anchor" href="#stratification"><i class="fas fa-link"></i></a>
</h3>
<p>Density stratification in ELCOM can be through temperature, salinity, or both by using the controls <code>itemperature</code> and <code>isalinity</code> in combination with <code>idensity = 1</code>. If desired, temperature and salinity can be treated as passive tracers by setting <code>idensity = 0</code>. If temperature and/or salinity are turned on, they must be initialized throughout the simulation domain using the <code>default_***</code> controls, initial condition files, or associated subroutines in <code>elcom_user.f90</code>.</p>
</div>
<div id="tracers" class="section level3" number="4.3.2">
<h3>
<span class="header-section-number">4.3.2</span> Tracers<a class="anchor" aria-label="anchor" href="#tracers"><i class="fas fa-link"></i></a>
</h3>
<p>Up to 10 passive tracers may be transported in a simulation. They may be initialized in the domain using initial condition files or may flow into the domain through an inflow boundary using keywords <code>TRACER_**</code> in a temporal boundary condition file.</p>
</div>
<div id="surface-thermodynamics" class="section level3" number="4.3.3">
<h3>
<span class="header-section-number">4.3.3</span> Surface thermodynamics<a class="anchor" aria-label="anchor" href="#surface-thermodynamics"><i class="fas fa-link"></i></a>
</h3>
<p>This module controls the heat transfer across the free surface. Required inputs (in temporal boundary condition files) include: solar radiation, wind speed, air temperature, and relative humidity.</p>
</div>
<div id="rain" class="section level3" number="4.3.4">
<h3>
<span class="header-section-number">4.3.4</span> Rain<a class="anchor" aria-label="anchor" href="#rain"><i class="fas fa-link"></i></a>
</h3>
<p>The rain module controls rain input into the free surface. Rain data in <em>m/day</em> must be provided in a temporal boundary condition file.</p>
</div>
<div id="wind" class="section level3" number="4.3.5">
<h3>
<span class="header-section-number">4.3.5</span> Wind<a class="anchor" aria-label="anchor" href="#wind"><i class="fas fa-link"></i></a>
</h3>
<p>Wind affects ELCOM simulations in three ways:</p>
<ol style="list-style-type: decimal">
<li>Evaporative cooling in the surface thermodynamics module<br>
</li>
<li>Wind stress on the free surface<br>
</li>
<li>Wind-induced momentum source in the wind-mixed layer</li>
</ol>
<p>Use <code>WIND_SPEED</code> and <code>WIND_DIR</code> (linked to boundary cell set 0 for uniform application) or define multiple sections via <code>section_top</code> in <code>bc.dat</code>. ELCOM interpolates wind speed and direction in time. Vector interpolation isn’t supported, so consistent time intervals are recommended. Alternatively, use <code>WIND_U</code> and <code>WIND_V</code>.</p>
</div>
<div id="inflowoutflow" class="section level3" number="4.3.6">
<h3>
<span class="header-section-number">4.3.6</span> Inflow/Outflow<a class="anchor" aria-label="anchor" href="#inflowoutflow"><i class="fas fa-link"></i></a>
</h3>
<p>Inflow/outflow boundaries must be defined in <code>bc.dat</code>. Temporal boundary conditions for flow rate must be provided. Inflow conditions must also include scalar values.</p>
</div>
<div id="conservation-of-background-potential-energy" class="section level3" number="4.3.7">
<h3>
<span class="header-section-number">4.3.7</span> Conservation of Background Potential Energy<a class="anchor" aria-label="anchor" href="#conservation-of-background-potential-energy"><i class="fas fa-link"></i></a>
</h3>
<p>Numerical diffusion can destratify the domain, increasing background potential energy. A vertical sharpening filter can conserve energy but not mass. The filter applies to salinity (<code>IFILTER = 2</code>) or temperature (<code>IFILTER = 3</code>). Alternatively, use <code>FILTER_&lt;SCALAR&gt;</code> in <code>run_elcom.dat</code> with <code>IFILTER = 1</code>. Temporally varying filters are also supported.</p>
</div>
<div id="bubble-plume-destratification" class="section level3" number="4.3.8">
<h3>
<span class="header-section-number">4.3.8</span> Bubble Plume Destratification<a class="anchor" aria-label="anchor" href="#bubble-plume-destratification"><i class="fas fa-link"></i></a>
</h3>
<p>To simulate bubble destratification, define outlet locations in <code>bc.dat</code>. Temporal boundary conditions must specify airflow rates and the number of ports.</p>
</div>
<div id="underflow" class="section level3" number="4.3.9">
<h3>
<span class="header-section-number">4.3.9</span> Underflow<a class="anchor" aria-label="anchor" href="#underflow"><i class="fas fa-link"></i></a>
</h3>
<p>To simulate dense inflow using Dallimore et al. (2001)’s 2D model, define inflow boundaries and temporal conditions, including <code>INFLOW_HEIGHT</code>. Set <code>IUNDERFLOW</code> in <code>run_elcom.dat</code>.<br><strong>Note:</strong> Not compatible with CAEDYM.</p>
</div>
<div id="water-age-modelling" class="section level3" number="4.3.10">
<h3>
<span class="header-section-number">4.3.10</span> Water Age Modelling<a class="anchor" aria-label="anchor" href="#water-age-modelling"><i class="fas fa-link"></i></a>
</h3>
<p>Enable using <code>IRETENTION</code> in <code>run_elcom.dat</code>. Water age starts at zero and increments by <code>del_t</code> each timestep. Transported as a scalar.</p>
</div>
<div id="drifters-particles" class="section level3" number="4.3.11">
<h3>
<span class="header-section-number">4.3.11</span> Drifters / Particles<a class="anchor" aria-label="anchor" href="#drifters-particles"><i class="fas fa-link"></i></a>
</h3>
<p>Simulate Lagrangian or semi-Lagrangian particles using <code>NDRIFTERS</code> in <code>run_elcom.dat</code>. Define properties in <code>drifter_properties_file</code> and <code>drifter_in_file</code>. Updates via <code>update_drifter_file</code>.</p>
</div>
<div id="jetspumps" class="section level3" number="4.3.12">
<h3>
<span class="header-section-number">4.3.12</span> Jets/Pumps<a class="anchor" aria-label="anchor" href="#jetspumps"><i class="fas fa-link"></i></a>
</h3>
<p>To simulate jet/pump destratification, provide thrust, radius, and depth data in jet files. Controlled via <code>IJET</code> in <code>run_elcom.dat</code>.</p>
</div>
<div id="drafttubes" class="section level3" number="4.3.13">
<h3>
<span class="header-section-number">4.3.13</span> Drafttubes<a class="anchor" aria-label="anchor" href="#drafttubes"><i class="fas fa-link"></i></a>
</h3>
<p>For destratification impellors with draft tubes, specify thrust, radius, depth, and tube length in drafttube files. Controlled via <code>ITUBE</code> in <code>run_elcom.dat</code>.</p>
</div>
<div id="non-hydrostatic-code" class="section level3" number="4.3.14">
<h3>
<span class="header-section-number">4.3.14</span> Non-hydrostatic code<a class="anchor" aria-label="anchor" href="#non-hydrostatic-code"><i class="fas fa-link"></i></a>
</h3>
<p>To simulate non-hydrostatic pressure effects (as in Bothel et al.), note that finer horizontal resolution (~10m) is required and simulation runtime increases significantly.</p>
</div>
</div>
<div id="sect:initfiles" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Initialization<a class="anchor" aria-label="anchor" href="#sect:initfiles"><i class="fas fa-link"></i></a>
</h2>
<div id="uniform-initial-conditions" class="section level3" number="4.4.1">
<h3>
<span class="header-section-number">4.4.1</span> Uniform initial conditions<a class="anchor" aria-label="anchor" href="#uniform-initial-conditions"><i class="fas fa-link"></i></a>
</h3>
<p>For simple initial conditions (e.g., distributing a scalar or setting a flat surface), use <code>DEFAULT_****</code> keywords in <code>run_elcom.dat</code>. Default values can be overwritten by profile or horizontal files or initialization subroutines.</p>
</div>
<div id="vertical-profile" class="section level3" number="4.4.2">
<h3>
<span class="header-section-number">4.4.2</span> Vertical Profile<a class="anchor" aria-label="anchor" href="#vertical-profile"><i class="fas fa-link"></i></a>
</h3>
<p>Vertical scalar variation is defined using <code>initial_profile_file</code> (in the <code>infiles</code> directory). Format:</p>
<ul>
<li>Four header lines:
<ol style="list-style-type: decimal">
<li>Number of datasets (excluding depth)</li>
<li>Number of depths (first column is <code>DEPTH</code>)</li>
<li>i and j coordinates</li>
<li>Column keywords (first must be <code>DEPTH</code>, rest valid scalar keywords)</li>
</ol>
</li>
<li>Data rows: Depth (in meters) and scalar values.</li>
<li>Depths must start at zero and increase monotonically.</li>
<li>Linear interpolation is used during simulation.</li>
</ul>
<blockquote>
<p>Comments (<code>!</code>) can appear at the top of the file but not within the data block. Comment rows in headers must match column count.</p>
</blockquote>
<pre class="plaintext"><code>! Example: ic.dat
2   data sets
4   number of depths
15 20   i,j
DEPTH   WTR_TEMP    SALINITY
0.0     25.0        0.0
5.1     23.1        15.1
6.2     20.2        35.0
10.4    18.3        35.2</code></pre>
</div>
<div id="sect:multiProf" class="section level3" number="4.4.3">
<h3>
<span class="header-section-number">4.4.3</span> Multiple Vertical Profiles<a class="anchor" aria-label="anchor" href="#sect:multiProf"><i class="fas fa-link"></i></a>
</h3>
<p>To increase the flexibility of initialization, ELCOM Version 2 allows for multiple profile initial condition files. If more than one initial condition file is specified for any scalar, then ELCOM interpolates between files to initialize the domain. Each profile is first linearly interpolated onto the vertical layers, and then each point is horizontally interpolated using the inverse distance weighting method such that</p>
<p><span class="math display">\[
S_{i,j,k} = \sum_{n=1}^N \frac{S_{n,k}r_{n}^\alpha}{r_{n}^\alpha}
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is the distance weighting specified by the flag <code>IC_DIST_WEIGHTING</code> in <code>run_elcom.dat</code> (default = 2.0), <span class="math inline">\(r\)</span> is the distance between the column and profile <span class="math inline">\(n\)</span>, and <span class="math inline">\(N\)</span> is the number of profiles.</p>
</div>
<div id="horizontal-variation" class="section level3" number="4.4.4">
<h3>
<span class="header-section-number">4.4.4</span> Horizontal Variation<a class="anchor" aria-label="anchor" href="#horizontal-variation"><i class="fas fa-link"></i></a>
</h3>
<p>A horizontal variation in the initial conditions for any valid transportable scalar can be defined using an input file (keyword = <code>initial_horiz_file</code>). The input file may have any name but must be located in the <code>infiles</code> directory.</p>
<p>These files require a format that consists of three header lines followed by a value for each <code>(i,j)</code> column of the domain. The file may have as many comment lines (preceded by <code>!</code>) at the top of the file as desired. Comment lines within the header data must have as many items as there are columns (i.e., if there are 3 columns, a valid comment line is <code>!  - -</code>). No comment lines are allowed within the columns of data. The columns must be completely dense with data (i.e., there may not be “missing” data such that a row has fewer items than the number of columns).</p>
<p>The first header line contains two numbers: the number of x rows and the number of y columns. These must match the number of rows and columns in the bathymetry file.</p>
<p>The second line gives a land value for land cells.</p>
<p>The third line in the header contains the keyword that describes the scalar to be initialized. This keyword should be a valid transportable scalar given in the Valid Scalars table in [Section <a href="elcom.html#tab:validScalars">4.13</a>].</p>
<p>The remaining lines in the file contain the data. The matrix should be the same size as the bathymetry data in your bathymetry file.</p>
<pre class="plaintext"><code>! Example:  ic.dat
8 13    xrows   yrows
1e+16   land    val
SALINITY
1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16
1e+16 1e+16   9.0   9.5 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16
1e+16   8.1   8.5   9.3   9.5  10.0  10.2  11.0  11.6  11.8 1e+16 1e+16 1e+16
1e+16   8.0   8.5   9.2   9.5  10.0  10.3  10.6  11.3  11.6  11.8  12.0 1e+16
1e+16   8.0   8.5   9.1   9.3   9.5   9.5   9.7   9.8  10.0  10.2  11.2 1e+16
1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16  10.0  10.0  10.5 1e+16
1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16   9.1   9.2   9.5 1e+16
1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16</code></pre>
</div>
<div id="user-subroutines" class="section level3" number="4.4.5">
<h3>
<span class="header-section-number">4.4.5</span> User subroutines<a class="anchor" aria-label="anchor" href="#user-subroutines"><i class="fas fa-link"></i></a>
</h3>
<p>For ELCOM users who are willing to modify and compile source code, the ability to set up complex initial conditions is available through the addition of code to subroutines in the <code>elcom_user.f90</code> file. The subroutines in this file are only called if the appropriate <code>user_init_***</code> control in the <code>run_elcom.dat</code> file is non-zero.</p>
<p>The stub routines supplied with ELCOM are designed to be executed with the <code>user_init_***</code> controls set to 1. However, this can be modified by the user so that different initializations are performed for different values of <code>user_init_***</code>.</p>
</div>
</div>
<div id="configuration-controls" class="section level2" number="4.5">
<h2>
<span class="header-section-number">4.5</span> Configuration controls<a class="anchor" aria-label="anchor" href="#configuration-controls"><i class="fas fa-link"></i></a>
</h2>
<div id="time-step" class="section level3" number="4.5.1">
<h3>
<span class="header-section-number">4.5.1</span> Time step<a class="anchor" aria-label="anchor" href="#time-step"><i class="fas fa-link"></i></a>
</h3>
<p>The time step (keyword = <code>del_t</code>) is the number of seconds that the simulation advances in time for each simulation step.</p>
</div>
<div id="number-of-steps" class="section level3" number="4.5.2">
<h3>
<span class="header-section-number">4.5.2</span> Number of steps<a class="anchor" aria-label="anchor" href="#number-of-steps"><i class="fas fa-link"></i></a>
</h3>
<p>The total number of time steps to be computed in the present simulation run is set using the keyword <code>iter_max</code> in the <code>run_elcom.dat</code> file.</p>
</div>
<div id="start-date" class="section level3" number="4.5.3">
<h3>
<span class="header-section-number">4.5.3</span> Start date<a class="anchor" aria-label="anchor" href="#start-date"><i class="fas fa-link"></i></a>
</h3>
<p>The start date is entered in <strong>CWR Julian Day</strong> format, which specifies the year and day using a real number with 7 digits to the left of the decimal place as <code>yyyyddd.ddd</code>. The first 4 digits are the year and the subsequent 3 digits are the Julian Day (days since January 1st). Hours, minutes, and seconds are represented as fractions of a day (e.g., 1 AM on January 1st, 2000 is represented as <code>2000001.041667</code>).</p>
</div>
<div id="cgm-tolerance" class="section level3" number="4.5.4">
<h3>
<span class="header-section-number">4.5.4</span> CGM tolerance<a class="anchor" aria-label="anchor" href="#cgm-tolerance"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>CGM_TOL</code> is the residual at which iteration of the <strong>conjugate gradient method</strong> (used for the free-surface solution) is stopped.</p>
</div>
<div id="turbulence" class="section level3" number="4.5.5">
<h3>
<span class="header-section-number">4.5.5</span> Turbulence<a class="anchor" aria-label="anchor" href="#turbulence"><i class="fas fa-link"></i></a>
</h3>
<p>For stratified flow, the base closure scheme can be supplemented by unstable mixing (<code>iclosure = 1</code>) algorithms. The unstable mixing algorithm mixes momentum and transported scalars in vertical cells where an unstable gradient of potential density exists (i.e., Ri &lt; 0.0).</p>
<p>For stratified flows driven by surface wind, the <strong>wind-mixed-layer closure scheme with energy transport</strong> (<code>iclosure = 6</code>) is recommended. This approach computes the turbulent kinetic energy due to wind stirring, convective overturns, and wind shear, then uses this to compute vertical mixing.</p>
</div>
</div>
<div id="output-frequency" class="section level2" number="4.6">
<h2>
<span class="header-section-number">4.6</span> Output frequency<a class="anchor" aria-label="anchor" href="#output-frequency"><i class="fas fa-link"></i></a>
</h2>
<p>Outputs of data that are not controlled by the datablock file are set through the <code>iter_out_***</code> and <code>start_output_***</code> keywords. The former controls the time step interval for providing output, while the latter controls the first step on which output will be provided.</p>
</div>
<div id="sect:runelcom.dat" class="section level2" number="4.7">
<h2>
<span class="header-section-number">4.7</span> Configuration using file <code>run_elcom.dat</code><a class="anchor" aria-label="anchor" href="#sect:runelcom.dat"><i class="fas fa-link"></i></a>
</h2>
<p>An up-to-date copy of <code>run_elcom.dat</code> is included in the examples.</p>
<p>ELCOM looks for the file <code>run_elcom.dat</code> in the local directory to set the configuration of the simulation run. The <code>run_elcom.dat</code> configuration file controls execution of optional modules and models within ELCOM, allowing the user to set the parameters that govern the physical and numerical simulation.</p>
<p>The format of the file is flexible: lines may occur in any order, and not all items must be present. Comment lines (preceded by <code>!</code>) may occur anywhere in the file. <strong>Blank lines are not allowed</strong> in the file (the code stops reading at a blank line). Each line (including comment lines) must have at least two items separated by a blank space.</p>
<p>The comment marker <code>!</code> counts as an item, so a valid line is <code>!  !</code> or <code>! -</code>, while <code>!!</code> (no space between) is not valid.</p>
<p>The general format for the file is a series of lines, with each line listing a user setting followed by a keyword that defines the parameter. The individual keywords and settings are explained briefly below:</p>
<div id="file-headers" class="section level3" number="4.7.1">
<h3>
<span class="header-section-number">4.7.1</span> File headers<a class="anchor" aria-label="anchor" href="#file-headers"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>FILE</code>: file name for this file (must be <code>run_elcom.dat</code>)</li>
<li>
<code>ANALYST</code>: user name (must be inside single quotes <code>' '</code>)</li>
<li>
<code>ORGANIZATION</code>: user company name (must be inside single quotes <code>' '</code>)</li>
<li>
<code>COMMENT</code>: user comment (must be inside single quotes <code>' '</code>)</li>
<li>
<code>CASE_KEYWORD</code>: allows user to add code to be executed for a particular simulation case. Must be a string without blank spaces enclosed in single quotes.</li>
</ul>
</div>
<div id="simulation-module-controls" class="section level3" number="4.7.2">
<h3>
<span class="header-section-number">4.7.2</span> Simulation module controls<a class="anchor" aria-label="anchor" href="#simulation-module-controls"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>iheat_input</code>: controls surface thermodynamics
<ul>
<li>0 = no surface thermodynamics<br>
</li>
<li>1 = surface thermodynamics model (input solar radiation is measured; longwave model determined by input keywords)</li>
</ul>
</li>
<li>
<code>iatmstability</code>: controls atmospheric stability correction in thermodynamics
<ul>
<li>0 = no correction<br>
</li>
<li>1 = apply correction</li>
</ul>
</li>
<li>
<code>irain</code>: controls rainfall input
<ul>
<li>0 = no rain<br>
</li>
<li>1 = rain enabled</li>
</ul>
</li>
<li>
<code>iflow</code>: controls inflow/outflow (Dirichlet boundaries); overrides boundary condition files
<ul>
<li>0 = no inflow/outflow<br>
</li>
<li>1 = inflow/outflow model 1</li>
</ul>
</li>
<li>
<code>iunderflow</code>: controls 2D underflow model; overrides boundary condition files
<ul>
<li>0 = standard inflow modelling<br>
</li>
<li>1 = use underflow model where <code>INFLOW_HEIGHT</code> is specified</li>
</ul>
</li>
<li>
<code>ibubbler</code>: controls bubble plume destratification
<ul>
<li>0 = no bubble plume<br>
</li>
<li>1 = enable destratification model</li>
</ul>
</li>
<li>
<code>itemperature</code>: controls whether temperature is transported
<ul>
<li>0 = no temperature<br>
</li>
<li>1 = temperature as scalar</li>
</ul>
</li>
<li>
<code>isalinity</code>: controls whether salinity is transported
<ul>
<li>0 = no salinity<br>
</li>
<li>1 = salinity as scalar</li>
</ul>
</li>
<li>
<code>idensity</code>: controls inclusion of buoyancy (density) in simulation
<ul>
<li>0 = no buoyancy<br>
</li>
<li>1 = use UNESCO equation of state for buoyancy</li>
</ul>
</li>
<li>
<code>ntracer</code>: number of passive tracers
<ul>
<li>0 = none<br>
</li>
<li>1 to 10 = number of tracers initialized or supplied via inflow</li>
</ul>
</li>
<li>
<code>ndrifters</code>: number of drifters or particles
<ul>
<li>0 = none<br>
</li>
<li>≥1 = number of drifters</li>
</ul>
</li>
<li>
<code>ijet</code>: include jets/pumps
<ul>
<li>0 = no jets<br>
</li>
<li>1 = simulate jets</li>
</ul>
</li>
<li>
<code>itube</code>: include drafttube pump destratification
<ul>
<li>0 = no drafttubes<br>
</li>
<li>1 = simulate drafttubes</li>
</ul>
</li>
<li>
<code>ICAEDYM</code>: enable CAEDYM water quality module
<ul>
<li>0 = off<br>
</li>
<li>1 = on</li>
</ul>
</li>
<li>
<code>icoriolis</code>: include Coriolis force from <code>bathymetry.dat</code> latitude
<ul>
<li>0 = off<br>
</li>
<li>1 = on</li>
</ul>
</li>
<li>
<code>inonhydrostatic</code>: use non-hydrostatic approximations of Botelho et al. 
<ul>
<li>0 = hydrostatic<br>
</li>
<li>1 = non-hydrostatic</li>
</ul>
</li>
</ul>
</div>
<div id="initialization-and-update-options" class="section level3" number="4.7.3">
<h3>
<span class="header-section-number">4.7.3</span> Initialization and update options<a class="anchor" aria-label="anchor" href="#initialization-and-update-options"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>irestart</code>: use restart file for initial conditions
<ul>
<li>0 = do not use<br>
</li>
<li>1 = use file specified by <code>restart_in_file</code>
</li>
</ul>
</li>
<li>
<code>user_init_u_vel</code>: user subroutine for x velocity
<ul>
<li>0 = ignore<br>
</li>
<li>1 = call <code>user_u_init</code> with <code>USER_START_U = 1</code>
</li>
</ul>
</li>
<li>
<code>user_init_v_vel</code>: user subroutine for y velocity
<ul>
<li>0 = ignore<br>
</li>
<li>1 = call <code>user_v_init</code> with <code>USER_START_V = 1</code>
</li>
</ul>
</li>
<li>
<code>user_init_w_vel</code>: user subroutine for z velocity
<ul>
<li>0 = ignore<br>
</li>
<li>1 = call <code>user_w_init</code> with <code>USER_START_W = 1</code>
</li>
</ul>
</li>
<li>
<code>user_init_temperature</code>: user subroutine for temperature
<ul>
<li>0 = ignore<br>
</li>
<li>1 = call <code>user_temperature_init</code> with <code>USER_START_TEMPERATURE = 1</code>
</li>
</ul>
</li>
<li>
<code>user_init_salinity</code>: user subroutine for salinity
<ul>
<li>0 = ignore<br>
</li>
<li>1 = call <code>user_salinity_init</code> with <code>USER_START_SALINITY = 1</code>
</li>
</ul>
</li>
<li>
<code>user_init_tracer</code>: user subroutine for tracer
<ul>
<li>0 = ignore<br>
</li>
<li>1 = call <code>user_tracer_init</code> with <code>USER_START_TRACER = 1</code>
</li>
</ul>
</li>
<li>
<code>user_init_height</code>: user subroutine for surface height
<ul>
<li>0 = ignore<br>
</li>
<li>1 = call <code>user_height_init</code> with <code>USER_START_HEIGHT = 1</code>
</li>
</ul>
</li>
<li>
<code>user_init_extinction</code>: user subroutine for light extinction coefficient
<ul>
<li>0 = ignore<br>
</li>
<li>1 = call <code>user_extinction_init</code> with <code>USER_START_EXTINCTION = 1</code>
</li>
</ul>
</li>
<li>
<code>latitude</code>: optional simulation latitude (overrides value in <code>bathymetry.dat</code>)</li>
</ul>
</div>
<div id="turbulence-modeling" class="section level3" number="4.7.4">
<h3>
<span class="header-section-number">4.7.4</span> Turbulence modeling<a class="anchor" aria-label="anchor" href="#turbulence-modeling"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<p><code>iclosure</code>: controls the type of closure scheme used</p>
<ul>
<li>0 = constant eddy viscosity<br>
</li>
<li>1 = closure model 1 (includes mixing of unstable stratification)<br>
</li>
<li>6 = wind-mixed layer model with energy transport — <strong>RECOMMENDED</strong>
</li>
</ul>
</li>
<li><p><code>DIFFUSIVITY&lt;SCALAR&gt;</code>: horizontal diffusivity for a scalar in X and Y (same). <code>&lt;SCALAR&gt;</code> must be uppercase and valid.</p></li>
<li><p><code>DIFFUSIVITY_X_&lt;SCALAR&gt;</code>, <code>DIFFUSIVITY_Y_&lt;SCALAR&gt;</code>: horizontal diffusivities in X and Y directions separately.</p></li>
<li><p><code>DEFAULT_DIFFUSIVITY</code>: default horizontal diffusivity for scalars; overridden by scalar-specific settings.</p></li>
</ul>
</div>
<div id="meteorological-sensor-heights" class="section level3" number="4.7.5">
<h3>
<span class="header-section-number">4.7.5</span> Meteorological Sensor Heights<a class="anchor" aria-label="anchor" href="#meteorological-sensor-heights"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>WIND_SPEED_HEIGHT</code>: height (m) of wind speed measurements. Default is 10 m.</li>
<li>
<code>SCALAR_HEIGHT</code>: height (m) for air temperature and humidity data. Default is 10 m.</li>
</ul>
</div>
<div id="model-settings-and-controls" class="section level3" number="4.7.6">
<h3>
<span class="header-section-number">4.7.6</span> Model Settings and Controls<a class="anchor" aria-label="anchor" href="#model-settings-and-controls"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>mean_albedo</code>: mean albedo of water<br>
</li>
<li>
<code>drag_btm_cd</code>: bottom drag coefficient<br>
</li>
<li>
<code>model_grav_damp_x</code>: damping for x-baroclinic term<br>
</li>
<li>
<code>model_grav_damp_y</code>: damping for y-baroclinic term</li>
</ul>
</div>
<div id="scalar-maximum-and-minimum-for-debugging" class="section level3" number="4.7.7">
<h3>
<span class="header-section-number">4.7.7</span> Scalar Maximum and Minimum for Debugging<a class="anchor" aria-label="anchor" href="#scalar-maximum-and-minimum-for-debugging"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>min_&lt;SCALAR&gt;</code> and <code>max_&lt;SCALAR&gt;</code>: bounds for debugging. <code>&lt;SCALAR&gt;</code> must be uppercase.</li>
<li>
<code>ihardlimit</code>:
<ul>
<li>0 = no limits<br>
</li>
<li>1 = apply scalar bounds</li>
</ul>
</li>
</ul>
</div>
<div id="debugging-controls" class="section level3" number="4.7.8">
<h3>
<span class="header-section-number">4.7.8</span> Debugging controls<a class="anchor" aria-label="anchor" href="#debugging-controls"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>debug_check</code>:
<ul>
<li>0 = off<br>
</li>
<li>1 = stop on fatal<br>
</li>
<li>2 = high check, stop on fatal<br>
</li>
<li>3 = high check, stop on warning</li>
</ul>
</li>
<li>
<code>debug_print</code>:
<ul>
<li>0 = none<br>
</li>
<li>1 = minimal<br>
</li>
<li>2 = moderate<br>
</li>
<li>10 = extensive</li>
</ul>
</li>
<li>
<code>debug_point</code>: sparse data index point for debug output<br>
</li>
<li>
<code>debug_baroclinic_x</code>, <code>debug_baroclinic_y</code>:
<ul>
<li>0 = off<br>
</li>
<li>1 = on</li>
</ul>
</li>
</ul>
</div>
<div id="output-frequency-1" class="section level3" number="4.7.9">
<h3>
<span class="header-section-number">4.7.9</span> Output Frequency<a class="anchor" aria-label="anchor" href="#output-frequency-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>iter_out_monitor</code>: output interval for monitoring<br>
</li>
<li>
<code>iter_out_save</code>: output interval for saved simulation<br>
</li>
<li>
<code>iter_out_restart</code>: output interval for restart files</li>
</ul>
</div>
<div id="output-start-time" class="section level3" number="4.7.10">
<h3>
<span class="header-section-number">4.7.10</span> Output Start Time<a class="anchor" aria-label="anchor" href="#output-start-time"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>start_output_monitor</code>: time step to start monitoring output<br>
</li>
<li>
<code>start_output_save</code>: time step to start save files<br>
</li>
<li>
<code>start_output_restart</code>: time step to start restart files</li>
</ul>
</div>
<div id="time-controls" class="section level3" number="4.7.11">
<h3>
<span class="header-section-number">4.7.11</span> Time Controls<a class="anchor" aria-label="anchor" href="#time-controls"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>start_date_CWR</code>: start in Julian format <code>yyyyddd.ddd</code><br>
</li>
<li>
<code>del_t</code>: time step (seconds)<br>
</li>
<li>
<code>iter_max</code>: max time steps</li>
</ul>
</div>
<div id="iterative-solver-controls" class="section level3" number="4.7.12">
<h3>
<span class="header-section-number">4.7.12</span> Iterative Solver Controls<a class="anchor" aria-label="anchor" href="#iterative-solver-controls"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>CGM_TOL</code>: tolerance for conjugate gradient method<br>
</li>
<li>
<code>CGM_MIN</code>: minimum iterations<br>
</li>
<li>
<code>CGM_MAX</code>: maximum iterations</li>
</ul>
</div>
<div id="scalar-filtering" class="section level3" number="4.7.13">
<h3>
<span class="header-section-number">4.7.13</span> Scalar Filtering<a class="anchor" aria-label="anchor" href="#scalar-filtering"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>IFILTER</code>:
<ul>
<li>1 = off (default)<br>
</li>
<li>2 = BPE filter for salinity<br>
</li>
<li>3 = BPE filter for temperature</li>
</ul>
</li>
<li>
<code>filter_bPE_threshold</code>: max BPE change (e.g., 1e-9 for Lake Kinneret)<br>
</li>
<li>
<code>filter_mass_threshold</code>: max mass change (e.g., 1e-7 for Lake Kinneret)<br>
</li>
<li>
<code>FILTER&lt;SCALAR&gt;</code>: constant filter value for scalar<br>
</li>
<li>
<code>DEFAULT_FILTER</code>: default filter value for all scalars</li>
</ul>
</div>
<div id="default-values" class="section level3" number="4.7.14">
<h3>
<span class="header-section-number">4.7.14</span> Default Values<a class="anchor" aria-label="anchor" href="#default-values"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>DEFAULT_HEIGHT</code>: default water height (m)<br>
</li>
<li>
<code>DEFAULT_WIND_SPEED</code>: default wind speed (m/s)<br>
</li>
<li>
<code>DEFAULT_WIND_DIR</code>: wind direction (degrees from North)<br>
</li>
<li>
<code>DEFAULT_&lt;SCALAR&gt;</code>: default scalar value<br>
</li>
<li>
<code>DEFAULT_PAR_EXTINCTION</code>, <code>DEFAULT_NIR_EXTINCTION</code>, <code>DEFAULT_UVA_EXTINCTION</code>, <code>DEFAULT_UVB_EXTINCTION</code>: extinction coefficients<br>
</li>
<li>
<code>DEFAULT_BC</code>: boundary condition preset (1-9)</li>
</ul>
</div>
<div id="input-file-names" class="section level3" number="4.7.15">
<h3>
<span class="header-section-number">4.7.15</span> Input File Names<a class="anchor" aria-label="anchor" href="#input-file-names"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>3D_data_file</code>, <code>preprocessor_file</code>: grid and map files<br>
</li>
<li>
<code>initial_profile_file</code>, <code>initial_horiz_file</code>: initial condition files<br>
</li>
<li>
<code>boundary_condition_file</code>, <code>profile_boundary_condition_file</code>: boundary files<br>
</li>
<li>
<code>update_file</code>, <code>filter_file</code>: updates and filter files<br>
</li>
<li>
<code>drifter_properties_file</code>, <code>drifter_in_file</code>, <code>update_drifter_file</code>: drifter config<br>
</li>
<li>
<code>jet_file</code>, <code>drafttube_file</code>: destratification devices<br>
</li>
<li>
<code>datablock_file</code>: output configuration</li>
</ul>
</div>
<div id="file-directories" class="section level3" number="4.7.16">
<h3>
<span class="header-section-number">4.7.16</span> File Directories<a class="anchor" aria-label="anchor" href="#file-directories"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>infile_dir</code>: directory of input files<br>
</li>
<li>
<code>outfile_unf_dir</code>: binary output directory<br>
</li>
<li>
<code>outfile_txt_dir</code>: text output directory</li>
</ul>
</div>
<div id="output-file-names" class="section level3" number="4.7.17">
<h3>
<span class="header-section-number">4.7.17</span> Output File Names<a class="anchor" aria-label="anchor" href="#output-file-names"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>restart_save_file</code>: base name for save files<br>
</li>
<li>
<code>restart_out_file</code>: base name for restart output</li>
</ul>
</div>
</div>
<div id="input-files" class="section level2" number="4.8">
<h2>
<span class="header-section-number">4.8</span> Input files<a class="anchor" aria-label="anchor" href="#input-files"><i class="fas fa-link"></i></a>
</h2>
<div id="sparsedata.unf-and-usedata.unf" class="section level3" number="4.8.1">
<h3>
<span class="header-section-number">4.8.1</span> sparsedata.unf and usedata.unf<a class="anchor" aria-label="anchor" href="#sparsedata.unf-and-usedata.unf"><i class="fas fa-link"></i></a>
</h3>
<p>The files <code>sparsedata.unf</code> and <code>usedata.unf</code> are required files for ELCOM. These are the Fortran unformatted (binary) files produced by the pre-processor. The user may rename these files, but must keep track of which file is the <code>sparsedata</code> file (<code>3D_data_file</code>) and which is the <code>usedata</code> file (<code>preprocessor_file</code>). ELCOM will look for the files specified in the <code>run_elcom.dat</code> file. If the incorrect files are used, the simulation will crash.</p>
</div>
<div id="sect:tempBCfiles" class="section level3" number="4.8.2">
<h3>
<span class="header-section-number">4.8.2</span> Temporal boundary condition (1D) files<a class="anchor" aria-label="anchor" href="#sect:tempBCfiles"><i class="fas fa-link"></i></a>
</h3>
<p>The one-dimensional temporal boundary condition files (<code>boundary_condition_file</code>) are created by the user to provide environmental forcing information that varies with time. These files must follow a specific format:</p>
<ul>
<li>Four header lines followed by data columns.</li>
<li>First column = time in CWR format (<code>yyyyddd.dd</code>).</li>
<li>Each row represents data for a specific time.</li>
<li>Comment lines (starting with <code>!</code>) may appear at the top.</li>
<li>Header comment lines must have the same number of items as data columns.</li>
<li>No comments allowed within the data block.</li>
<li>All columns must be fully populated (no missing values).</li>
</ul>
<div id="header-line-meanings" class="section level4" number="4.8.2.1">
<h4>
<span class="header-section-number">4.8.2.1</span> Header line meanings:<a class="anchor" aria-label="anchor" href="#header-line-meanings"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>Number of data columns (excluding the time column).</li>
<li>
<code>0</code> indicating CWR time format (first data column should be <code>TIME</code>).</li>
<li>Boundary cell set reference numbers (from <code>bc.dat</code>).</li>
<li>Keywords describing the type of data in each column.</li>
</ol>
<p><strong>Interpolation:</strong> ELCOM linearly interpolates between provided time values to match simulation time steps (<code>del_t</code>).</p>
</div>
<div id="table-temporal-boundary-condition-data-types" class="section level4" number="4.8.2.2">
<h4>
<span class="header-section-number">4.8.2.2</span> Table: Temporal Boundary Condition Data-types<a class="anchor" aria-label="anchor" href="#table-temporal-boundary-condition-data-types"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="23%">
<col width="12%">
<col width="64%">
</colgroup>
<thead><tr class="header">
<th>Keyword</th>
<th>Units</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>HEIGHT</code></td>
<td>m</td>
<td>Water height for open boundary condition</td>
</tr>
<tr class="even">
<td><code>INFLOW</code></td>
<td>m³/s</td>
<td>Inflow volume</td>
</tr>
<tr class="odd">
<td><code>INFLOW_MAXDEPTH</code></td>
<td>m</td>
<td>Max depth for inflow</td>
</tr>
<tr class="even">
<td><code>INFLOW_MINDEPTH</code></td>
<td>m</td>
<td>Min depth for inflow</td>
</tr>
<tr class="odd">
<td><code>INFLOW_HEIGHT</code></td>
<td>m</td>
<td>Inflow height for underflow model</td>
</tr>
<tr class="even">
<td><code>OUTFLOW</code></td>
<td>m³/s</td>
<td>Outflow volume</td>
</tr>
<tr class="odd">
<td><code>GATE_&lt;n&gt;_TOP</code></td>
<td>m</td>
<td>Top of an inflow/outflow gate</td>
</tr>
<tr class="even">
<td><code>GATE_&lt;n&gt;_BOTTOM</code></td>
<td>m</td>
<td>Bottom of an inflow/outflow gate</td>
</tr>
<tr class="odd">
<td><code>GATE_&lt;n&gt;_OPEN</code></td>
<td>-</td>
<td>Status of gate (1=open, 0=closed)</td>
</tr>
<tr class="even">
<td><code>AIRFLOW</code></td>
<td>m³/s</td>
<td>Airflow rate for bubble destratification</td>
</tr>
<tr class="odd">
<td><code>N_PORTS</code></td>
<td></td>
<td>Number of ports in destratification device</td>
</tr>
<tr class="even">
<td><code>RAIN</code></td>
<td>m/day</td>
<td>Rainfall rate</td>
</tr>
<tr class="odd">
<td><code>WIND_SPEED</code></td>
<td>m/s</td>
<td>Wind speed</td>
</tr>
<tr class="even">
<td><code>WIND_DIR</code></td>
<td>°</td>
<td>Wind direction (° clockwise from north)</td>
</tr>
<tr class="odd">
<td><code>SOLAR_RAD</code></td>
<td>W/m²</td>
<td>Solar radiation at water surface</td>
</tr>
<tr class="even">
<td><code>LW_RAD_IN</code></td>
<td>W/m²</td>
<td>Incoming longwave radiation</td>
</tr>
<tr class="odd">
<td><code>LW_RAD_NET</code></td>
<td>W/m²</td>
<td>Net longwave radiation (positive incoming)</td>
</tr>
<tr class="even">
<td><code>ATM_PRESS</code></td>
<td>Pascals</td>
<td>Atmospheric pressure</td>
</tr>
<tr class="odd">
<td><code>CLOUDS</code></td>
<td></td>
<td>Fractional cloud cover (0 to 1)</td>
</tr>
<tr class="even">
<td><code>REL_HUM</code></td>
<td></td>
<td>Relative humidity (0 to 1)</td>
</tr>
<tr class="odd">
<td><code>AIR_TEMP</code></td>
<td>°C</td>
<td>Air temperature</td>
</tr>
<tr class="even">
<td><code>&lt;SCALAR&gt;</code></td>
<td>-</td>
<td>Valid transportable scalar</td>
</tr>
</tbody>
</table></div>
</div>
<div id="notes" class="section level4" number="4.8.2.3">
<h4>
<span class="header-section-number">4.8.2.3</span> Notes:<a class="anchor" aria-label="anchor" href="#notes"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code>INFLOW_MAXDEPTH</code> and <code>INFLOW_MINDEPTH</code>: allow control of inflow depths, enabling inflow at the surface of a thalweg cell even as surface level varies.</li>
<li>
<code>GATE_&lt;n&gt;_TOP</code>, <code>GATE_&lt;n&gt;_BOTTOM</code>, <code>GATE_&lt;n&gt;_OPEN</code>: specify selective withdrawal gates. <code>n</code> is the gate number (e.g. <code>GATE_1_TOP</code>), with <code>OPEN</code> = 1 (open) or 0 (closed). Flow is distributed among open gates based on area.</li>
</ul>
<p>These features allow for more realistic simulation of systems like reservoirs with variable surface height or dam withdrawal structures.</p>
</div>
</div>
<div id="temporal-profile-boundary-condition-2d-files" class="section level3" number="4.8.3">
<h3>
<span class="header-section-number">4.8.3</span> Temporal profile boundary condition (2D) files<a class="anchor" aria-label="anchor" href="#temporal-profile-boundary-condition-2d-files"><i class="fas fa-link"></i></a>
</h3>
<p>The two-dimensional temporal profile boundary condition files (<code>profile_boundary_condition_file</code>) are used to provide scalar boundary information that varies with both time and depth. These files consist of:</p>
<ul>
<li>Four header lines</li>
<li>Sections of data, each representing a profile at a specific time</li>
</ul>
<div id="header-lines" class="section level4" number="4.8.3.1">
<h4>
<span class="header-section-number">4.8.3.1</span> Header lines:<a class="anchor" aria-label="anchor" href="#header-lines"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>Number of data sets per section (including <code>DEPTH</code>, excluding the <code>TIME</code> row)</li>
<li>Must contain <code>0</code> to indicate CWR time format; data section starts with <code>TIME</code>
</li>
<li>Boundary cell set reference numbers (including <code>TIME</code> and <code>DEPTH</code>) — each file may apply to only <strong>one</strong> boundary set</li>
<li>Keywords for each column (<code>TIME</code>, <code>DEPTH</code>, and valid scalar keywords)</li>
</ol>
</div>
<div id="data-section" class="section level4" number="4.8.3.2">
<h4>
<span class="header-section-number">4.8.3.2</span> Data section:<a class="anchor" aria-label="anchor" href="#data-section"><i class="fas fa-link"></i></a>
</h4>
<p>Each section contains:
- One header row: the profile time (<code>yyyyddd.dd</code>) and number of depths
- One row for <code>DEPTH</code> values (depths in meters below the surface)
- Subsequent rows: one per scalar, with values at each depth</p>
<p>All sections must:
- Contain the same number of data rows (one per scalar)
- Maintain the same order of keywords per section</p>
<hr>
</div>
</div>
<div id="sect:updateBCfiles" class="section level3" number="4.8.4">
<h3>
<span class="header-section-number">4.8.4</span> Update boundary condition files<a class="anchor" aria-label="anchor" href="#sect:updateBCfiles"><i class="fas fa-link"></i></a>
</h3>
<p>The update boundary condition files (<code>update_file</code>) are used to update scalar values on boundaries during specified time intervals (e.g., tracer releases). Format is the same as 1D temporal boundary condition files, <strong>except</strong>:</p>
<ul>
<li>Two <code>TIME</code> columns per row are provided</li>
<li>Scalar values are applied during timesteps between the first and second time column</li>
</ul>
<p>If a timestep doesn’t fall within any of these intervals, no update is applied.</p>
<hr>
</div>
<div id="sect:tempFiltFiles" class="section level3" number="4.8.5">
<h3>
<span class="header-section-number">4.8.5</span> Temporal filter constant files<a class="anchor" aria-label="anchor" href="#sect:tempFiltFiles"><i class="fas fa-link"></i></a>
</h3>
<p>Temporal filter constant files (<code>filter_file</code>) provide time-varying filter constants for scalars. They follow the same format as the 1D temporal boundary condition files.</p>
<ul>
<li>Third header line still includes boundary cell set reference, <strong>but it is ignored</strong>
</li>
<li>All keywords must be valid transportable scalars</li>
</ul>
<hr>
</div>
<div id="drifter-files" class="section level3" number="4.8.6">
<h3>
<span class="header-section-number">4.8.6</span> Drifter files<a class="anchor" aria-label="anchor" href="#drifter-files"><i class="fas fa-link"></i></a>
</h3>
<div id="drifter-properties-files" class="section level4" number="4.8.6.1">
<h4>
<span class="header-section-number">4.8.6.1</span> Drifter Properties Files<a class="anchor" aria-label="anchor" href="#drifter-properties-files"><i class="fas fa-link"></i></a>
</h4>
<p>The drifter properties file (<code>drifter_properties_file</code>) provides physical properties of semi-Lagrangian drifters. If only Lagrangian particles are simulated, this file can be blank.</p>
<p>Each line contains <strong>four columns</strong>:</p>
<ol style="list-style-type: decimal">
<li>Value</li>
<li>Target drifters (e.g., <code>:</code>, or <code>n1:n2</code>)</li>
<li>Target components (e.g., <code>:</code>, or <code>n1:n2</code>)</li>
<li>Property keyword</li>
</ol>
</div>
<div id="valid-property-keywords" class="section level4" number="4.8.6.2">
<h4>
<span class="header-section-number">4.8.6.2</span> Valid property keywords:<a class="anchor" aria-label="anchor" href="#valid-property-keywords"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code>mass</code>: mass of the component (kg)</li>
<li>
<code>area</code>: cross-sectional area (m²)</li>
<li>
<code>length</code>: vertical length (m)</li>
<li>
<code>drag_cd</code>: drag coefficient</li>
<li>
<code>distance</code>: vertical distance from probe base to component base (m)</li>
</ul>
</div>
<div id="shape-keyword-values" class="section level4" number="4.8.6.3">
<h4>
<span class="header-section-number">4.8.6.3</span> <code>shape</code> keyword values:<a class="anchor" aria-label="anchor" href="#shape-keyword-values"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>1 = sphere<br>
</li>
<li>2 = cylinder<br>
</li>
<li>3 = rectangle</li>
</ul>
</div>
<div id="type-keyword-values" class="section level4" number="4.8.6.4">
<h4>
<span class="header-section-number">4.8.6.4</span> <code>type</code> keyword values:<a class="anchor" aria-label="anchor" href="#type-keyword-values"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>1 = submerged — forced by modeled water velocities<br>
</li>
<li>2 = subsurface — forced by surface wind shear velocity<br>
</li>
<li>3 = surface — forced by wind</li>
</ul>
<p>Therefore an example file for drifters consisting of five components (antenna, surface buoy, subsurface buoy, pole connecting the drogue to the subsurface buoy and the drifter sails) may look something like:</p>
<pre class="plaintext"><code>! - - - -
! ! Example Drifter Properties File
! ! NB each comment line should have 4 words
! - - - -
! Component 1 sail
26.0   :    1    mass
1.5    :    1    area
1.0    :    1    length
0.3    :    1    drag_cd
0.0    :    1    distance
3      :    1    shape
1      :    1    type
! Component 2 Pole
3.0    :    2    mass
0.001  :    2    area
1.0    :    2    length
0.3    :    2    drag_cd
1.0    :    2    distance
2      :    2    shape
1      :    2    type
! Component 3 sub-surface float
0.2    :    3    mass
0.2    :    3    area
0.2    :    3    length
0.3    :    3    drag_cd
2.3    :    3    distance
3      :    3    shape
2      :    3    type
! Component 4 surface float
0.1    :    4    mass
0.01   :    4    area
0.1    :    4    length
0.3    :    4    drag_cd
2.5    :    4    distance
3      :    4    shape
3      :    4    type
! Component 5 antennea
1.0    :    5    mass
0.01   :    5    area
0.3    :    5    length
0.3    :    5    drag_cd
2.6    :    5    distance
2      :    5    shape
3      :    5    type</code></pre>
</div>
</div>
<div id="drifter-initial-files" class="section level3" number="4.8.7">
<h3>
<span class="header-section-number">4.8.7</span> Drifter Initial Files<a class="anchor" aria-label="anchor" href="#drifter-initial-files"><i class="fas fa-link"></i></a>
</h3>
<p>The drifter initial files (<code>drifter_in_file</code>) are used to provide initial conditions and simulation properties for drifters and particles.</p>
<p>Each line of the <code>drifter_in_file</code> should contain <strong>three columns</strong>:
1. A value
2. Target drifters (<code>:</code> for all, or <code>n1:n2</code> for a range)
3. A keyword that specifies the property to set</p>
</div>
<div id="valid-keywords" class="section level3" number="4.8.8">
<h3>
<span class="header-section-number">4.8.8</span> Valid keywords:<a class="anchor" aria-label="anchor" href="#valid-keywords"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p><code>start_t</code>: starting timestep for the drifter</p></li>
<li><p><code>end_t</code>: ending timestep for the drifter</p></li>
<li>
<p><code>solution_method</code>: type of drifter</p>
<ul>
<li>1 = Drifter with constant elevation<br>
</li>
<li>2 = Drifter with constant depth<br>
</li>
<li>3 = Drifter with constant density<br>
</li>
<li>4 = Lagrangian Particle with constant elevation<br>
</li>
<li>5 = Lagrangian Particle with constant depth<br>
</li>
<li>6 = Lagrangian Particle with constant density<br>
</li>
<li>7 = 3D Lagrangian Particle</li>
</ul>
</li>
<li>
<p><code>beach_method</code>:</p>
<ul>
<li>1 = Remove drifter when it hits land<br>
</li>
<li>2 = Drifter continues if it hits land<br>
&gt; <strong>Note:</strong> Drifters are always removed if they cross an open boundary.</li>
</ul>
</li>
<li><p><code>cfl_max</code>: maximum timestep for drifter (sub-timestepped if CFL &gt; <code>cfl_max</code>)</p></li>
<li><p><code>drogue_density</code>: density of drogue/particle (used for constant density solutions)</p></li>
<li><p><code>centre_of_mass</code>: distance of centre of mass from bottom of drogue (used for constant density solutions)</p></li>
<li><p><code>depth</code>: depth of bottom of drogue/particle (used for constant depth solutions)</p></li>
<li>
<p><code>start_i</code>, <code>start_j</code>, <code>start_k</code>: starting position in <code>i, j, k</code> grid coordinates</p>
<ul>
<li>Example: <code>start_i = 8.5</code>, <code>start_j = 8.5</code>, <code>start_k = 5.5</code> places the drifter in the center of cell <code>(i = 8, j = 8, k = 5)</code>
</li>
</ul>
</li>
<li><p><code>start_x</code>, <code>start_y</code>, <code>start_z</code>: starting position in physical <code>x, y, z</code> coordinates</p></li>
<li><p><code>start_cell</code>: starting cell number (in 1D sparse array)</p></li>
</ul>
<hr>
<p>An example file may look something like:</p>
<pre class="plaintext"><code>! - - - -
! ! Example Drifter Initial File
! ! NB each comment line should have 3 words
! - - - -
8.5    :    start_i
14.5   :    start_j
6.7    :    start_k
2      :    solution_method
2      :    beach_method
1.5    :    depth</code></pre>
</div>
<div id="drifter-update-files" class="section level3" number="4.8.9">
<h3>
<span class="header-section-number">4.8.9</span> Drifter Update Files<a class="anchor" aria-label="anchor" href="#drifter-update-files"><i class="fas fa-link"></i></a>
</h3>
<p>The drifter update files (<code>update_drifter_file</code>) are used to update drifter positions or solution methods during a simulation. These files are primarily designed to incorporate real-time position updates from measurements.</p>
<p>The format is the same as standard update boundary condition files, <strong>except</strong>:
- The third header line contains a <strong>drifter number</strong> instead of a boundary condition set number.
- The update is applied to the specified drifter for all timesteps between the two time values on each row.</p>
<p>If the current timestep is not between the two specified time values of a row, no update is made.</p>
</div>
<div id="valid-keywords-for-updates" class="section level3" number="4.8.10">
<h3>
<span class="header-section-number">4.8.10</span> Valid keywords for updates:<a class="anchor" aria-label="anchor" href="#valid-keywords-for-updates"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>solution_method</code>: (see earlier for method options)</li>
<li>
<code>beach_method</code>: (see earlier for options)</li>
<li>
<code>cfl_max</code>: maximum timestep (drifter is sub-timestepped if CFL &gt; <code>cfl_max</code>)</li>
<li>
<code>drogue_density</code>: density of drogue/particle (for constant density mode)</li>
<li>
<code>centre_of_mass</code>: vertical offset from bottom of drogue to its center of mass</li>
<li>
<code>depth</code>: depth of drogue/particle (for constant depth solutions)</li>
<li>
<code>i, j, k</code>: updated grid coordinates for drifter position</li>
<li>
<code>x, y, z</code>: updated physical coordinates</li>
<li>
<code>cell</code>: updated cell index in 1D sparse array</li>
</ul>
<hr>
<p>An example file may look something like:</p>
<pre class="plaintext"><code>! - - - -
! ! Example Drifter Update File
! ! NB each comment line  should have 3 words
! - - - -
2 data sets
0 seconds between data
0          0          1   1
TIME       TIME       i   j
2005001.50 2005001.60 6.7 7.2</code></pre>
</div>
<div id="jet-files" class="section level3" number="4.8.11">
<h3>
<span class="header-section-number">4.8.11</span> Jet Files<a class="anchor" aria-label="anchor" href="#jet-files"><i class="fas fa-link"></i></a>
</h3>
<p>The jet files (<code>jet_file</code>) are used to define the properties of a jet or pump employed for artificial destratification.</p>
<p>These files must follow a specific format:</p>
<ul>
<li><strong>Three header lines</strong></li>
<li><strong>Four columns of data</strong></li>
<li>Data corresponds to specific instants of time and applies to a particular jet</li>
<li>Comments (<code>!</code>) are allowed at the top of the file</li>
<li>All data rows must be fully populated — <strong>no missing values allowed</strong>
</li>
</ul>
<div id="header-line-definitions" class="section level4" number="4.8.11.1">
<h4>
<span class="header-section-number">4.8.11.1</span> Header line definitions:<a class="anchor" aria-label="anchor" href="#header-line-definitions"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>
<strong>Jet reference number</strong> (used for debugging purposes only)</li>
<li>
<strong>i and j location</strong> of the jet (two integers)</li>
<li>
<strong>Column headers</strong> for the data that follows</li>
</ol>
<blockquote>
<p><em>Note: The expected structure of the third header line and the data columns can include variables like time, thrust, radius, and depth or height depending on the configuration, although this was not specified completely in the original text.</em></p>
</blockquote>
<pre class="plaintext"><code> TIME THRUST RADIUS DEPTH</code></pre>
<pre class="plaintext"><code> TIME THRUST RADIUS HEIGHT</code></pre>
<p>The four data colums are</p>
</div>
<div id="data-column-descriptions-jet-files" class="section level4" number="4.8.11.2">
<h4>
<span class="header-section-number">4.8.11.2</span> Data Column Descriptions (Jet Files)<a class="anchor" aria-label="anchor" href="#data-column-descriptions-jet-files"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code>TIME</code>: The date in CWR Julian Day format (<code>yyyyddd.ddd</code>)</li>
<li>
<code>THRUST</code>: Force of the pump in Newtons</li>
<li>
<code>RADIUS</code>: Radius of the pump in metres</li>
<li>
<code>DEPTH</code> or <code>HEIGHT</code>: Either the depth of the pump from the surface level or the height from the bottom (in metres)</li>
</ul>
<pre class="plaintext"><code>! - - - -
! Example Jet File
! - - - -
1 jet ID number
6 12 i,j location of jet data
TIME      THRUST RADIUS DEPTH
2005001.0 3000   2.0    2.2
2005011.0 3000   2.0    2.2</code></pre>
</div>
</div>
<div id="drafttube-files" class="section level3" number="4.8.12">
<h3>
<span class="header-section-number">4.8.12</span> Drafttube Files<a class="anchor" aria-label="anchor" href="#drafttube-files"><i class="fas fa-link"></i></a>
</h3>
<p>The drafttube files (<code>drafttube_file</code>) are used to define the properties of a pump with a drafttube used for artificial destratification.</p>
<p>These files must follow this structure:</p>
<ul>
<li><strong>Three header lines</strong></li>
<li><strong>Five columns of data</strong></li>
<li>Each row provides values at specific time instances for a single device</li>
<li>Comment lines (starting with <code>!</code>) may appear at the top of the file</li>
<li>
<strong>All data columns must be complete</strong> — no missing values in any row</li>
</ul>
<div id="header-line-definitions-1" class="section level4" number="4.8.12.1">
<h4>
<span class="header-section-number">4.8.12.1</span> Header line definitions:<a class="anchor" aria-label="anchor" href="#header-line-definitions-1"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>A <strong>drafttube reference number</strong> (used for debugging only)</li>
<li>Two integers indicating the <strong>i and j location</strong> of the device</li>
<li>A line containing the <strong>column headers</strong> for the data that follows</li>
</ol>
<blockquote>
<p><em>Note: The exact headers for the data columns (e.g., <code>TIME</code>, <code>THRUST</code>, <code>RADIUS</code>, <code>DEPTH</code>, <code>LENGTH</code>) should follow this third line, depending on what is specified for each simulation setup.</em></p>
</blockquote>
<pre class="plaintext"><code> TIME FLOW RADIUS DEPTH LENGTH</code></pre>
<p>The four data colums are
#### Data Column Descriptions (Drafttube Files)</p>
<ul>
<li>
<code>TIME</code>: The date in CWR Julian Day format (<code>yyyyddd.ddd</code>)</li>
<li>
<code>FLOW</code>: Flow rate through the pump in m³/s<br><em>Note: This value should be negative (i.e., pumping downward through the tube).</em>
</li>
<li>
<code>RADIUS</code>: Radius of the pump and tube in metres</li>
<li>
<code>DEPTH</code>: Depth of the pump from the surface level (in metres)</li>
<li>
<code>LENGTH</code>: Length of the draft tube in metres</li>
</ul>
<pre class="plaintext"><code>! - - - -
! Example drafttube File
! - - - -
1 drafttube ID number
6 12 i,j location of jet data
TIME      FLOW RADIUS DEPTH  LENGTH
2005001.0 -5   2.0    2.2    5.0
2005011.0 -5   2.0    2.2    5.0</code></pre>
</div>
</div>
</div>
<div id="definition-of-culvert-characteristics-dynamic-boundary-conditions" class="section level2" number="4.9">
<h2>
<span class="header-section-number">4.9</span> Definition of Culvert Characteristics – Dynamic Boundary Conditions<a class="anchor" aria-label="anchor" href="#definition-of-culvert-characteristics-dynamic-boundary-conditions"><i class="fas fa-link"></i></a>
</h2>
<p>When dynamic boundary conditions are defined in <code>pre_elcom</code>, the characteristics of the culvert connecting the pair of boundary conditions must be provided. These characteristics are supplied in a file specified in <code>run_elcom.dat</code> using the keyword <code>dynamic_boundary_condition_file</code>.</p>
<p>These files require:
- Three header lines
- One line listing culvert characteristics to be defined
- One or more data rows for each culvert</p>
<p><strong>Header Format:</strong>
1. Two values – boundary condition reference numbers (as defined in <code>pre_elcom</code>)
2. One value – number of characteristics being specified (between 3 and 12)
3. One value – number of pipes in the set (only circular pipes supported)
4. One line – column headers for culvert characteristics</p>
<div id="supported-culvert-keywords-and-defaults" class="section level3" number="4.9.1">
<h3>
<span class="header-section-number">4.9.1</span> Supported Culvert Keywords and Defaults<a class="anchor" aria-label="anchor" href="#supported-culvert-keywords-and-defaults"><i class="fas fa-link"></i></a>
</h3>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="18%">
<col width="11%">
<col width="69%">
</colgroup>
<thead><tr class="header">
<th><code>KEYWORD</code></th>
<th>Default</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>PIPE_K</code></td>
<td>0.098</td>
<td>Inlet control factor K – unsubmerged pipe</td>
</tr>
<tr class="even">
<td><code>PIPE_M</code></td>
<td>2.000</td>
<td>Inlet control exponent M – unsubmerged pipe</td>
</tr>
<tr class="odd">
<td><code>PIPE_C</code></td>
<td>0.398</td>
<td>Inlet control factor C – submerged pipe</td>
</tr>
<tr class="even">
<td><code>PIPE_Y</code></td>
<td>0.670</td>
<td>Inlet control term Y – submerged pipe</td>
</tr>
<tr class="odd">
<td><code>EPS_ENTRY</code></td>
<td>0.500</td>
<td>Head loss at pipe inlet</td>
</tr>
<tr class="even">
<td><code>EPS_EXIT</code></td>
<td>1.000</td>
<td>Head loss at pipe outlet</td>
</tr>
<tr class="odd">
<td><code>EPS_FLAP_IN</code></td>
<td>0.000</td>
<td>Head loss for flapped gate at first boundary</td>
</tr>
<tr class="even">
<td><code>EPS_FLAP_OUT</code></td>
<td>0.000</td>
<td>Head loss for flapped gate at second boundary</td>
</tr>
<tr class="odd">
<td><code>PIPE_MAN</code></td>
<td>0.015</td>
<td>Manning’s coefficient</td>
</tr>
<tr class="even">
<td><code>PIPE_PHI</code></td>
<td>required</td>
<td>Pipe diameter</td>
</tr>
<tr class="odd">
<td><code>PIPE_LEN</code></td>
<td>required</td>
<td>Pipe length</td>
</tr>
<tr class="even">
<td><code>PIPE_HEIGHT</code></td>
<td>required</td>
<td>Pipe bottom height (relative to domain reference level)</td>
</tr>
</tbody>
</table></div>
</div>
<div id="example-file" class="section level3" number="4.9.2">
<h3>
<span class="header-section-number">4.9.2</span> Example File<a class="anchor" aria-label="anchor" href="#example-file"><i class="fas fa-link"></i></a>
</h3>
<pre class="plaintext"><code>! Boundary Condition file for Culverts
2 1 ! Pair of dynamic sets
7   ! data sets
10  ! number of pipes
EPS_ENTRY  EPS_EXIT EPS_FLAP_IN  PIPE_PHI  PIPE_LEN  PIPE_MAN  PIPE_HEIGHT
0.500      1.000      0.100      0.500     15.0       0.015       2.750</code></pre>
</div>
<div id="sect:datablock" class="section level3" number="4.9.3">
<h3>
<span class="header-section-number">4.9.3</span> Output definition file (Datablock.db)<a class="anchor" aria-label="anchor" href="#sect:datablock"><i class="fas fa-link"></i></a>
</h3>
<p>The file <code>datablock.db</code> is a text file produced by the user, and contains the configuration data used to set up the users output. The name for this file is specified by the user.</p>
<p>A <code>datablock.db</code> file is structured as a series of blocks of instructions. Each block requires an exact number of lines, with specific instructions on each line. Each line contains a single instruction followed by a comment. The comment must begin with a “!” character. In manually editing <code>datablock.db</code> files, it is important to keep in mind that while blocks of instructions may be added or removed, lines within a block can only be modified, but not removed. The following will discuss the structure of each block of instructions.</p>
<div id="datablock-description" class="section level4" number="4.9.3.1">
<h4>
<span class="header-section-number">4.9.3.1</span> Datablock Description<a class="anchor" aria-label="anchor" href="#datablock-description"><i class="fas fa-link"></i></a>
</h4>
<p>The first 4 lines of a <code>datablock.db</code> are the datablock description. In order, they are the block descriptor, the current datablock version number, the number of output groups, and the number of output sets. Output groups and sets are described below.</p>
</div>
<div id="group-description" class="section level4" number="4.9.3.2">
<h4>
<span class="header-section-number">4.9.3.2</span> Group Description<a class="anchor" aria-label="anchor" href="#group-description"><i class="fas fa-link"></i></a>
</h4>
<p>Following the datablock description are the group description blocks. A group represents a group of data to be output. A data group is defined as an output filename, datatypes to be output (i.e. <code>TEMPERATURE, SALINITY</code>, etc…), the location within the simulation domain of the points at which data is to be output, and the time at which data is to be output. If several groups are desired, the group descriptions must follow each other without breaks between them.</p>
<p>A group description block contains 11 lines, which are as follows:</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="31%">
<col width="68%">
</colgroup>
<thead><tr class="header">
<th>Line</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>
<code>BEGIN GROUP_DESCRIPTION</code> — begin block statement</td>
</tr>
<tr class="even">
<td>2</td>
<td>Group reference number — an integer labelling the group, this can have any value</td>
</tr>
<tr class="odd">
<td>3</td>
<td>User label — a name containing no blank spaces labelling the group</td>
</tr>
<tr class="even">
<td>4</td>
<td>Output filename — should include <code>.unf</code> suffix</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Set reference number — an integer corresponding to a description of a set of points at which the data are to be output (sets will be described after groups)</td>
</tr>
<tr class="even">
<td>6</td>
<td>Number of datatypes in group — an integer indicating the desired number of datatypes to be output (i.e. <code>TEMPERATURE, SALINITY</code>, etc…)</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Should read <code>.TRUE.</code>, do not modify</td>
</tr>
<tr class="even">
<td>8</td>
<td>Output interval — an integer indicating the desired number of timesteps between outputs</td>
</tr>
<tr class="odd">
<td>9</td>
<td>Output start time — an integer indicating which time step to begin outputting data</td>
</tr>
<tr class="even">
<td>10</td>
<td>Output end time — an integer indicating which time step to stop outputting data, <code>0</code> indicates entire run</td>
</tr>
<tr class="odd">
<td>11</td>
<td>Should read <code>0</code>, do not modify</td>
</tr>
</tbody>
</table></div>
</div>
<div id="set-description" class="section level4" number="4.9.3.3">
<h4>
<span class="header-section-number">4.9.3.3</span> Set Description<a class="anchor" aria-label="anchor" href="#set-description"><i class="fas fa-link"></i></a>
</h4>
<p>A set is a set of points at which data are to be output. This can include a vertical column of points, a contiguous series of columns of points (curtain), a horizontal sheet of points, a collection of drifters, a collection of outflows, or any group of points in the three-dimensional domain. The valid set types are:</p>
<pre><code>PROFILE_1D  
CURTAIN_2D  
SHEET_2D  
DRIFTER  
OUTFLOW  
ALL_3D  
GENERAL_3D  </code></pre>
<p>Profiles and curtains require only the (x, y) locations of the base of each column to describe their location. Sheets can be referenced to a layer, a height above user datum, a height above bottom, or a height below the free-surface. Drifters are referenced by their drifter number from 1 to <code>n_drifters</code>. <code>OUTFLOW</code> outputs total flow and average scalar concentrations for flow out of the domain. Outflows are referred to by their bc reference number in <code>bc.dat</code>. <code>ALL_3D</code> simply outputs all points in the domain, and <code>GENERAL_3D</code> at points whose coordinates are individually specified.</p>
<p>A set description block contains 16 lines, which are as follows:</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="31%">
<col width="68%">
</colgroup>
<thead><tr class="header">
<th>Line</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>
<code>BEGIN SET_DESCRIPTION</code> — begin set statement</td>
</tr>
<tr class="even">
<td>2</td>
<td>Set reference number — an integer labelling the set, this can have any value</td>
</tr>
<tr class="odd">
<td>3</td>
<td>User label — a name containing no blank spaces labelling the set</td>
</tr>
<tr class="even">
<td>4</td>
<td>Type of set — one of the 7 valid set type names described above</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Number of cells in set — varies by set type:<br> - <code>PROFILE</code>: number of vertical columns<br> - <code>CURTAIN2D</code>: number of columns making up the curtain<br> - <code>DRIFTER</code>: number of drifters to output<br> - <code>OUTFLOW</code>: number of outflow bc sets to output<br> - <code>SHEET_2D</code>, <code>ALL_3D</code>: use <code>0</code>
</td>
</tr>
<tr class="even">
<td>6</td>
<td>Sheet type — only for <code>SHEET_2D</code>. Valid keywords:<br> - <code>LAYER</code>: referenced as layer number up from bottom (see <code>bathymetry.dat</code>)<br> - <code>HEIGHT</code>: height in meters above datum (see <code>bathymetry.dat</code>)<br> - <code>BOTTOM</code>: meters above bottom<br> - <code>SURFACE</code>: meters below free-surface (evolves in time)<br> - <code>FLAT</code>: flat calculation layer</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Sheet calc — only for <code>SHEET_2D</code>. Valid options:<br> - <code>NEAREST</code>: nearest vertical grid point (required for <code>LAYER</code>, <code>HEIGHT</code>, <code>BOTTOM</code>, <code>SURFACE</code>)<br> - <code>MAX</code>: maximum in column (only with <code>FLAT</code>)<br> - <code>MIN</code>: minimum in column (only with <code>FLAT</code>)<br> - <code>AVG</code>: average in column (only with <code>FLAT</code>)<br> - <code>TOTAL</code>: integrated column value (only with <code>FLAT</code>)</td>
</tr>
<tr class="even">
<td>8</td>
<td>Sheet value —<br> - <code>LAYER</code>: layer number<br> - <code>HEIGHT</code>, <code>BOTTOM</code>, <code>SURFACE</code>: vertical distance in meters<br> - <code>FLAT</code>: use <code>0</code>
</td>
</tr>
<tr class="odd">
<td>9–16</td>
<td>Not implemented, do not modify</td>
</tr>
</tbody>
</table></div>
</div>
<div id="group-data-types" class="section level4" number="4.9.3.4">
<h4>
<span class="header-section-number">4.9.3.4</span> 4 Group data types<a class="anchor" aria-label="anchor" href="#group-data-types"><i class="fas fa-link"></i></a>
</h4>
<p>This block begins with the desired number of data types, followed by a listing of the desired data types.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="31%">
<col width="68%">
</colgroup>
<thead><tr class="header">
<th>Line</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>
<code>BEGIN GROUP_DATA_TYPES</code> — Begin data type description</td>
</tr>
<tr class="even">
<td>2</td>
<td>Group reference number — An integer referencing the group number defined in the group description</td>
</tr>
<tr class="odd">
<td>3–n</td>
<td>Data types — One data type descriptor per line. The possible data type descriptors are:</td>
</tr>
</tbody>
</table></div>
<pre><code>&lt;TEMPERATURE&gt;
&lt;SALINITY&gt;
U_VELOCITY
V_VELOCITY
W_VELOCITY
DENSITY
EXTINCTION
F_PRESSURE
T_PRESSURE
RI
SHEAR
MIX_ENERGY
MIX_FRACTION
MIX_REGIME
SHEAR_ENERGY
WIND_ENERGY
BBL_ENERGY
DISSIPATION
RETENTION_T
HEIGHT
SLOPE_X
SLOPE_Y
WIND_SPEED
WIND_DIR
WIND_U
WIND_V
RAIN
REL_HUM
LW_RAD_IN
LW_RAD_NET
SOLAR_RAD
ATM_PRESS
CLOUDS
AIR_TEMP
AUX_1
AUX_2
AUX_3
AUX_4
AUX_5
EVAP_VOL_FLUX
EVAP_MASS_FLUX
EVAP_HEAT_FLUX
SENS_HEAT_FLUX
HUMIDITY_ALT
HUMIDITY_SURF
C_WIND
C_HEAT</code></pre>
<p><strong>Underflow Variables</strong>:</p>
<pre><code>&lt;SCALAR&gt;_UND
H_UND
U_UND
V_UND
DENSITY_UND
PRESSURE_UND
E_COEFF_UND
RI_UND
E_VOLUME_UND
E_VEL_XS_UND
XP_F_UND_INDEX
YP_F_UND_INDEX
XN_F_UND_INDEX
YN_F_UND_INDEX</code></pre>
<p>For <code>DRIFTER</code> set types the value output is the value at the location of the bottom of the drifter.</p>
<p>For <code>OUTFLOW</code> set types the scalar value output is the average value for the total flow out.<br><strong>Note:</strong> Scalar is actually estimated using a first-order upwind scheme rather than the actual ULTIMATE-QUICKEST flux values.</p>
</div>
</div>
<div id="group-time-list" class="section level3" number="4.9.4">
<h3>
<span class="header-section-number">4.9.4</span> 5 Group Time List<a class="anchor" aria-label="anchor" href="#group-time-list"><i class="fas fa-link"></i></a>
</h3>
<p>This block is required to initialize a time stamp for each group. It requires only two lines as follows:</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="31%">
<col width="68%">
</colgroup>
<thead><tr class="header">
<th>Line</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>
<code>BEGIN GROUP_TIME_LIST</code> — Begin group time list</td>
</tr>
<tr class="even">
<td>2</td>
<td>Group reference number — An integer referencing the group number defined in the group description</td>
</tr>
</tbody>
</table></div>
<hr>
</div>
<div id="set-cell-data" class="section level3" number="4.9.5">
<h3>
<span class="header-section-number">4.9.5</span> 6 Set Cell Data<a class="anchor" aria-label="anchor" href="#set-cell-data"><i class="fas fa-link"></i></a>
</h3>
<p>This block describes the spatial location of each datablock set. The locations are described as row, column, and/or layer number.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="31%">
<col width="68%">
</colgroup>
<thead><tr class="header">
<th>Line</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>
<code>BEGIN SET_CELL_DATA</code> — Begin set cell data</td>
</tr>
<tr class="even">
<td>2</td>
<td>Set reference number — An integer referencing the set number defined in the set description</td>
</tr>
<tr class="odd">
<td>3–n</td>
<td>Cell locations — This input varies for different set types as follows:</td>
</tr>
</tbody>
</table></div>
<p><strong>Set type-specific input formats:</strong></p>
<ul>
<li><p><code>PROFILE</code>:<br>
Each profile requires a row of input. Each row requires 4 integers:<br><code>x-row</code>, <code>y-column</code>, <code>0</code>, <code>0</code></p></li>
<li><p><code>CURTAIN_2D</code>:<br>
Each profile making up the curtain requires a row of input. Each row requires 4 integers:<br><code>x-row</code>, <code>y-column</code>, <code>0</code>, <code>0</code></p></li>
<li><p><code>SHEET_2D</code>:<br>
No input required.</p></li>
<li><p><code>DRIFTER</code>:<br>
The drifters to be output. Each row requires 4 integers:<br><code>drifter number</code>, <code>0</code>, <code>0</code>, <code>0</code></p></li>
<li><p><code>OUTFLOW</code>:<br>
The bc sets to be output. Each row requires 4 integers:<br><code>bcset number (from bc.dat)</code>, <code>0</code>, <code>0</code>, <code>0</code></p></li>
<li><p><code>ALL_3D</code>:<br>
No input required.</p></li>
<li><p><code>GENERAL_3D</code>:<br>
Each point requires a row of input. Each row requires 3 integers:<br><code>x-row</code>, <code>y-column</code>, <code>z-layer</code></p></li>
</ul>
</div>
</div>
<div id="sect:runexe" class="section level2" number="4.10">
<h2>
<span class="header-section-number">4.10</span> Running ELCOM<a class="anchor" aria-label="anchor" href="#sect:runexe"><i class="fas fa-link"></i></a>
</h2>
<p>ELCOM is executed at the command line by typing <code>elcom.exe</code> within the directory <em>where the <code>run_elcom.dat</code> and all the appropriate input data files</em> are located. The monitoring/debugging output is sent to the standard output of the computer (the display terminal on most computers). Unless the simulation run is very short, it is recommended that the user redirect the output to a file with a execution redirection such as:</p>
<pre><code>elcom.exe &gt;&amp; run_output.txt</code></pre>
<div id="sect:postproc" class="section level3" number="4.10.1">
<h3>
<span class="header-section-number">4.10.1</span> Post-Processing<a class="anchor" aria-label="anchor" href="#sect:postproc"><i class="fas fa-link"></i></a>
</h3>
<div id="conversion-of-datablock-file-to-netcdf" class="section level4" number="4.10.1.1">
<h4>
<span class="header-section-number">4.10.1.1</span> Conversion of datablock file to NETCDF<a class="anchor" aria-label="anchor" href="#conversion-of-datablock-file-to-netcdf"><i class="fas fa-link"></i></a>
</h4>
<p>The datablock output files are named and configured through the <code>datablock.db</code> file. ELCOM produces Fortran unformatted (binary) files as specified by the datablock output configuration. In general, one datablock output file contains one or more data types (e.g. velocity, temperature) applied to a set of points at a specified time interval. These files can be reprocessed into NETCDF files using the command-line program <code>dbconv.exe</code>.</p>
<p>The program <code>dbconv.exe</code> is used for converting datablock unformatted binary files created by ELCOM to NETCDF files which can then be processed and viewed in a program such as Matlab. The <code>dbconv.exe</code> executable should be placed either in the working directory or as recommended in the <code>/bin</code> directory which is in the operating system’s search path. <code>dbconv</code> is run through a configuration file called <code>run_dbconv.dat</code>.</p>
<p>The <code>run_dbconv.dat</code> file contains 9 lines as follows:</p>
<pre><code> Comment line, up to 64 characters
 .unf file name and path
 sparsedata.unf file name and path
 .nc netcdf output file name and path
 Start time step, -1 for beginning
 End time step, -1 for end of file
 Overwriting of .nc file? -  clobber for overwriting, no_clobber for no overwriting
 Output mapping info to text file? -  map for writing, no_map for no overwriting
 Output diagnosics to monitor?  -  echo to output to monitor, no_echo to not output to monitor</code></pre>
<p>An example <code>run_dbconv.dat</code> file would be:</p>
<pre><code> Example dbconv
 unfiles/curtain.unf
 infiles/sparsedata.unf
 ncfiles/curtain.nc
 -1
 -1
 clobber
 no_map
 no_echo</code></pre>
<p>Once the <code>run_dbconv.dat</code> file is correctly configured, <code>dbconv</code> can be executed at the command line by typing:</p>
<pre><code>dbconv.exe run_dbconv.dat</code></pre>
<p><strong>Notes:</strong></p>
<ul>
<li>
<code>run_dbconv.dat</code> can have any file name, however the correct file name must be invoked at run time.</li>
<li>The <code>run_dbconv.dat</code> can only be configured for one file at a time.</li>
</ul>
<p>For batch processing of several <code>.unf</code> files, it is recommended that a <code>run_dbconv.dat</code> file be created for each <code>.unf</code> to be converted and <code>dbconv.exe</code> be invoked for each <code>run_dbconv.dat</code> using a batch file.</p>
</div>
</div>
</div>
<div id="save-and-restart-output-files" class="section level2" number="4.11">
<h2>
<span class="header-section-number">4.11</span> Save and Restart output files<a class="anchor" aria-label="anchor" href="#save-and-restart-output-files"><i class="fas fa-link"></i></a>
</h2>
<p>Save and Restart output files are Fortran unformatted (binary) files that contain run configuration information used to allow the user to restart ELCOM runs from a certain point. As described in the <code>run_elcom.dat</code> section, the kernel name and output frequency of save and restart files are defined in the <code>run_elcom.dat</code> file.</p>
<p>The save files are created starting at the time step specified by the value assigned to the <code>run_elcom.dat</code> keyword <code>start_output_save</code>, and subsequently at intervals defined by <code>iter_out_save</code>. The file name of the save files begins with the user-specified kernel, given by <code>restart_save_file</code>, appended by a time stamp, and appended by <code>.unf</code>.</p>
<p>The restart files are created at intervals defined by <code>iter_out_restart</code>, starting from the first time step. Subsequent restart files overwrite existing restart files. The file name of the restart files begins with the user-specified kernel, given by <code>restart_out_file</code>, appended by <code>.unf</code>. All start and restart files are written in the outfiles directory specified in the <code>run_elcom.dat</code> file.</p>
<p>To restart an ELCOM simulation using a save or restart file, the user must place a copy of the desired save or restart file in the infiles directory as specified in the <code>run_elcom.dat</code> file. In the <code>run_elcom.dat</code> file the name of the desired save or restart file must be assigned to the <code>restart_infile</code> keyword, and keyword <code>irestart</code> must be assigned the value <code>1</code>.</p>
</div>
<div id="culvert-outputs---dynamic-boundary-conditions" class="section level2" number="4.12">
<h2>
<span class="header-section-number">4.12</span> Culvert Outputs - Dynamic Boundary Conditions<a class="anchor" aria-label="anchor" href="#culvert-outputs---dynamic-boundary-conditions"><i class="fas fa-link"></i></a>
</h2>
<p>In the current implementation, the flow rates and scalars calculated for each pipe in each of the pairs of dynamic boundary condition sets are output to an <code>ASCII</code> file located in the <code>outfile_txt_dir</code> directory.</p>
<p>The output files are named <code>culvert_bcset_[$set$].out</code>, where <code>$set$</code> is each of the dynamic boundary condition sets present in the simulation.</p>
<p>The format of the files is as follows. 16 header lines explain the format of the file.</p>
<pre><code> % number of pipes in set = n (repeats n times)
 % set ref 1 (repeats n times)
 % set ref 2 (repeats n times)
 % pipe heights 1 to n
 % pipe diameters 1 to n
 % number of scalars (repeats n times)
 % names of scalars (repeats n times)
 % Then, for each time step
 % time step (repeats n times)
 % height set upstream
 % height set downstream (repeats n times)
 % total flow (repeats n times)
 % shift in set (repeats n times)
 % regime pipe 1 to n
 % flow pipe 1 to n
 % each scalars flowing through the culverts (repeats n times)</code></pre>
<p>The percentage symbols at the beginning of each text line were used to make it easier to load the numeric data into a Matlab environment.</p>
<p>The next 7 lines give the set and pipe information.</p>
<ul>
<li>
<strong>First line</strong> gives the number of pipes (<code>n</code>) in the dynamic boundary condition output set. The information repeats <code>n</code> times for easier loading into Matlab.</li>
<li>
<strong>Second line</strong> gives the first defined set reference number in the dynamic boundary condition output set <code>ref 1</code>. The information repeats <code>n</code> times.</li>
<li>
<strong>Third line</strong> gives the second defined set reference number in the dynamic boundary condition output set <code>ref 2</code>. The information repeats <code>n</code> times.</li>
<li>
<strong>Fourth line</strong> gives the bottom height for each of the pipes in the boundary condition set.</li>
<li>
<strong>Fifth line</strong> gives the pipe diameter for each of the pipes in the dynamic boundary condition output set.</li>
<li>
<strong>Sixth line</strong> gives the number of transportable scalars used in the simulation. The information repeats <code>n</code> times.</li>
<li>
<strong>Seventh line</strong> gives the names of transportable scalars used in the simulation. The information repeats <code>n</code> times and the line is preceded by a percentage symbol.</li>
</ul>
<p>Then, for each time step in the simulation, <code>7 + number of scalars</code> lines are output.</p>
<ul>
<li>
<strong>First line</strong> gives the time step of the output <code>t</code>. The information repeats <code>n</code> times.</li>
</ul>
<pre><code> % flow pipe 1 to n
 % each scalar flowing through the culverts (repeats n times)</code></pre>
<ul>
<li>
<strong>Second line</strong> gives the water height in the upstream cell of the dynamic boundary condition set at time step <code>t</code>. Repeats <code>n</code> times.</li>
<li>
<strong>Third line</strong> gives the water height in the downstream cell of the dynamic boundary condition set at time step <code>t</code>. Repeats <code>n</code> times.</li>
<li>
<strong>Fourth line</strong> gives the sum of the flow in all the pipes in the dynamic boundary condition set at time step <code>t</code>. Repeats <code>n</code> times.</li>
<li>
<strong>Fifth line</strong> tells if there was a shift in the direction of the flow. A value <code>1</code> means there was a shift (flow is from cells defined in reference set <code>ref 2</code> to <code>ref 1</code>), and a value <code>0</code> means no shift. Repeats <code>n</code> times.</li>
<li>
<strong>Sixth line</strong> gives the flow regime in each of the pipes (see the science manual for a description of flow regimes).</li>
<li>
<strong>Seventh line</strong> gives the flow in each of the pipes.</li>
</ul>
<p>Then, <code>number of scalars</code> lines are output for each of the transportable scalars defined in the header.</p>
</div>
<div id="tab:validScalars" class="section level2" number="4.13">
<h2>
<span class="header-section-number">4.13</span> ELCOM Valid Scalars<a class="anchor" aria-label="anchor" href="#tab:validScalars"><i class="fas fa-link"></i></a>
</h2>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="19%">
<col width="10%">
<col width="70%">
</colgroup>
<thead><tr class="header">
<th>Scalar Keyword</th>
<th>Units</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>SALINITY</code></td>
<td>PSU</td>
<td>salinity (<em>practical salinity units which can be treated as parts per thousand within the numerical resolution of the model</em>)</td>
</tr>
<tr class="even">
<td><code>WTR_TEMP</code></td>
<td>degC</td>
<td>water temperature for inflowing water</td>
</tr>
<tr class="odd">
<td>
<code>TRACER_1</code> - <code>TRACER_10</code>
</td>
<td>concentration</td>
<td>tracer input</td>
</tr>
<tr class="even">
<td><code>&lt;CAEDYM&gt;</code></td>
<td>concentration</td>
<td>CAEDYM Scalars</td>
</tr>
</tbody>
</table></div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="pre.html"><span class="header-section-number">3</span> Pre-Processor</a></div>
<div class="next"><a href="notation.html"><span class="header-section-number">5</span> Notation</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#elcom"><span class="header-section-number">4</span> ELCOM Operartion</a></li>
<li><a class="nav-link" href="#introduction-5"><span class="header-section-number">4.1</span> Introduction</a></li>
<li><a class="nav-link" href="#files-for-elcom"><span class="header-section-number">4.2</span> Files for ELCOM</a></li>
<li>
<a class="nav-link" href="#simulation-modules"><span class="header-section-number">4.3</span> Simulation modules</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#stratification"><span class="header-section-number">4.3.1</span> Stratification</a></li>
<li><a class="nav-link" href="#tracers"><span class="header-section-number">4.3.2</span> Tracers</a></li>
<li><a class="nav-link" href="#surface-thermodynamics"><span class="header-section-number">4.3.3</span> Surface thermodynamics</a></li>
<li><a class="nav-link" href="#rain"><span class="header-section-number">4.3.4</span> Rain</a></li>
<li><a class="nav-link" href="#wind"><span class="header-section-number">4.3.5</span> Wind</a></li>
<li><a class="nav-link" href="#inflowoutflow"><span class="header-section-number">4.3.6</span> Inflow/Outflow</a></li>
<li><a class="nav-link" href="#conservation-of-background-potential-energy"><span class="header-section-number">4.3.7</span> Conservation of Background Potential Energy</a></li>
<li><a class="nav-link" href="#bubble-plume-destratification"><span class="header-section-number">4.3.8</span> Bubble Plume Destratification</a></li>
<li><a class="nav-link" href="#underflow"><span class="header-section-number">4.3.9</span> Underflow</a></li>
<li><a class="nav-link" href="#water-age-modelling"><span class="header-section-number">4.3.10</span> Water Age Modelling</a></li>
<li><a class="nav-link" href="#drifters-particles"><span class="header-section-number">4.3.11</span> Drifters / Particles</a></li>
<li><a class="nav-link" href="#jetspumps"><span class="header-section-number">4.3.12</span> Jets/Pumps</a></li>
<li><a class="nav-link" href="#drafttubes"><span class="header-section-number">4.3.13</span> Drafttubes</a></li>
<li><a class="nav-link" href="#non-hydrostatic-code"><span class="header-section-number">4.3.14</span> Non-hydrostatic code</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sect:initfiles"><span class="header-section-number">4.4</span> Initialization</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#uniform-initial-conditions"><span class="header-section-number">4.4.1</span> Uniform initial conditions</a></li>
<li><a class="nav-link" href="#vertical-profile"><span class="header-section-number">4.4.2</span> Vertical Profile</a></li>
<li><a class="nav-link" href="#sect:multiProf"><span class="header-section-number">4.4.3</span> Multiple Vertical Profiles</a></li>
<li><a class="nav-link" href="#horizontal-variation"><span class="header-section-number">4.4.4</span> Horizontal Variation</a></li>
<li><a class="nav-link" href="#user-subroutines"><span class="header-section-number">4.4.5</span> User subroutines</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#configuration-controls"><span class="header-section-number">4.5</span> Configuration controls</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#time-step"><span class="header-section-number">4.5.1</span> Time step</a></li>
<li><a class="nav-link" href="#number-of-steps"><span class="header-section-number">4.5.2</span> Number of steps</a></li>
<li><a class="nav-link" href="#start-date"><span class="header-section-number">4.5.3</span> Start date</a></li>
<li><a class="nav-link" href="#cgm-tolerance"><span class="header-section-number">4.5.4</span> CGM tolerance</a></li>
<li><a class="nav-link" href="#turbulence"><span class="header-section-number">4.5.5</span> Turbulence</a></li>
</ul>
</li>
<li><a class="nav-link" href="#output-frequency"><span class="header-section-number">4.6</span> Output frequency</a></li>
<li>
<a class="nav-link" href="#sect:runelcom.dat"><span class="header-section-number">4.7</span> Configuration using file run_elcom.dat</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#file-headers"><span class="header-section-number">4.7.1</span> File headers</a></li>
<li><a class="nav-link" href="#simulation-module-controls"><span class="header-section-number">4.7.2</span> Simulation module controls</a></li>
<li><a class="nav-link" href="#initialization-and-update-options"><span class="header-section-number">4.7.3</span> Initialization and update options</a></li>
<li><a class="nav-link" href="#turbulence-modeling"><span class="header-section-number">4.7.4</span> Turbulence modeling</a></li>
<li><a class="nav-link" href="#meteorological-sensor-heights"><span class="header-section-number">4.7.5</span> Meteorological Sensor Heights</a></li>
<li><a class="nav-link" href="#model-settings-and-controls"><span class="header-section-number">4.7.6</span> Model Settings and Controls</a></li>
<li><a class="nav-link" href="#scalar-maximum-and-minimum-for-debugging"><span class="header-section-number">4.7.7</span> Scalar Maximum and Minimum for Debugging</a></li>
<li><a class="nav-link" href="#debugging-controls"><span class="header-section-number">4.7.8</span> Debugging controls</a></li>
<li><a class="nav-link" href="#output-frequency-1"><span class="header-section-number">4.7.9</span> Output Frequency</a></li>
<li><a class="nav-link" href="#output-start-time"><span class="header-section-number">4.7.10</span> Output Start Time</a></li>
<li><a class="nav-link" href="#time-controls"><span class="header-section-number">4.7.11</span> Time Controls</a></li>
<li><a class="nav-link" href="#iterative-solver-controls"><span class="header-section-number">4.7.12</span> Iterative Solver Controls</a></li>
<li><a class="nav-link" href="#scalar-filtering"><span class="header-section-number">4.7.13</span> Scalar Filtering</a></li>
<li><a class="nav-link" href="#default-values"><span class="header-section-number">4.7.14</span> Default Values</a></li>
<li><a class="nav-link" href="#input-file-names"><span class="header-section-number">4.7.15</span> Input File Names</a></li>
<li><a class="nav-link" href="#file-directories"><span class="header-section-number">4.7.16</span> File Directories</a></li>
<li><a class="nav-link" href="#output-file-names"><span class="header-section-number">4.7.17</span> Output File Names</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#input-files"><span class="header-section-number">4.8</span> Input files</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#sparsedata.unf-and-usedata.unf"><span class="header-section-number">4.8.1</span> sparsedata.unf and usedata.unf</a></li>
<li><a class="nav-link" href="#sect:tempBCfiles"><span class="header-section-number">4.8.2</span> Temporal boundary condition (1D) files</a></li>
<li><a class="nav-link" href="#temporal-profile-boundary-condition-2d-files"><span class="header-section-number">4.8.3</span> Temporal profile boundary condition (2D) files</a></li>
<li><a class="nav-link" href="#sect:updateBCfiles"><span class="header-section-number">4.8.4</span> Update boundary condition files</a></li>
<li><a class="nav-link" href="#sect:tempFiltFiles"><span class="header-section-number">4.8.5</span> Temporal filter constant files</a></li>
<li><a class="nav-link" href="#drifter-files"><span class="header-section-number">4.8.6</span> Drifter files</a></li>
<li><a class="nav-link" href="#drifter-initial-files"><span class="header-section-number">4.8.7</span> Drifter Initial Files</a></li>
<li><a class="nav-link" href="#valid-keywords"><span class="header-section-number">4.8.8</span> Valid keywords:</a></li>
<li><a class="nav-link" href="#drifter-update-files"><span class="header-section-number">4.8.9</span> Drifter Update Files</a></li>
<li><a class="nav-link" href="#valid-keywords-for-updates"><span class="header-section-number">4.8.10</span> Valid keywords for updates:</a></li>
<li><a class="nav-link" href="#jet-files"><span class="header-section-number">4.8.11</span> Jet Files</a></li>
<li><a class="nav-link" href="#drafttube-files"><span class="header-section-number">4.8.12</span> Drafttube Files</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#definition-of-culvert-characteristics-dynamic-boundary-conditions"><span class="header-section-number">4.9</span> Definition of Culvert Characteristics – Dynamic Boundary Conditions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#supported-culvert-keywords-and-defaults"><span class="header-section-number">4.9.1</span> Supported Culvert Keywords and Defaults</a></li>
<li><a class="nav-link" href="#example-file"><span class="header-section-number">4.9.2</span> Example File</a></li>
<li><a class="nav-link" href="#sect:datablock"><span class="header-section-number">4.9.3</span> Output definition file (Datablock.db)</a></li>
<li><a class="nav-link" href="#group-time-list"><span class="header-section-number">4.9.4</span> 5 Group Time List</a></li>
<li><a class="nav-link" href="#set-cell-data"><span class="header-section-number">4.9.5</span> 6 Set Cell Data</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sect:runexe"><span class="header-section-number">4.10</span> Running ELCOM</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#sect:postproc"><span class="header-section-number">4.10.1</span> Post-Processing</a></li></ul>
</li>
<li><a class="nav-link" href="#save-and-restart-output-files"><span class="header-section-number">4.11</span> Save and Restart output files</a></li>
<li><a class="nav-link" href="#culvert-outputs---dynamic-boundary-conditions"><span class="header-section-number">4.12</span> Culvert Outputs - Dynamic Boundary Conditions</a></li>
<li><a class="nav-link" href="#tab:validScalars"><span class="header-section-number">4.13</span> ELCOM Valid Scalars</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>ELCOM manual</strong>" was written by . It was last built on 2025-05-26.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
