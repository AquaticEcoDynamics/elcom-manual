[{"path":"index.html","id":"welcome","chapter":"Section 1 Welcome","heading":"Section 1 Welcome","text":"draft ELCOM manual. written R Markdown published bookdown book.ELCOM manual work progress. written ELCOM development team intended comprehensive guide using ELCOM hydrodynamic thermodynamic modeling stratified water bodies.\nmanual cover following topics:\n- Introduction ELCOM\n- Setting ELCOM simulation\n- Running ELCOM simulation\n- Post-processing ELCOM simulation results","code":""},{"path":"intro.html","id":"intro","chapter":"Section 2 Introduction","heading":"Section 2 Introduction","text":"","code":""},{"path":"intro.html","id":"the-elcom-model","chapter":"Section 2 Introduction","heading":"2.1 The ELCOM model","text":"ELCOM (Estuary Lake Computer Model) numerical modeling tool applies hydrodynamic thermodynamic models simulate temporal behavior stratified water bodies environmental forcing.hydrodynamic simulation method solves unsteady, viscous Navier-Stokes equations incompressible flow using hydrostatic assumption pressure. Modeled simulated processes include baroclinic barotropic responses, rotational effects, tidal forcing, wind stresses, surface thermal forcing, inflows, outflows, transport salt, heat passive scalars.coupling CAEDYM (Computational Aquatic Ecosystem DYnamics Model) water quality module, ELCOM can used simulate three-dimensional transport interactions flow physics, biology chemistry.hydrodynamic algorithms ELCOM based Euler-Lagrange method advection momentum conjugate-gradient solution free-surface height (Casulli Cheng, 1992). Passive active scalars (.e., tracers, salinity temperature) advected using conservative ULTIMATE QUICKEST discretization (Leonard 1991).","code":""},{"path":"intro.html","id":"implementation-language","chapter":"Section 2 Introduction","heading":"2.2 Implementation language","text":"ELCOM implemented Fortran 90 (F95 extensions) three-dimensional space can mapped single vector fast operation using array-processing techniques.computational cells contain water represented single vector memory usage minimized. allows Fortran 90 compiler parallelization vectorization without platform-specific modification code. future extension ELCOM include dynamic pressure effects account nonlinear dynamics internal waves may lost due hydrostatic approximation.","code":""},{"path":"intro.html","id":"outline-of-a-simulation-run","chapter":"Section 2 Introduction","heading":"2.3 Outline of a simulation run","text":"Setting running ELCOM simulation requires following steps:Prepare bathymetry.dat file provides topography grid information (see [Section ??]),Prepare bc.dat file designates sets cells applying boundary conditions (see [Section 3.3]),Prepare levee.dat file designates sets cells levee boundary conditions (see [Section ??]),Prepare update.dat file designates sets cells update boundary conditions (see [Section ??]),Run pre-processor produce sparsedata.unf usedata.unf files,Configure simulation run_elcom file (see [Section @ref(sect:runelcom.dat)]),Specify output datablock file (*.db) designating data output operations (see [Section 4.9.3]),Prepare temporal boundary condition files (*.dat) data applied boundary condition cells (see [Section 4.8.2]),Prepare initial conditions files (see [Section 4.4]),Run executable, directing screen output file (see [Section 4.10]),Post-process data (see [Section 4.10.1]).","code":""},{"path":"intro.html","id":"conventions-and-definitions","chapter":"Section 2 Introduction","heading":"2.4 Conventions and definitions","text":"document, number conventions used. clarity, computational domain generally referred “lake”. However, simulation method designed applicability estuaries coastal ocean environments.","code":""},{"path":"pre.html","id":"pre","chapter":"Section 3 Pre-Processor","heading":"Section 3 Pre-Processor","text":"","code":""},{"path":"pre.html","id":"introduction","chapter":"Section 3 Pre-Processor","heading":"3.1 Introduction","text":"ELCOM pre-processor used convert user’s three-dimensional data lake bathymetry, boundary forcing sections, grid structure one-dimensional vectors used ELCOM. Configuration running pre-processor comes run_pre.dat file. run_pre.dat file text file contains names locations user-supplied input files pre-processor output files. pre-processor requires two three user-supplied text files: bathymetry.dat, bc.dat optionally levee.dat update.dat.bathymetry.dat describes bathymetry lake grid configuration.bc.dat defines sets boundary cells.levee.dat allows specification levee cells — solid walls two adjacent ELCOM cells.update.dat allows specification update cells — modify values various scalars arbitrarily.pre-processor outputs two Fortran unformatted (binary) files: sparsedata.unf usedata.unf. may renamed, user must track sparsedata usedata.","code":""},{"path":"pre.html","id":"sect-bathFile","chapter":"Section 3 Pre-Processor","heading":"3.2 Setting up the bathymetry file (bathymetry.dat)","text":"ELCOM uses Fortran 90 (F95 extensions) map 3D space single vector fast operation. computational cells containing water represented vector, minimizing memory usage. enables parallelization/vectorization without platform-specific modifications. Future ELCOM versions may include dynamic pressure effects handle nonlinear internal wave dynamics.","code":""},{"path":"pre.html","id":"introduction-1","chapter":"Section 3 Pre-Processor","heading":"3.2.1 Introduction","text":"bathymetry file allows user input simulation domain geometry target resolution1.format strict respect data amount order. items must present. Comment lines can added bathymetry values, line containing least two items. item may integer, real number, character string. Comments must begin exclamation point (!) include least two items. common crash involves Fortran error due missing non-optional items insufficient items per line.valid formats:keyword data\ndata keyword\n! comment\nkeyword keyword\ndata(j=1 y_columns)keywords ELCOM-defined words indicate type user-provided data presented:\n(1) keyword,\n(2) keyword, \n(3) succeeding lines file.Additional comments may provided keywords help user remember keyword purpose (code reads first two items line). Detailed information keywords format file presented following sections.","code":""},{"path":"pre.html","id":"physical-and-computational-space-coordinates","chapter":"Section 3 Pre-Processor","heading":"3.2.2 Physical and computational space coordinates","text":"literature, bathymetry generally presented vertical distance horizontal baseline (often mean water height) may either positive downward positive upward. convention used ELCOM \\((x,y,z)\\) space follows right-hand rule \\(z\\) positive upward direction (Figure ??).user free choose suitable \\(z=0\\) baseline bathymetry long positive \\(z\\) upward maintained convention measurement. pre-processor adjust user-defined \\(z=0\\) baseline internal code baseline suitable ELCOM simulation.part, user need know consider internal baseline adjustment. However, debugging monitoring output presented terms code coordinate system rather user coordinate system, care must taken interpreting debugging output intended use code developers.position physical space origin \\((x=0, y=0)\\) set implicitly user layout bathymetry data file bathymetry.dat. covered detail . Physical space \\(x\\) \\(y\\) values may negative (.e., \\(x,y\\) origin must corner domain).\n(#fig:fig.coords)Schematic coordinate system\nELCOM performs simulation computational cells three-dimensional Cartesian mesh. user needs understand layout mesh boundary condition cells can properly identified. ELCOM allows non-uniform spacing horizontal dimensions (\\(x\\) \\(y\\)) allows non-uniform spacing vertical (\\(z\\)) direction. (Although non-uniform \\(x\\) \\(y\\) grid spacings now allowed, users must aware timestep limitations set smallest grid size.)Figure ?? shows plan view (\\(x\\)-\\(y\\) plane) lake discrete (uniform) Cartesian mesh overlay. computational domain divided “cells” whose centers represented Figure ?? solid dots. Dashed lines represent faces cells. cell center \\((,j,k)\\) coordinate designates location discrete computational space. \\(,j,k\\) values integer indices three-dimensional array.right-hand rule used, \\((,j,k)\\) non-zero, positive integer values; \\(k = 1\\) associated lowermost cell layer domain. \\((,j)\\) pairs horizontal plane represent matrix, conventional mathematical notation \\((1,1)\\) position always upper left corner. \\(\\) index row index increases page. \\(j\\) index column index increases across page. \\((,j)\\) indices corner cells shown Figure ??.convenience consistency, origin \\((0,0)\\) \\(x,y\\) (physical space) coordinates taken \\((1,1)\\) location computational space \\(,j\\) indices.\n(#fig:fig.pmesh)Plan view Cartesian mesh\nUsing upper left corner origin may initially confusing users familiar mirror-image storage (used many graphics programs) lower left corner stored position \\(=1,j=1\\). problem mirror-image storage simple printout bathymetry data always appears upside-mirror image real world viewed text processor spreadsheet.present convention gives user See Get view bathymetry simply opening file word processor importing spreadsheet. convention found intuitive users graphics experts. However, caution needs taken converting raw bathymetry data graphics programs use mirror-image standard. Likewise, direction positive \\(u\\) (\\(x\\) direction) velocity confusing, positive page.Figure ?? shows physical space outline lake border shaded area. discrete outline lake shown heavy solid line. developing bathymetry.dat file ELCOM simulation, user required provide bathymetry values (.e., vertical distance measured user’s \\(z=0\\) baseline) cells within discrete boundary lake. region outside lake boundary defined “land” region.Figure ??, cell center dots replaced numbers represent distance user’s \\(z=0\\) baseline bottom lake. case, “land” regions given value 99. Note boundary bathymetry data set shown Figure ?? land values around entire boundary.general, required either land cell open boundary cell surrounds bathymetry data. purposes bathymetry.dat file, user must provide bathymetry values cells rectangular array, including cells contain land. ELCOM reserve computational memory :cells may contain water, andThe first layer land cells surrounding water cells.\n(#fig:fig.pbath)Plan view bathymetry data\nFigure ?? shows elevation view (\\(x\\text{-}z\\) plane) lake Cartesian overlay. continuous, physical-space lake bottom shown dashed line, resulting discrete lake bottom shown solid line.ELCOM computes bathymetry face cell (dashed lines) user-supplied bathymetry data cell centers (solid dots). figure, user \\(z=0\\) baseline chosen top domain, bathymetry values negative. Note \\(k=1\\) index \\(,j,k\\) space corresponds lowermost layer, regardless user z=0 baseline position.\n(#fig:fig.emesh)Elevation view bathymetry data\n--date copy bathymetry.dat included examples. file can used template creating bathymetry.dat file. judicious use extra comment lines comments keywords leads file much readable. bathymetry.dat file can renamed, corresponding name run_pre.dat must also changed.remainder section detail use keyword bathymetry.dat file.","code":""},{"path":"pre.html","id":"file-header","chapter":"Section 3 Pre-Processor","heading":"3.2.3 File header","text":"keyword = FILEThe first non-comment line bathymetry.dat file must begin keyword FILE. Thus, first non-comment line must appear shown: ","code":""},{"path":"pre.html","id":"description-lines","chapter":"Section 3 Pre-Processor","heading":"3.2.3.1 Description lines","text":"keywords = TITLE, ANALYST, ORGANIZATION, COMMENTSeveral keywords provided allow user put identifying information top bathymetry file. information printed standard output start run provide identification debugging output data. format header lines 'string'; keyword, string must non-null character array enclosed single quotation marks. string left blank enclosed quotes, pre-processor crash Fortran read error. user must one COMMENT line. typical set header keywords shown . ","code":""},{"path":"pre.html","id":"size-of-input-bathymetry-data","chapter":"Section 3 Pre-Processor","heading":"3.2.4 Size of input bathymetry data","text":"keywords = x_rows, y_columns, z_layers, n_max, n_maxBCIn order correctly read bathymetry data file bathymetry.dat, user must tell pre-processor size grid expect. value x_rows number rows two dimensional plan view bathymetry. y_columns number columns two-dimensional plan view. number layers vertical direction identified keyword z_layers. keyword n_max used set estimate number grid cells domain required simulation (.e. interior points plus land points one layer surrounding interior). simulations, n_max can set 0, code start estimate x_rows × y_columns × z_layers. However, cases, may create temporary data array larger can processed using available memory pre-processor crash. crash may produce machine error message stating “memory,” enigmatic “segmentation fault”. insufficient memory available, user can estimate actual number grid points required simulation rerun preprocessor. reduction amount memory used can achieved using keyword n_maxBC. n_maxBC sets maximum number cells one boundary condition set. n_maxBC specified set 0 calculated n_max value used.","code":""},{"path":"pre.html","id":"land-cells","chapter":"Section 3 Pre-Processor","heading":"3.2.5 Land cells","text":"keyword = land_valueThe land region designated unique bathymetry value (defined using keyword land_value) greater value found within lake. user free choose land_value convenient number meets criterion. Thus, user chooses z=0 baseline top domain, land_value may set zero (bathymetry values negative numbers). user chooses bottom domain z=0 baseline, land_value may positive number greater largest number appearing within lake boundary (usually convenient use 9999). latter case, bathymetry values positive numbers. Note cell whose bathymetry equal land_value considered cell within domain; thus typographical errors can produce spurious interior cells domain. user required z=0 baseline within domain: may convenient use external reference sea level. may result lowest point domain positive non-zero bathymetry value.","code":""},{"path":"pre.html","id":"open-boundary-cells","chapter":"Section 3 Pre-Processor","heading":"3.2.6 Open boundary cells","text":"keyword = open_valueOpen boundary cells boundaries tidal forcing adjacent body water simulation domain. user-defined bathymetry value indicates open boundary cell defined keyword open_value.","code":""},{"path":"pre.html","id":"north-vector","chapter":"Section 3 Pre-Processor","heading":"3.2.7 North vector","text":"keywords = north_x, north_yThe user may create bathymetry data file orientation (.e., requirement north top page). Since wind forcing free surface requires direction, user must designate north direction. north vector determined shown Figure \\(\\ref{fig:north}\\). Note north vector given terms vector physical (\\(x,y,z\\)) space, discrete (\\(,j,k\\)) space. origin upper left corner, standard “north ” data set north vector (-1, 0).","code":""},{"path":"pre.html","id":"geographic-position","chapter":"Section 3 Pre-Processor","heading":"3.2.8 Geographic position","text":"keywords = latitude, longitude, altitudeThe user provides geographic position simulation domain using keywords latitude, longitude altitude. Longitude altitude effect simulation longitude used geo-reference output data. latitude used provide appropriate Coriolis forcing ELCOM simulation. North latitudes entered positive numbers south latitudes entered negative numbers. Latitude longitude refer top,left corner bathymetry file.","code":""},{"path":"pre.html","id":"horizontal-grid-spacing","chapter":"Section 3 Pre-Processor","heading":"3.2.9 Horizontal grid spacing","text":"keywords = x_grid, y_gridThe present version ELCOM allows uniform stretched grid spacing \\(x\\) \\(y\\) direction. Separate grid spacings implemented horizontal dimension \\(dx \\neq dy\\) valid. However, user careful implementing solution grid different \\(dx\\) \\(dy\\) grid spacings since can affect solution accuracy. uniform grids \\(x\\) \\(y\\) grid spacings designated keywords x_grid y_grid. non-uniform (stretched) horizontal grid used, default value x_grid y_grid must still defined.","code":""},{"path":"pre.html","id":"non-uniform-horizontal-grid-spacing","chapter":"Section 3 Pre-Processor","heading":"3.2.10 Non uniform horizontal grid spacing","text":"keywords = dx, dy (optional)horizontal direction, ELCOM version 2.0.0 allows user design grid whose dimension varies space (.e. \\(dx = f[x]\\) \\(dy = f[y]\\)). Note \\(dx\\) may vary \\(y\\) \\(z\\) coordinates \\(dy\\) may vary \\(x\\) \\(z\\) coordinates. bathymetry.dat file, stretched horizontal grid spacings designated keywords dx dy. dx dy defined bathymetry.dat order increasing coordinate (.e. \\(x=1\\) \\(x = x\\_rows\\)).user free set \\(dx\\) \\(dy\\) values arbitrary manner, accuracy stability simulation method may affected degree non-uniformity grid. general, simulation method perform best (.e. greatest accuracy) using uniform grid. non-uniform grids, degradation accuracy function rate grid changes (see \\(dz\\)).","code":""},{"path":"pre.html","id":"layer-thickness","chapter":"Section 3 Pre-Processor","heading":"3.2.11 Layer thickness","text":"keyword = dzIn vertical direction, ELCOM allows user design structure horizontal layers whose thickness varies depth (.e. \\(dz = f[z]\\)). Note layer thickness may vary \\(x\\) \\(y\\) coordinates. bathymetry.dat file, successive layer thicknesses (descending order top domain) designated keyword dz. user free set \\(dz\\) values arbitrary manner, accuracy stability simulation method may affected degree non-uniformity layers. general, simulation method perform best (.e. greatest accuracy) using grid uniform \\(dz\\). non-uniform \\(dz\\), degradation accuracy function rate \\(dz\\) changes. Thus, grid \\(dz\\) varies slowly perform well, grid abrupt changes grid size less accurate. example, Figure \\(\\ref{fig:vgrid}\\) shows two possible configurations provide vertical resolution 0.5 metres upper portion lake 2.0 metre resolution lower portion. use number grid cells, \\(dz\\) distribution left Figure \\(\\ref{fig:vgrid}\\) show better performance.Figure \\(\\ref{fig:vgrid}\\): Vertical grid spacings","code":""},{"path":"pre.html","id":"bathymetry-values","chapter":"Section 3 Pre-Processor","heading":"3.2.12 Bathymetry values","text":"keywords = BATHYMETRY DATAThe bathymetry values must presented file bathymetry.dat following line two keywords BATHYMETRY DATA. line bathymetry values must contain exactly y_columns data must exactly x_rows data lines following BATHYMETRY DATA. value line may separated next one spaces tabs.Thus, domain x_rows = 8 y_columns = 13, land_value = 99 (.e., similar Figure ??), bathymetry values entered bathymetry.dat file shown:BATHYMETRY DATA","code":"99  99  99   99   99   99   99   99   99   99   99   99   99\n99  99  -0.7 -0.5 99   99   99   99   99   99   99   99   99\n99  -0.4 -1.2 -1.3 -1.1 -1.4 -2.5 -2.7 -3.3 -0.7 99   99   99\n99  -1.1 -1.6 -2.2 -3.2 -3.8 -3.9 -4.1 -5.3 -5.7 -5.2 -2.4 99\n99  -0.5 -0.8 -1.2 -2.1 -2.2 -2.4 -3.2 -3.3 -4.1 -5.0 -1.8 99\n99  99  99   99   99   99   99   99   99   -1.7 -1.2 -0.7 99\n99  99  99   99   99   99   99   99   99   -0.7 -0.9 -0.3 99\n99  99  99   99   99   99   99   99   99   99   99   99   99"},{"path":"pre.html","id":"bottom-drag-values-optional","chapter":"Section 3 Pre-Processor","heading":"3.2.13 Bottom drag values (optional)","text":"Keywords: BTM_CD DATAVersion 2.0.0 allows variable bottom drag coefficient specified bathymetry.dat file. line values must contain exactly y_columns data must exactly x_rows data lines following BTM_CD DATA. value line may separated next one spaces.Thus, domain x_rows = 8 y_columns = 13, values entered bathymetry.dat file shown:","code":"BTM_CD DATA\n8 13 1e+16\n1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16\n1e+16 1e+16 0.002 0.002 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16\n1e+16 0.002 0.002 0.002 0.002 0.002 0.002 0.002 0.002 0.002 1e+16 1e+16 1e+16\n1e+16 0.003 0.003 0.003 0.003 0.003 0.003 0.003 0.003 0.003 0.003 0.003 1e+16\n1e+16 0.004 0.004 0.004 0.004 0.004 0.004 0.004 0.004 0.004 0.004 0.004 1e+16\n1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 0.004 0.004 0.004 1e+16\n1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 0.004 0.004 0.004 1e+16\n1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16"},{"path":"pre.html","id":"bottom-slope-values-optional","chapter":"Section 3 Pre-Processor","heading":"3.2.14 Bottom Slope Values (Optional)","text":"Keywords: SLOPE_X DATA, SLOPE_Y DATATo enable 2D underflow model, bottom slope values must included bathymetry.dat file. values follow line containing either keywords SLOPE_X DATA SLOPE_Y DATA.line slope values must contain exactly y_columns entries, must exactly x_rows lines data following keyword. Values line can separated one spaces tabs.instance, domain defined x_rows = 8 y_columns = 13 (shown earlier), slope values appear bathymetry.dat file follows:","code":""},{"path":"pre.html","id":"example-slope_x-data-format","chapter":"Section 3 Pre-Processor","heading":"Example SLOPE_X DATA Format","text":"","code":"SLOPE_X DATA\n8 13 1e+16\n\n1e+16  1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16\n1e+16  1e+16 -0.006 -0.008 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16\n1e+16 -0.007 -0.004 -0.008 -0.021 -0.024 -0.019 -0.020 -0.026 -0.05 1e+16 1e+16 1e+16\n1e+16 -0.000 0.002 0.000 -0.005 -0.004 0.000 -0.002 0.000 -0.017 -0.025 -0.009 1e+16\n1e+16  0.005 0.008 0.011 0.016 0.019 0.0195 0.020 0.026 0.02 0.02 0.008 1e+16\n1e+16  1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 0.017 0.020 0.007 1e+16\n1e+16  1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 0.008 0.006 0.003 1e+16\n1e+16  1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16"},{"path":"pre.html","id":"example-slope_y-data-format","chapter":"Section 3 Pre-Processor","heading":"Example SLOPE_Y DATA Format","text":"","code":"SLOPE_Y DATA\n8 13 1e+16\n\n1e+16  1e+16  1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16\n1e+16  1e+16 -0.002   0.003   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16\n1e+16 -0.008 -0.004   0.000  -0.000  -0.007  -0.006  -0.004   0.01    0.016   1e+16   1e+16   1e+16\n1e+16 -0.008 -0.005  -0.008  -0.008  -0.003  -0.001  -0.007  -0.008   0.000   0.016   0.026   1e+16\n1e+16  1e+16  1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   0.017   0.005   0.006   1e+16\n1e+16  1e+16  1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16  -0.004   0.002   0.004   1e+16\n1e+16  1e+16  1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16   1e+16"},{"path":"pre.html","id":"sect:bcFile","chapter":"Section 3 Pre-Processor","heading":"3.3 Setting up the boundary cell set file (bc.dat)","text":"--date copy bc.dat included examples.","code":""},{"path":"pre.html","id":"introduction-2","chapter":"Section 3 Pre-Processor","heading":"3.4 Introduction","text":"boundary cell set file designates logical grouping grid cells boundary conditions enforced ELCOM. One set points may river inflow, another set may dam offtake, another set may represent groundwater inflows, etc. set boundary points defined unique reference number (used also ELCOM temporal boundary condition files), type (one several keywords), title (user reference ), series cell , j, k coordinates. file gives user complete flexibility assignment diverse complex boundary conditions around three-dimensional topography.","code":""},{"path":"pre.html","id":"boundary-cell-set-categories","chapter":"Section 3 Pre-Processor","heading":"3.5 Boundary cell set categories","text":"keywords boundary cell sets fall seven categories, defined follows:boundary cell set consists collection cell faces boundaries interior cell land cells. land boundary condition default faces cells identified land_value bathymetry.dat file boundary cell faces bathymetry data. , user rarely need use land boundary condition bc.dat file. lake without inflows, outflows special boundary conditions, bc.dat file need present.","code":""},{"path":"pre.html","id":"boundary-cell-set-face-direction","chapter":"Section 3 Pre-Processor","heading":"3.6 Boundary cell set face direction","text":"cell faces boundaries identified (, j, k) coordinates interior cell direction cell center boundary. conventions used follows:","code":""},{"path":"pre.html","id":"boundary-cell-set-keywords","chapter":"Section 3 Pre-Processor","heading":"3.7 Boundary cell set keywords","text":"keywords used identify boundary cell sets concatenation categories face direction. valid keywords listed :NOTE: bubbler_zbot bubbler_kbot allow user specify height bubble plume diffuser either height metres (zbot) number cells bottom.","code":""},{"path":"pre.html","id":"sect:bc.dat","chapter":"Section 3 Pre-Processor","heading":"3.8 Organization of the boundary cell set file (bc.dat)","text":"top boundary cell set file (bc.dat), user may put number comment lines. comment line must start exclamation point (!) least 3 items line (.e., two words numbers separated exclamation point spaces tabs). initial comments, boundary cell set file consists series definitions boundary sets. set consists set identification line followed one lines cell definitions. line must three items pre-processor crash Fortran file read error. Blank lines allowed boundary cell set file.set identification line form:integer  keyword  titleThe first item, integer, reference number boundary cell set used preparing temporal boundary condition data files ELCOM simulation run (see section \\(\\ref{sect:tempBCfiles}\\)). boundary cell set must unique integer reference number. keyword one valid keywords listed Table \\(\\ref{tab:keywords}\\). title user-designated name boundary condition set. title may one word, although first word used code.set identification line, one lines cell definitions. cell definition consists three sets numbers general form:\ni_{start}:i_{end}  j_{start}:j_{end}  k_{start}:k_{end}.\nboundary condition types except bubbler_zbot bubbler_kbot , j, k integer values cell positions space rectangular box cells relevant boundary cell keyword applied. bubbler_zbot third column must single real gives height diffuser metres lake bottom. bubbler_kbot third column must single integer gives number cells diffuser lake bottom. example simple boundary cell set definition might beThe preprocessor designate single set, positive x boundaries range \\(3 \\leq \\leq 10\\) \\(4 \\leq j \\leq 5\\) \\(10 \\leq k \\leq 14\\). boundary cell set may multiple lines cell definitions:Note number pair cell definition must increasing order.two simpler cases implementing boundary cell sets (1) \\(, j\\) \\(k\\) single value rather range, (2) possible values \\(, j\\) \\(k\\) included. former case, single number needs provided (rather pair), latter case, colon (:) needs listed. example, cell set inflow boundary along flat side \\(j = 2\\) might written :enforces free-slip boundary condition boundary faces (sides bottom) domain.error cross-checking within pre-processor cell faces defined belonging one boundary cell set. cases, multiple definitions may desirable. example, one might define river inflow covers entire depth river purposes velocity boundary condition; define separate section bottom river used place tracer. bc.dat file might containIn cases, multiple set definitions particular face can produce unintended results. example, define inflow boundary global definition free-slip boundaries cells:find cells (3:15, 2, : ) get defined imposed velocity (Dirichlet) boundary conditions free-slip (normal-Dirichlet, tangential-Neumann) boundary conditions. Obviously inconsistent flow simulation enforce boundary conditions. Checking combinations multiple definitions consistent error capturing routine yet implemented. Thus, boundary cell sets processed provided ELCOM. Within ELCOM, one two boundary conditions actually enforced, one tell boundary condition without detailed examination source code. Note order items defined may affect operation inconsistent definition. Thus inconsistent definition reversed written :results ELCOM may different previous implementation — wrong different manner. general rule, user provide multiple definitions velocity boundary conditions single cell face. land, flow slip keywords affect type velocity boundary condition; incumbent user sure cell faces defined types multiple definitions.following table illustrates bc.dat file subtle uses boundary cell set definitions. flow boundary declared x-minus faces cells \\(=2\\). Thus, get free-slip boundary conditions faces, use keyword slip_all cells \\(>2\\). get free slip y-minus y-plus faces \\(=2\\) requires two definitions (inconsistent flow_xm definition since different faces cell). file also shows use section_top segregate free surface different sets onto different wind data can enforced.","code":"  107  flow_xp  river_inflow\n   3:10  4:5  10:14  13  flow_bottom  groundwater_inflow\n    5:10   1:5    10:14\n    5:10   7:11   10:14\n    3:8   12:17   1:5  214  slip_all  freeslip_domain\n    :  :  :  2791  flow_ym     river_inflow\n    3:15    2    :\n  73    section_ym  tracer_inflow\n    3:15    2    1:52791    flow_ym river_inflow\n    3:15    2   :\n214 slip_all    freeslip_domain\n    :   :   :214 slip_all    freeslip_domain\n    :   :   :\n2791    flow_ym river_inflow\n    3:15    2   :! - - - -\n! - bc.dat file\n! - comment lines need three items\n34  flow_xm   outflow_number_1\n    2       :       :\n75  section_top  wind_region_a\n    :       1:10    :\n118 section_top  wind_region_b\n    :       11:21   :\n25  slip_all_sides  free_slip_section\n    3:34    :       :\n26  slip_ym free_slip_near_inflow_1\n    2:      :       :\n27  slip_yp free_slip_near_inflow_2\n    2:      :       :"},{"path":"pre.html","id":"flow_multi_sides","chapter":"Section 3 Pre-Processor","heading":"3.9 flow_multi_sides","text":"ELCOM version 2.1.1 bc set type introduced (flow_multi_sides) allows user specify one inflow enters multiple cells multiple faces. primarily introduced allow meandering river channel specified one boundary set particularly useful coupled INFLOW_DEPTH boundary condition data. format flow_multi_sides boundary cell set file (bc.dat) slightly different set types.flow_multi_sides set consists set identification line followed one subsets cell face type definitions. line must three items pre-processor crash Fortran file read error. Blank lines allowed boundary cell set file.flow_multi_sides set identification line set types, .e.:reference number keyword titleWhere keyword must flow_multi_sides. set identification line, one subset definitions. subset consists subset set identification line followed one lines cell definitions.subset identification line form: reference number flow_multi_sides keyword.\nsubset reference number subset must reference number set identification line.\nkeyword. must one flow_xp, flow_xm, flow_yp, flow_y defines inflow face subset cells.Following subset identification line one lines cell definitions.\ncell definitions ordinary set type—.e., general form$i_{start}:i_{end} j_{start}:j_{end} k_{start}:k_{end}$.example flow_multi_sides boundary cell set definition might :","code":"  111 flow_multi_sides    river_inflow\n  111 flow_multi_sides    flow_xm\n      2   3   10\n      3   3   9\n      4   3   8\n  111 flow_multi_sides    flow_ym\n      4   3   8\n      4   4   7\n      4   5   6\n  111 flow_multi_sides    flow_xm\n      4   5   6\n      5   5   5\n      6   5   4"},{"path":"pre.html","id":"flow_dynamic","chapter":"Section 3 Pre-Processor","heading":"3.10 flow_dynamic","text":"Dynamic boundary condition sets (flow*_dynamic) allow user specify connection two parts domain (horizontal) culvert. functionality recently introduced ELCOM. boundary condition set pair related ends culvert must defined.definition dynamic boundary condition pair set comprises four lines. first third lines structure boundary condition identification line: set reference number, one keywords (flow_xm_dynamic, flow_xp_dynamic, flow_ym_dynamic, flow_yp_dynamic), user identifier. lines refers one end culvert.second fourth lines follow structure cell definition lines ordinary set type. line refers one end culvert. one one j value can specified. Although multiple k values may included, ends must k specification.example flow*_dynamic boundary cell set definition might :","code":"500     flow_xp_dynamic pipe_east_end\n        2   3   10\n600     flow_ym_dynamic pipe_north_end\n        4   3   10"},{"path":"pre.html","id":"sect-leveeFile","chapter":"Section 3 Pre-Processor","heading":"3.11 Setting up the levee file (levee.dat) (Optional)","text":"","code":""},{"path":"pre.html","id":"introduction-3","chapter":"Section 3 Pre-Processor","heading":"3.11.1 Introduction","text":"levee set file designates levees domain. Levees solid boundaries two adjacent cells. Pre-ELCOM implements levees adding additional ghost cells adjacent levee. ghost cells colocated wet cells.format levee set file essentially bc.dat file. set levee points defined unique reference number, type (one several keywords), title (user reference ), series cell (, j, k) coordinates.","code":""},{"path":"pre.html","id":"levee-set-categories","chapter":"Section 3 Pre-Processor","heading":"3.11.2 Levee set categories","text":"cell faces levees identified (, j, k) coordinates interior cell direction cell center levee. four valid keywords levee sets follows:","code":""},{"path":"pre.html","id":"organization-of-the-levee-set-file-levee.dat","chapter":"Section 3 Pre-Processor","heading":"3.11.3 Organization of the levee set file (levee.dat)","text":"top levee.dat file, user may include number comment lines. comment line must begin exclamation point ! contain least three items (.e., two words numbers separated ! spaces).initial comments, file contains series levee set definitions. set consists set identification line followed one cell definition lines. line must three items; otherwise, pre-processor fail Fortran file read error. Blank lines allowed.set identification line form: integer keyword title.\n- integer: reference number unique levee set\n- keyword: one valid keywords listed \n- title: user-designated name levee set (first word used code)cell definition consists three fields form:i_start:i_end j_start:j_end :\n, j integer values specifying rectangular box cells. third field must colon (:), indicating levee acts z values.example simple levee set definition might :","code":"107  levee_xp  levee_bank\n     3  4:15  :"},{"path":"pre.html","id":"sect-updateFile","chapter":"Section 3 Pre-Processor","heading":"3.12 Setting up the update file (update.dat) (Optional)","text":"","code":""},{"path":"pre.html","id":"introduction-4","chapter":"Section 3 Pre-Processor","heading":"3.12.1 Introduction","text":"update set file defines update cells domain. cells allow scalar values modified arbitrarily run-time using Update boundary condition files (see Update BC Files). format file essentially bc.dat file.set defined unique reference number, type (keyword), title (user reference), series (, j, k) cell coordinates.","code":""},{"path":"pre.html","id":"update-set-categories","chapter":"Section 3 Pre-Processor","heading":"3.12.2 Update set categories","text":"Update cells identified (, j, k) coordinates. valid keywords update sets :","code":""},{"path":"pre.html","id":"organization-of-the-update-set-file-update.dat","chapter":"Section 3 Pre-Processor","heading":"3.12.3 Organization of the update set file (update.dat)","text":"Comment lines may appear top file. comment must begin ! include least three items. blank lines allowed file.update set includes set identification line followed one cell definition lines. line must exactly three items avoid pre-processor errors.set identification line form: integer keyword title.\n- integer: unique reference number\n- keyword: one valid update keywords\n- title: user-designated name (first word used code)cell definition form:i_start:i_end j_start:j_end k_start:k_end\n, , j, k define rectangular box update cells.example simple update set definition might :","code":"12  update  tracer_release\n  3  4:15  2:4"},{"path":"pre.html","id":"running-the-pre-processor-with-run_pre.dat","chapter":"Section 3 Pre-Processor","heading":"3.13 Running the pre-processor with run_pre.dat","text":"--date copy run_pre.dat included examples.run_pre.dat file text file contains names paths user-supplied input files pre-processor output files. required input files :bathymetry.dat: describes lake bathymetry grid configurationbc.dat: defines boundary cell setsOptionally, may also include:update.datlevee.datThe pre-processor outputs two unformatted Fortran binary files:sparsedata.unfusedata.unfThese files may renamed user, must tracked carefully distinguish sparsedata usedata.run_pre.dat file place correct file paths names, pre-processor executed :","code":"pre_elcom.exe"},{"path":"elcom.html","id":"elcom","chapter":"Section 4 ELCOM Operartion","heading":"Section 4 ELCOM Operartion","text":"","code":""},{"path":"elcom.html","id":"introduction-5","chapter":"Section 4 ELCOM Operartion","heading":"4.1 Introduction","text":"Running ELCOM simulation requires user provide several types data:Initial conditionsTemporal boundary conditionsConfiguration parametersOutput controlELCOM obtains data user user-prepared input files pre-processor prepared input files.","code":""},{"path":"elcom.html","id":"files-for-elcom","chapter":"Section 4 ELCOM Operartion","heading":"4.2 Files for ELCOM","text":"ELCOM command-line executable communicates user files.\nTable 4.1 provides summary file types, whether presence required optional, purpose file, responsibility preparation file.File names courier bold font without brackets fixed named files (.e., file must present exactly name).File names [data_name].unf use square brackets indicate ELCOM may substitute various names bracketed section (see following sections).File names .db use angle brackets indicate sections file names user can customize command line.Table 4.1: Files ELCOM.","code":""},{"path":"elcom.html","id":"simulation-modules","chapter":"Section 4 ELCOM Operartion","heading":"4.3 Simulation modules","text":"ELCOM organized simulation modules can turned /depending type simulation desired. module turned /setting value control keywords. done within run_elcom.dat file. controls provide simple method modifying simulation.example: boundary condition file can set include meteorological data inflow data. simple test, user decides turn inflow. One approach return pre-processor, eliminate inflow boundary cell set, re-run pre-processor, modify temporal boundary condition file remove inflow data. simpler approach, user need set iflow = 0, inflow data boundary cell sets ignored.section provides brief overview modules within ELCOM corresponding keywords set within run_elcom.dat file.","code":""},{"path":"elcom.html","id":"stratification","chapter":"Section 4 ELCOM Operartion","heading":"4.3.1 Stratification","text":"Density stratification ELCOM can temperature, salinity, using controls itemperature isalinity combination idensity = 1. desired, temperature salinity can treated passive tracers setting idensity = 0. temperature /salinity turned , must initialized throughout simulation domain using default_*** controls, initial condition files, associated subroutines elcom_user.f90.","code":""},{"path":"elcom.html","id":"tracers","chapter":"Section 4 ELCOM Operartion","heading":"4.3.2 Tracers","text":"10 passive tracers may transported simulation. may initialized domain using initial condition files may flow domain inflow boundary using keywords TRACER_** temporal boundary condition file.","code":""},{"path":"elcom.html","id":"surface-thermodynamics","chapter":"Section 4 ELCOM Operartion","heading":"4.3.3 Surface thermodynamics","text":"module controls heat transfer across free surface. Required inputs (temporal boundary condition files) include: solar radiation, wind speed, air temperature, relative humidity.","code":""},{"path":"elcom.html","id":"rain","chapter":"Section 4 ELCOM Operartion","heading":"4.3.4 Rain","text":"rain module controls rain input free surface. Rain data m/day must provided temporal boundary condition file.","code":""},{"path":"elcom.html","id":"wind","chapter":"Section 4 ELCOM Operartion","heading":"4.3.5 Wind","text":"Wind affects ELCOM simulations three ways:Evaporative cooling surface thermodynamics moduleWind stress free surfaceWind-induced momentum source wind-mixed layerUse WIND_SPEED WIND_DIR (linked boundary cell set 0 uniform application) define multiple sections via section_top bc.dat. ELCOM interpolates wind speed direction time. Vector interpolation isn’t supported, consistent time intervals recommended. Alternatively, use WIND_U WIND_V.","code":""},{"path":"elcom.html","id":"inflowoutflow","chapter":"Section 4 ELCOM Operartion","heading":"4.3.6 Inflow/Outflow","text":"Inflow/outflow boundaries must defined bc.dat. Temporal boundary conditions flow rate must provided. Inflow conditions must also include scalar values.","code":""},{"path":"elcom.html","id":"conservation-of-background-potential-energy","chapter":"Section 4 ELCOM Operartion","heading":"4.3.7 Conservation of Background Potential Energy","text":"Numerical diffusion can destratify domain, increasing background potential energy. vertical sharpening filter can conserve energy mass. filter applies salinity (IFILTER = 2) temperature (IFILTER = 3). Alternatively, use FILTER_<SCALAR> run_elcom.dat IFILTER = 1. Temporally varying filters also supported.","code":""},{"path":"elcom.html","id":"bubble-plume-destratification","chapter":"Section 4 ELCOM Operartion","heading":"4.3.8 Bubble Plume Destratification","text":"simulate bubble destratification, define outlet locations bc.dat. Temporal boundary conditions must specify airflow rates number ports.","code":""},{"path":"elcom.html","id":"underflow","chapter":"Section 4 ELCOM Operartion","heading":"4.3.9 Underflow","text":"simulate dense inflow using Dallimore et al. (2001)’s 2D model, define inflow boundaries temporal conditions, including INFLOW_HEIGHT. Set IUNDERFLOW run_elcom.dat.Note: compatible CAEDYM.","code":""},{"path":"elcom.html","id":"water-age-modelling","chapter":"Section 4 ELCOM Operartion","heading":"4.3.10 Water Age Modelling","text":"Enable using IRETENTION run_elcom.dat. Water age starts zero increments del_t timestep. Transported scalar.","code":""},{"path":"elcom.html","id":"drifters-particles","chapter":"Section 4 ELCOM Operartion","heading":"4.3.11 Drifters / Particles","text":"Simulate Lagrangian semi-Lagrangian particles using NDRIFTERS run_elcom.dat. Define properties drifter_properties_file drifter_in_file. Updates via update_drifter_file.","code":""},{"path":"elcom.html","id":"jetspumps","chapter":"Section 4 ELCOM Operartion","heading":"4.3.12 Jets/Pumps","text":"simulate jet/pump destratification, provide thrust, radius, depth data jet files. Controlled via IJET run_elcom.dat.","code":""},{"path":"elcom.html","id":"drafttubes","chapter":"Section 4 ELCOM Operartion","heading":"4.3.13 Drafttubes","text":"destratification impellors draft tubes, specify thrust, radius, depth, tube length drafttube files. Controlled via ITUBE run_elcom.dat.","code":""},{"path":"elcom.html","id":"non-hydrostatic-code","chapter":"Section 4 ELCOM Operartion","heading":"4.3.14 Non-hydrostatic code","text":"simulate non-hydrostatic pressure effects (Bothel et al.), note finer horizontal resolution (~10m) required simulation runtime increases significantly.","code":""},{"path":"elcom.html","id":"sect:initfiles","chapter":"Section 4 ELCOM Operartion","heading":"4.4 Initialization","text":"","code":""},{"path":"elcom.html","id":"uniform-initial-conditions","chapter":"Section 4 ELCOM Operartion","heading":"4.4.1 Uniform initial conditions","text":"simple initial conditions (e.g., distributing scalar setting flat surface), use DEFAULT_**** keywords run_elcom.dat. Default values can overwritten profile horizontal files initialization subroutines.","code":""},{"path":"elcom.html","id":"vertical-profile","chapter":"Section 4 ELCOM Operartion","heading":"4.4.2 Vertical Profile","text":"Vertical scalar variation defined using initial_profile_file (infiles directory). Format:Four header lines:\nNumber datasets (excluding depth)\nNumber depths (first column DEPTH)\nj coordinates\nColumn keywords (first must DEPTH, rest valid scalar keywords)\nNumber datasets (excluding depth)Number depths (first column DEPTH)j coordinatesColumn keywords (first must DEPTH, rest valid scalar keywords)Data rows: Depth (meters) scalar values.Depths must start zero increase monotonically.Linear interpolation used simulation.Comments (!) can appear top file within data block. Comment rows headers must match column count.","code":"! Example: ic.dat\n2   data sets\n4   number of depths\n15 20   i,j\nDEPTH   WTR_TEMP    SALINITY\n0.0     25.0        0.0\n5.1     23.1        15.1\n6.2     20.2        35.0\n10.4    18.3        35.2"},{"path":"elcom.html","id":"sect:multiProf","chapter":"Section 4 ELCOM Operartion","heading":"4.4.3 Multiple Vertical Profiles","text":"increase flexibility initialization, ELCOM Version 2 allows multiple profile initial condition files. one initial condition file specified scalar, ELCOM interpolates files initialize domain. profile first linearly interpolated onto vertical layers, point horizontally interpolated using inverse distance weighting method \\[\nS_{,j,k} = \\sum_{n=1}^N \\frac{S_{n,k}r_{n}^\\alpha}{r_{n}^\\alpha}\n\\]\\(\\alpha\\) distance weighting specified flag IC_DIST_WEIGHTING run_elcom.dat (default = 2.0), \\(r\\) distance column profile \\(n\\), \\(N\\) number profiles.","code":""},{"path":"elcom.html","id":"horizontal-variation","chapter":"Section 4 ELCOM Operartion","heading":"4.4.4 Horizontal Variation","text":"horizontal variation initial conditions valid transportable scalar can defined using input file (keyword = initial_horiz_file). input file may name must located infiles directory.files require format consists three header lines followed value (,j) column domain. file may many comment lines (preceded !) top file desired. Comment lines within header data must many items columns (.e., 3 columns, valid comment line !  - -). comment lines allowed within columns data. columns must completely dense data (.e., may “missing” data row fewer items number columns).first header line contains two numbers: number x rows number y columns. must match number rows columns bathymetry file.second line gives land value land cells.third line header contains keyword describes scalar initialized. keyword valid transportable scalar given Valid Scalars table [Section 4.13].remaining lines file contain data. matrix size bathymetry data bathymetry file.","code":"! Example:  ic.dat\n8 13    xrows   yrows\n1e+16   land    val\nSALINITY\n1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16\n1e+16 1e+16   9.0   9.5 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16\n1e+16   8.1   8.5   9.3   9.5  10.0  10.2  11.0  11.6  11.8 1e+16 1e+16 1e+16\n1e+16   8.0   8.5   9.2   9.5  10.0  10.3  10.6  11.3  11.6  11.8  12.0 1e+16\n1e+16   8.0   8.5   9.1   9.3   9.5   9.5   9.7   9.8  10.0  10.2  11.2 1e+16\n1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16  10.0  10.0  10.5 1e+16\n1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16   9.1   9.2   9.5 1e+16\n1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16 1e+16"},{"path":"elcom.html","id":"user-subroutines","chapter":"Section 4 ELCOM Operartion","heading":"4.4.5 User subroutines","text":"ELCOM users willing modify compile source code, ability set complex initial conditions available addition code subroutines elcom_user.f90 file. subroutines file called appropriate user_init_*** control run_elcom.dat file non-zero.stub routines supplied ELCOM designed executed user_init_*** controls set 1. However, can modified user different initializations performed different values user_init_***.","code":""},{"path":"elcom.html","id":"configuration-controls","chapter":"Section 4 ELCOM Operartion","heading":"4.5 Configuration controls","text":"","code":""},{"path":"elcom.html","id":"time-step","chapter":"Section 4 ELCOM Operartion","heading":"4.5.1 Time step","text":"time step (keyword = del_t) number seconds simulation advances time simulation step.","code":""},{"path":"elcom.html","id":"number-of-steps","chapter":"Section 4 ELCOM Operartion","heading":"4.5.2 Number of steps","text":"total number time steps computed present simulation run set using keyword iter_max run_elcom.dat file.","code":""},{"path":"elcom.html","id":"start-date","chapter":"Section 4 ELCOM Operartion","heading":"4.5.3 Start date","text":"start date entered CWR Julian Day format, specifies year day using real number 7 digits left decimal place yyyyddd.ddd. first 4 digits year subsequent 3 digits Julian Day (days since January 1st). Hours, minutes, seconds represented fractions day (e.g., 1 January 1st, 2000 represented 2000001.041667).","code":""},{"path":"elcom.html","id":"cgm-tolerance","chapter":"Section 4 ELCOM Operartion","heading":"4.5.4 CGM tolerance","text":"CGM_TOL residual iteration conjugate gradient method (used free-surface solution) stopped.","code":""},{"path":"elcom.html","id":"turbulence","chapter":"Section 4 ELCOM Operartion","heading":"4.5.5 Turbulence","text":"stratified flow, base closure scheme can supplemented unstable mixing (iclosure = 1) algorithms. unstable mixing algorithm mixes momentum transported scalars vertical cells unstable gradient potential density exists (.e., Ri < 0.0).stratified flows driven surface wind, wind-mixed-layer closure scheme energy transport (iclosure = 6) recommended. approach computes turbulent kinetic energy due wind stirring, convective overturns, wind shear, uses compute vertical mixing.","code":""},{"path":"elcom.html","id":"output-frequency","chapter":"Section 4 ELCOM Operartion","heading":"4.6 Output frequency","text":"Outputs data controlled datablock file set iter_out_*** start_output_*** keywords. former controls time step interval providing output, latter controls first step output provided.","code":""},{"path":"elcom.html","id":"sect:runelcom.dat","chapter":"Section 4 ELCOM Operartion","heading":"4.7 Configuration using file run_elcom.dat","text":"--date copy run_elcom.dat included examples.ELCOM looks file run_elcom.dat local directory set configuration simulation run. run_elcom.dat configuration file controls execution optional modules models within ELCOM, allowing user set parameters govern physical numerical simulation.format file flexible: lines may occur order, items must present. Comment lines (preceded !) may occur anywhere file. Blank lines allowed file (code stops reading blank line). line (including comment lines) must least two items separated blank space.comment marker ! counts item, valid line !  ! ! -, !! (space ) valid.general format file series lines, line listing user setting followed keyword defines parameter. individual keywords settings explained briefly :","code":""},{"path":"elcom.html","id":"file-headers","chapter":"Section 4 ELCOM Operartion","heading":"4.7.1 File headers","text":"FILE: file name file (must run_elcom.dat)ANALYST: user name (must inside single quotes ' ')ORGANIZATION: user company name (must inside single quotes ' ')COMMENT: user comment (must inside single quotes ' ')CASE_KEYWORD: allows user add code executed particular simulation case. Must string without blank spaces enclosed single quotes.","code":""},{"path":"elcom.html","id":"simulation-module-controls","chapter":"Section 4 ELCOM Operartion","heading":"4.7.2 Simulation module controls","text":"iheat_input: controls surface thermodynamics\n0 = surface thermodynamics\n1 = surface thermodynamics model (input solar radiation measured; longwave model determined input keywords)\n0 = surface thermodynamics1 = surface thermodynamics model (input solar radiation measured; longwave model determined input keywords)iatmstability: controls atmospheric stability correction thermodynamics\n0 = correction\n1 = apply correction\n0 = correction1 = apply correctionirain: controls rainfall input\n0 = rain\n1 = rain enabled\n0 = rain1 = rain enablediflow: controls inflow/outflow (Dirichlet boundaries); overrides boundary condition files\n0 = inflow/outflow\n1 = inflow/outflow model 1\n0 = inflow/outflow1 = inflow/outflow model 1iunderflow: controls 2D underflow model; overrides boundary condition files\n0 = standard inflow modelling\n1 = use underflow model INFLOW_HEIGHT specified\n0 = standard inflow modelling1 = use underflow model INFLOW_HEIGHT specifiedibubbler: controls bubble plume destratification\n0 = bubble plume\n1 = enable destratification model\n0 = bubble plume1 = enable destratification modelitemperature: controls whether temperature transported\n0 = temperature\n1 = temperature scalar\n0 = temperature1 = temperature scalarisalinity: controls whether salinity transported\n0 = salinity\n1 = salinity scalar\n0 = salinity1 = salinity scalaridensity: controls inclusion buoyancy (density) simulation\n0 = buoyancy\n1 = use UNESCO equation state buoyancy\n0 = buoyancy1 = use UNESCO equation state buoyancyntracer: number passive tracers\n0 = none\n1 10 = number tracers initialized supplied via inflow\n0 = none1 10 = number tracers initialized supplied via inflowndrifters: number drifters particles\n0 = none\n≥1 = number drifters\n0 = none≥1 = number driftersijet: include jets/pumps\n0 = jets\n1 = simulate jets\n0 = jets1 = simulate jetsitube: include drafttube pump destratification\n0 = drafttubes\n1 = simulate drafttubes\n0 = drafttubes1 = simulate drafttubesICAEDYM: enable CAEDYM water quality module\n0 = \n1 = \n0 = off1 = onicoriolis: include Coriolis force bathymetry.dat latitude\n0 = \n1 = \n0 = off1 = oninonhydrostatic: use non-hydrostatic approximations Botelho et al. \n0 = hydrostatic\n1 = non-hydrostatic\n0 = hydrostatic1 = non-hydrostatic","code":""},{"path":"elcom.html","id":"initialization-and-update-options","chapter":"Section 4 ELCOM Operartion","heading":"4.7.3 Initialization and update options","text":"irestart: use restart file initial conditions\n0 = use\n1 = use file specified restart_in_file\n0 = use1 = use file specified restart_in_fileuser_init_u_vel: user subroutine x velocity\n0 = ignore\n1 = call user_u_init USER_START_U = 1\n0 = ignore1 = call user_u_init USER_START_U = 1user_init_v_vel: user subroutine y velocity\n0 = ignore\n1 = call user_v_init USER_START_V = 1\n0 = ignore1 = call user_v_init USER_START_V = 1user_init_w_vel: user subroutine z velocity\n0 = ignore\n1 = call user_w_init USER_START_W = 1\n0 = ignore1 = call user_w_init USER_START_W = 1user_init_temperature: user subroutine temperature\n0 = ignore\n1 = call user_temperature_init USER_START_TEMPERATURE = 1\n0 = ignore1 = call user_temperature_init USER_START_TEMPERATURE = 1user_init_salinity: user subroutine salinity\n0 = ignore\n1 = call user_salinity_init USER_START_SALINITY = 1\n0 = ignore1 = call user_salinity_init USER_START_SALINITY = 1user_init_tracer: user subroutine tracer\n0 = ignore\n1 = call user_tracer_init USER_START_TRACER = 1\n0 = ignore1 = call user_tracer_init USER_START_TRACER = 1user_init_height: user subroutine surface height\n0 = ignore\n1 = call user_height_init USER_START_HEIGHT = 1\n0 = ignore1 = call user_height_init USER_START_HEIGHT = 1user_init_extinction: user subroutine light extinction coefficient\n0 = ignore\n1 = call user_extinction_init USER_START_EXTINCTION = 1\n0 = ignore1 = call user_extinction_init USER_START_EXTINCTION = 1latitude: optional simulation latitude (overrides value bathymetry.dat)","code":""},{"path":"elcom.html","id":"turbulence-modeling","chapter":"Section 4 ELCOM Operartion","heading":"4.7.4 Turbulence modeling","text":"iclosure: controls type closure scheme used\n0 = constant eddy viscosity\n1 = closure model 1 (includes mixing unstable stratification)\n6 = wind-mixed layer model energy transport — RECOMMENDED\niclosure: controls type closure scheme used0 = constant eddy viscosity1 = closure model 1 (includes mixing unstable stratification)6 = wind-mixed layer model energy transport — RECOMMENDEDDIFFUSIVITY<SCALAR>: horizontal diffusivity scalar X Y (). <SCALAR> must uppercase valid.DIFFUSIVITY<SCALAR>: horizontal diffusivity scalar X Y (). <SCALAR> must uppercase valid.DIFFUSIVITY_X_<SCALAR>, DIFFUSIVITY_Y_<SCALAR>: horizontal diffusivities X Y directions separately.DIFFUSIVITY_X_<SCALAR>, DIFFUSIVITY_Y_<SCALAR>: horizontal diffusivities X Y directions separately.DEFAULT_DIFFUSIVITY: default horizontal diffusivity scalars; overridden scalar-specific settings.DEFAULT_DIFFUSIVITY: default horizontal diffusivity scalars; overridden scalar-specific settings.","code":""},{"path":"elcom.html","id":"meteorological-sensor-heights","chapter":"Section 4 ELCOM Operartion","heading":"4.7.5 Meteorological Sensor Heights","text":"WIND_SPEED_HEIGHT: height (m) wind speed measurements. Default 10 m.SCALAR_HEIGHT: height (m) air temperature humidity data. Default 10 m.","code":""},{"path":"elcom.html","id":"model-settings-and-controls","chapter":"Section 4 ELCOM Operartion","heading":"4.7.6 Model Settings and Controls","text":"mean_albedo: mean albedo waterdrag_btm_cd: bottom drag coefficientmodel_grav_damp_x: damping x-baroclinic termmodel_grav_damp_y: damping y-baroclinic term","code":""},{"path":"elcom.html","id":"scalar-maximum-and-minimum-for-debugging","chapter":"Section 4 ELCOM Operartion","heading":"4.7.7 Scalar Maximum and Minimum for Debugging","text":"min_<SCALAR> max_<SCALAR>: bounds debugging. <SCALAR> must uppercase.ihardlimit:\n0 = limits\n1 = apply scalar bounds\n0 = limits1 = apply scalar bounds","code":""},{"path":"elcom.html","id":"debugging-controls","chapter":"Section 4 ELCOM Operartion","heading":"4.7.8 Debugging controls","text":"debug_check:\n0 = \n1 = stop fatal\n2 = high check, stop fatal\n3 = high check, stop warning\n0 = off1 = stop fatal2 = high check, stop fatal3 = high check, stop warningdebug_print:\n0 = none\n1 = minimal\n2 = moderate\n10 = extensive\n0 = none1 = minimal2 = moderate10 = extensivedebug_point: sparse data index point debug outputdebug_baroclinic_x, debug_baroclinic_y:\n0 = \n1 = \n0 = off1 = ","code":""},{"path":"elcom.html","id":"output-frequency-1","chapter":"Section 4 ELCOM Operartion","heading":"4.7.9 Output Frequency","text":"iter_out_monitor: output interval monitoringiter_out_save: output interval saved simulationiter_out_restart: output interval restart files","code":""},{"path":"elcom.html","id":"output-start-time","chapter":"Section 4 ELCOM Operartion","heading":"4.7.10 Output Start Time","text":"start_output_monitor: time step start monitoring outputstart_output_save: time step start save filesstart_output_restart: time step start restart files","code":""},{"path":"elcom.html","id":"time-controls","chapter":"Section 4 ELCOM Operartion","heading":"4.7.11 Time Controls","text":"start_date_CWR: start Julian format yyyyddd.ddddel_t: time step (seconds)iter_max: max time steps","code":""},{"path":"elcom.html","id":"iterative-solver-controls","chapter":"Section 4 ELCOM Operartion","heading":"4.7.12 Iterative Solver Controls","text":"CGM_TOL: tolerance conjugate gradient methodCGM_MIN: minimum iterationsCGM_MAX: maximum iterations","code":""},{"path":"elcom.html","id":"scalar-filtering","chapter":"Section 4 ELCOM Operartion","heading":"4.7.13 Scalar Filtering","text":"IFILTER:\n1 = (default)\n2 = BPE filter salinity\n3 = BPE filter temperature\n1 = (default)2 = BPE filter salinity3 = BPE filter temperaturefilter_bPE_threshold: max BPE change (e.g., 1e-9 Lake Kinneret)filter_mass_threshold: max mass change (e.g., 1e-7 Lake Kinneret)FILTER<SCALAR>: constant filter value scalarDEFAULT_FILTER: default filter value scalars","code":""},{"path":"elcom.html","id":"default-values","chapter":"Section 4 ELCOM Operartion","heading":"4.7.14 Default Values","text":"DEFAULT_HEIGHT: default water height (m)DEFAULT_WIND_SPEED: default wind speed (m/s)DEFAULT_WIND_DIR: wind direction (degrees North)DEFAULT_<SCALAR>: default scalar valueDEFAULT_PAR_EXTINCTION, DEFAULT_NIR_EXTINCTION, DEFAULT_UVA_EXTINCTION, DEFAULT_UVB_EXTINCTION: extinction coefficientsDEFAULT_BC: boundary condition preset (1-9)","code":""},{"path":"elcom.html","id":"input-file-names","chapter":"Section 4 ELCOM Operartion","heading":"4.7.15 Input File Names","text":"3D_data_file, preprocessor_file: grid map filesinitial_profile_file, initial_horiz_file: initial condition filesboundary_condition_file, profile_boundary_condition_file: boundary filesupdate_file, filter_file: updates filter filesdrifter_properties_file, drifter_in_file, update_drifter_file: drifter configjet_file, drafttube_file: destratification devicesdatablock_file: output configuration","code":""},{"path":"elcom.html","id":"file-directories","chapter":"Section 4 ELCOM Operartion","heading":"4.7.16 File Directories","text":"infile_dir: directory input filesoutfile_unf_dir: binary output directoryoutfile_txt_dir: text output directory","code":""},{"path":"elcom.html","id":"output-file-names","chapter":"Section 4 ELCOM Operartion","heading":"4.7.17 Output File Names","text":"restart_save_file: base name save filesrestart_out_file: base name restart output","code":""},{"path":"elcom.html","id":"input-files","chapter":"Section 4 ELCOM Operartion","heading":"4.8 Input files","text":"","code":""},{"path":"elcom.html","id":"sparsedata.unf-and-usedata.unf","chapter":"Section 4 ELCOM Operartion","heading":"4.8.1 sparsedata.unf and usedata.unf","text":"files sparsedata.unf usedata.unf required files ELCOM. Fortran unformatted (binary) files produced pre-processor. user may rename files, must keep track file sparsedata file (3D_data_file) usedata file (preprocessor_file). ELCOM look files specified run_elcom.dat file. incorrect files used, simulation crash.","code":""},{"path":"elcom.html","id":"sect:tempBCfiles","chapter":"Section 4 ELCOM Operartion","heading":"4.8.2 Temporal boundary condition (1D) files","text":"one-dimensional temporal boundary condition files (boundary_condition_file) created user provide environmental forcing information varies time. files must follow specific format:Four header lines followed data columns.First column = time CWR format (yyyyddd.dd).row represents data specific time.Comment lines (starting !) may appear top.Header comment lines must number items data columns.comments allowed within data block.columns must fully populated (missing values).","code":""},{"path":"elcom.html","id":"header-line-meanings","chapter":"Section 4 ELCOM Operartion","heading":"4.8.2.1 Header line meanings:","text":"Number data columns (excluding time column).0 indicating CWR time format (first data column TIME).Boundary cell set reference numbers (bc.dat).Keywords describing type data column.Interpolation: ELCOM linearly interpolates provided time values match simulation time steps (del_t).","code":""},{"path":"elcom.html","id":"table-temporal-boundary-condition-data-types","chapter":"Section 4 ELCOM Operartion","heading":"4.8.2.2 Table: Temporal Boundary Condition Data-types","text":"","code":""},{"path":"elcom.html","id":"notes","chapter":"Section 4 ELCOM Operartion","heading":"4.8.2.3 Notes:","text":"INFLOW_MAXDEPTH INFLOW_MINDEPTH: allow control inflow depths, enabling inflow surface thalweg cell even surface level varies.GATE_<n>_TOP, GATE_<n>_BOTTOM, GATE_<n>_OPEN: specify selective withdrawal gates. n gate number (e.g. GATE_1_TOP), OPEN = 1 (open) 0 (closed). Flow distributed among open gates based area.features allow realistic simulation systems like reservoirs variable surface height dam withdrawal structures.","code":""},{"path":"elcom.html","id":"temporal-profile-boundary-condition-2d-files","chapter":"Section 4 ELCOM Operartion","heading":"4.8.3 Temporal profile boundary condition (2D) files","text":"two-dimensional temporal profile boundary condition files (profile_boundary_condition_file) used provide scalar boundary information varies time depth. files consist :Four header linesSections data, representing profile specific time","code":""},{"path":"elcom.html","id":"header-lines","chapter":"Section 4 ELCOM Operartion","heading":"4.8.3.1 Header lines:","text":"Number data sets per section (including DEPTH, excluding TIME row)Must contain 0 indicate CWR time format; data section starts TIMEBoundary cell set reference numbers (including TIME DEPTH) — file may apply one boundary setKeywords column (TIME, DEPTH, valid scalar keywords)","code":""},{"path":"elcom.html","id":"data-section","chapter":"Section 4 ELCOM Operartion","heading":"4.8.3.2 Data section:","text":"section contains:\n- One header row: profile time (yyyyddd.dd) number depths\n- One row DEPTH values (depths meters surface)\n- Subsequent rows: one per scalar, values depthAll sections must:\n- Contain number data rows (one per scalar)\n- Maintain order keywords per section","code":""},{"path":"elcom.html","id":"sect:updateBCfiles","chapter":"Section 4 ELCOM Operartion","heading":"4.8.4 Update boundary condition files","text":"update boundary condition files (update_file) used update scalar values boundaries specified time intervals (e.g., tracer releases). Format 1D temporal boundary condition files, except:Two TIME columns per row providedScalar values applied timesteps first second time columnIf timestep doesn’t fall within intervals, update applied.","code":""},{"path":"elcom.html","id":"sect:tempFiltFiles","chapter":"Section 4 ELCOM Operartion","heading":"4.8.5 Temporal filter constant files","text":"Temporal filter constant files (filter_file) provide time-varying filter constants scalars. follow format 1D temporal boundary condition files.Third header line still includes boundary cell set reference, ignoredAll keywords must valid transportable scalars","code":""},{"path":"elcom.html","id":"drifter-files","chapter":"Section 4 ELCOM Operartion","heading":"4.8.6 Drifter files","text":"","code":""},{"path":"elcom.html","id":"drifter-properties-files","chapter":"Section 4 ELCOM Operartion","heading":"4.8.6.1 Drifter Properties Files","text":"drifter properties file (drifter_properties_file) provides physical properties semi-Lagrangian drifters. Lagrangian particles simulated, file can blank.line contains four columns:ValueTarget drifters (e.g., :, n1:n2)Target components (e.g., :, n1:n2)Property keyword","code":""},{"path":"elcom.html","id":"valid-property-keywords","chapter":"Section 4 ELCOM Operartion","heading":"4.8.6.2 Valid property keywords:","text":"mass: mass component (kg)area: cross-sectional area (m²)length: vertical length (m)drag_cd: drag coefficientdistance: vertical distance probe base component base (m)","code":""},{"path":"elcom.html","id":"shape-keyword-values","chapter":"Section 4 ELCOM Operartion","heading":"4.8.6.3 shape keyword values:","text":"1 = sphere2 = cylinder3 = rectangle","code":""},{"path":"elcom.html","id":"type-keyword-values","chapter":"Section 4 ELCOM Operartion","heading":"4.8.6.4 type keyword values:","text":"1 = submerged — forced modeled water velocities2 = subsurface — forced surface wind shear velocity3 = surface — forced windTherefore example file drifters consisting five components (antenna, surface buoy, subsurface buoy, pole connecting drogue subsurface buoy drifter sails) may look something like:","code":"! - - - -\n! ! Example Drifter Properties File\n! ! NB each comment line should have 4 words\n! - - - -\n! Component 1 sail\n26.0   :    1    mass\n1.5    :    1    area\n1.0    :    1    length\n0.3    :    1    drag_cd\n0.0    :    1    distance\n3      :    1    shape\n1      :    1    type\n! Component 2 Pole\n3.0    :    2    mass\n0.001  :    2    area\n1.0    :    2    length\n0.3    :    2    drag_cd\n1.0    :    2    distance\n2      :    2    shape\n1      :    2    type\n! Component 3 sub-surface float\n0.2    :    3    mass\n0.2    :    3    area\n0.2    :    3    length\n0.3    :    3    drag_cd\n2.3    :    3    distance\n3      :    3    shape\n2      :    3    type\n! Component 4 surface float\n0.1    :    4    mass\n0.01   :    4    area\n0.1    :    4    length\n0.3    :    4    drag_cd\n2.5    :    4    distance\n3      :    4    shape\n3      :    4    type\n! Component 5 antennea\n1.0    :    5    mass\n0.01   :    5    area\n0.3    :    5    length\n0.3    :    5    drag_cd\n2.6    :    5    distance\n2      :    5    shape\n3      :    5    type"},{"path":"elcom.html","id":"drifter-initial-files","chapter":"Section 4 ELCOM Operartion","heading":"4.8.7 Drifter Initial Files","text":"drifter initial files (drifter_in_file) used provide initial conditions simulation properties drifters particles.line drifter_in_file contain three columns:\n1. value\n2. Target drifters (: , n1:n2 range)\n3. keyword specifies property set","code":""},{"path":"elcom.html","id":"valid-keywords","chapter":"Section 4 ELCOM Operartion","heading":"4.8.8 Valid keywords:","text":"start_t: starting timestep drifterstart_t: starting timestep drifterend_t: ending timestep drifterend_t: ending timestep driftersolution_method: type drifter\n1 = Drifter constant elevation\n2 = Drifter constant depth\n3 = Drifter constant density\n4 = Lagrangian Particle constant elevation\n5 = Lagrangian Particle constant depth\n6 = Lagrangian Particle constant density\n7 = 3D Lagrangian Particle\nsolution_method: type drifter1 = Drifter constant elevation2 = Drifter constant depth3 = Drifter constant density4 = Lagrangian Particle constant elevation5 = Lagrangian Particle constant depth6 = Lagrangian Particle constant density7 = 3D Lagrangian Particlebeach_method:\n1 = Remove drifter hits land\n2 = Drifter continues hits land\n> Note: Drifters always removed cross open boundary.\nbeach_method:1 = Remove drifter hits land2 = Drifter continues hits land\n> Note: Drifters always removed cross open boundary.cfl_max: maximum timestep drifter (sub-timestepped CFL > cfl_max)cfl_max: maximum timestep drifter (sub-timestepped CFL > cfl_max)drogue_density: density drogue/particle (used constant density solutions)drogue_density: density drogue/particle (used constant density solutions)centre_of_mass: distance centre mass bottom drogue (used constant density solutions)centre_of_mass: distance centre mass bottom drogue (used constant density solutions)depth: depth bottom drogue/particle (used constant depth solutions)depth: depth bottom drogue/particle (used constant depth solutions)start_i, start_j, start_k: starting position , j, k grid coordinates\nExample: start_i = 8.5, start_j = 8.5, start_k = 5.5 places drifter center cell (= 8, j = 8, k = 5)\nstart_i, start_j, start_k: starting position , j, k grid coordinatesExample: start_i = 8.5, start_j = 8.5, start_k = 5.5 places drifter center cell (= 8, j = 8, k = 5)start_x, start_y, start_z: starting position physical x, y, z coordinatesstart_x, start_y, start_z: starting position physical x, y, z coordinatesstart_cell: starting cell number (1D sparse array)start_cell: starting cell number (1D sparse array)example file may look something like:","code":"! - - - -\n! ! Example Drifter Initial File\n! ! NB each comment line should have 3 words\n! - - - -\n8.5    :    start_i\n14.5   :    start_j\n6.7    :    start_k\n2      :    solution_method\n2      :    beach_method\n1.5    :    depth"},{"path":"elcom.html","id":"drifter-update-files","chapter":"Section 4 ELCOM Operartion","heading":"4.8.9 Drifter Update Files","text":"drifter update files (update_drifter_file) used update drifter positions solution methods simulation. files primarily designed incorporate real-time position updates measurements.format standard update boundary condition files, except:\n- third header line contains drifter number instead boundary condition set number.\n- update applied specified drifter timesteps two time values row.current timestep two specified time values row, update made.","code":""},{"path":"elcom.html","id":"valid-keywords-for-updates","chapter":"Section 4 ELCOM Operartion","heading":"4.8.10 Valid keywords for updates:","text":"solution_method: (see earlier method options)beach_method: (see earlier options)cfl_max: maximum timestep (drifter sub-timestepped CFL > cfl_max)drogue_density: density drogue/particle (constant density mode)centre_of_mass: vertical offset bottom drogue center massdepth: depth drogue/particle (constant depth solutions), j, k: updated grid coordinates drifter positionx, y, z: updated physical coordinatescell: updated cell index 1D sparse arrayAn example file may look something like:","code":"! - - - -\n! ! Example Drifter Update File\n! ! NB each comment line  should have 3 words\n! - - - -\n2 data sets\n0 seconds between data\n0          0          1   1\nTIME       TIME       i   j\n2005001.50 2005001.60 6.7 7.2"},{"path":"elcom.html","id":"jet-files","chapter":"Section 4 ELCOM Operartion","heading":"4.8.11 Jet Files","text":"jet files (jet_file) used define properties jet pump employed artificial destratification.files must follow specific format:Three header linesFour columns dataData corresponds specific instants time applies particular jetComments (!) allowed top fileAll data rows must fully populated — missing values allowed","code":""},{"path":"elcom.html","id":"header-line-definitions","chapter":"Section 4 ELCOM Operartion","heading":"4.8.11.1 Header line definitions:","text":"Jet reference number (used debugging purposes )j location jet (two integers)Column headers data followsNote: expected structure third header line data columns can include variables like time, thrust, radius, depth height depending configuration, although specified completely original text.four data colums ","code":" TIME THRUST RADIUS DEPTH TIME THRUST RADIUS HEIGHT"},{"path":"elcom.html","id":"data-column-descriptions-jet-files","chapter":"Section 4 ELCOM Operartion","heading":"4.8.11.2 Data Column Descriptions (Jet Files)","text":"TIME: date CWR Julian Day format (yyyyddd.ddd)THRUST: Force pump NewtonsRADIUS: Radius pump metresDEPTH HEIGHT: Either depth pump surface level height bottom (metres)","code":"! - - - -\n! Example Jet File\n! - - - -\n1 jet ID number\n6 12 i,j location of jet data\nTIME      THRUST RADIUS DEPTH\n2005001.0 3000   2.0    2.2\n2005011.0 3000   2.0    2.2"},{"path":"elcom.html","id":"drafttube-files","chapter":"Section 4 ELCOM Operartion","heading":"4.8.12 Drafttube Files","text":"drafttube files (drafttube_file) used define properties pump drafttube used artificial destratification.files must follow structure:Three header linesFive columns dataEach row provides values specific time instances single deviceComment lines (starting !) may appear top fileAll data columns must complete — missing values row","code":""},{"path":"elcom.html","id":"header-line-definitions-1","chapter":"Section 4 ELCOM Operartion","heading":"4.8.12.1 Header line definitions:","text":"drafttube reference number (used debugging )Two integers indicating j location deviceA line containing column headers data followsNote: exact headers data columns (e.g., TIME, THRUST, RADIUS, DEPTH, LENGTH) follow third line, depending specified simulation setup.four data colums \n#### Data Column Descriptions (Drafttube Files)TIME: date CWR Julian Day format (yyyyddd.ddd)FLOW: Flow rate pump m³/sNote: value negative (.e., pumping downward tube).RADIUS: Radius pump tube metresDEPTH: Depth pump surface level (metres)LENGTH: Length draft tube metres","code":" TIME FLOW RADIUS DEPTH LENGTH! - - - -\n! Example drafttube File\n! - - - -\n1 drafttube ID number\n6 12 i,j location of jet data\nTIME      FLOW RADIUS DEPTH  LENGTH\n2005001.0 -5   2.0    2.2    5.0\n2005011.0 -5   2.0    2.2    5.0"},{"path":"elcom.html","id":"definition-of-culvert-characteristics-dynamic-boundary-conditions","chapter":"Section 4 ELCOM Operartion","heading":"4.9 Definition of Culvert Characteristics – Dynamic Boundary Conditions","text":"dynamic boundary conditions defined pre_elcom, characteristics culvert connecting pair boundary conditions must provided. characteristics supplied file specified run_elcom.dat using keyword dynamic_boundary_condition_file.files require:\n- Three header lines\n- One line listing culvert characteristics defined\n- One data rows culvertHeader Format:\n1. Two values – boundary condition reference numbers (defined pre_elcom)\n2. One value – number characteristics specified (3 12)\n3. One value – number pipes set (circular pipes supported)\n4. One line – column headers culvert characteristics","code":""},{"path":"elcom.html","id":"supported-culvert-keywords-and-defaults","chapter":"Section 4 ELCOM Operartion","heading":"4.9.1 Supported Culvert Keywords and Defaults","text":"","code":""},{"path":"elcom.html","id":"example-file","chapter":"Section 4 ELCOM Operartion","heading":"4.9.2 Example File","text":"","code":"! Boundary Condition file for Culverts\n2 1 ! Pair of dynamic sets\n7   ! data sets\n10  ! number of pipes\nEPS_ENTRY  EPS_EXIT EPS_FLAP_IN  PIPE_PHI  PIPE_LEN  PIPE_MAN  PIPE_HEIGHT\n0.500      1.000      0.100      0.500     15.0       0.015       2.750"},{"path":"elcom.html","id":"sect:datablock","chapter":"Section 4 ELCOM Operartion","heading":"4.9.3 Output definition file (Datablock.db)","text":"file datablock.db text file produced user, contains configuration data used set users output. name file specified user.datablock.db file structured series blocks instructions. block requires exact number lines, specific instructions line. line contains single instruction followed comment. comment must begin “!” character. manually editing datablock.db files, important keep mind blocks instructions may added removed, lines within block can modified, removed. following discuss structure block instructions.","code":""},{"path":"elcom.html","id":"datablock-description","chapter":"Section 4 ELCOM Operartion","heading":"4.9.3.1 Datablock Description","text":"first 4 lines datablock.db datablock description. order, block descriptor, current datablock version number, number output groups, number output sets. Output groups sets described .","code":""},{"path":"elcom.html","id":"group-description","chapter":"Section 4 ELCOM Operartion","heading":"4.9.3.2 Group Description","text":"Following datablock description group description blocks. group represents group data output. data group defined output filename, datatypes output (.e. TEMPERATURE, SALINITY, etc…), location within simulation domain points data output, time data output. several groups desired, group descriptions must follow without breaks .group description block contains 11 lines, follows:","code":""},{"path":"elcom.html","id":"set-description","chapter":"Section 4 ELCOM Operartion","heading":"4.9.3.3 Set Description","text":"set set points data output. can include vertical column points, contiguous series columns points (curtain), horizontal sheet points, collection drifters, collection outflows, group points three-dimensional domain. valid set types :Profiles curtains require (x, y) locations base column describe location. Sheets can referenced layer, height user datum, height bottom, height free-surface. Drifters referenced drifter number 1 n_drifters. OUTFLOW outputs total flow average scalar concentrations flow domain. Outflows referred bc reference number bc.dat. ALL_3D simply outputs points domain, GENERAL_3D points whose coordinates individually specified.set description block contains 16 lines, follows:","code":"PROFILE_1D  \nCURTAIN_2D  \nSHEET_2D  \nDRIFTER  \nOUTFLOW  \nALL_3D  \nGENERAL_3D  "},{"path":"elcom.html","id":"group-data-types","chapter":"Section 4 ELCOM Operartion","heading":"4.9.3.4 4 Group data types","text":"block begins desired number data types, followed listing desired data types.Underflow Variables:DRIFTER set types value output value location bottom drifter.OUTFLOW set types scalar value output average value total flow .Note: Scalar actually estimated using first-order upwind scheme rather actual ULTIMATE-QUICKEST flux values.","code":"<TEMPERATURE>\n<SALINITY>\nU_VELOCITY\nV_VELOCITY\nW_VELOCITY\nDENSITY\nEXTINCTION\nF_PRESSURE\nT_PRESSURE\nRI\nSHEAR\nMIX_ENERGY\nMIX_FRACTION\nMIX_REGIME\nSHEAR_ENERGY\nWIND_ENERGY\nBBL_ENERGY\nDISSIPATION\nRETENTION_T\nHEIGHT\nSLOPE_X\nSLOPE_Y\nWIND_SPEED\nWIND_DIR\nWIND_U\nWIND_V\nRAIN\nREL_HUM\nLW_RAD_IN\nLW_RAD_NET\nSOLAR_RAD\nATM_PRESS\nCLOUDS\nAIR_TEMP\nAUX_1\nAUX_2\nAUX_3\nAUX_4\nAUX_5\nEVAP_VOL_FLUX\nEVAP_MASS_FLUX\nEVAP_HEAT_FLUX\nSENS_HEAT_FLUX\nHUMIDITY_ALT\nHUMIDITY_SURF\nC_WIND\nC_HEAT<SCALAR>_UND\nH_UND\nU_UND\nV_UND\nDENSITY_UND\nPRESSURE_UND\nE_COEFF_UND\nRI_UND\nE_VOLUME_UND\nE_VEL_XS_UND\nXP_F_UND_INDEX\nYP_F_UND_INDEX\nXN_F_UND_INDEX\nYN_F_UND_INDEX"},{"path":"elcom.html","id":"group-time-list","chapter":"Section 4 ELCOM Operartion","heading":"4.9.4 5 Group Time List","text":"block required initialize time stamp group. requires two lines follows:","code":""},{"path":"elcom.html","id":"set-cell-data","chapter":"Section 4 ELCOM Operartion","heading":"4.9.5 6 Set Cell Data","text":"block describes spatial location datablock set. locations described row, column, /layer number.Set type-specific input formats:PROFILE:\nprofile requires row input. row requires 4 integers:x-row, y-column, 0, 0PROFILE:\nprofile requires row input. row requires 4 integers:x-row, y-column, 0, 0CURTAIN_2D:\nprofile making curtain requires row input. row requires 4 integers:x-row, y-column, 0, 0CURTAIN_2D:\nprofile making curtain requires row input. row requires 4 integers:x-row, y-column, 0, 0SHEET_2D:\ninput required.SHEET_2D:\ninput required.DRIFTER:\ndrifters output. row requires 4 integers:drifter number, 0, 0, 0DRIFTER:\ndrifters output. row requires 4 integers:drifter number, 0, 0, 0OUTFLOW:\nbc sets output. row requires 4 integers:bcset number (bc.dat), 0, 0, 0OUTFLOW:\nbc sets output. row requires 4 integers:bcset number (bc.dat), 0, 0, 0ALL_3D:\ninput required.ALL_3D:\ninput required.GENERAL_3D:\npoint requires row input. row requires 3 integers:x-row, y-column, z-layerGENERAL_3D:\npoint requires row input. row requires 3 integers:x-row, y-column, z-layer","code":""},{"path":"elcom.html","id":"sect:runexe","chapter":"Section 4 ELCOM Operartion","heading":"4.10 Running ELCOM","text":"ELCOM executed command line typing elcom.exe within directory run_elcom.dat appropriate input data files located. monitoring/debugging output sent standard output computer (display terminal computers). Unless simulation run short, recommended user redirect output file execution redirection :","code":"elcom.exe >& run_output.txt"},{"path":"elcom.html","id":"sect:postproc","chapter":"Section 4 ELCOM Operartion","heading":"4.10.1 Post-Processing","text":"","code":""},{"path":"elcom.html","id":"conversion-of-datablock-file-to-netcdf","chapter":"Section 4 ELCOM Operartion","heading":"4.10.1.1 Conversion of datablock file to NETCDF","text":"datablock output files named configured datablock.db file. ELCOM produces Fortran unformatted (binary) files specified datablock output configuration. general, one datablock output file contains one data types (e.g. velocity, temperature) applied set points specified time interval. files can reprocessed NETCDF files using command-line program dbconv.exe.program dbconv.exe used converting datablock unformatted binary files created ELCOM NETCDF files can processed viewed program Matlab. dbconv.exe executable placed either working directory recommended /bin directory operating system’s search path. dbconv run configuration file called run_dbconv.dat.run_dbconv.dat file contains 9 lines follows:example run_dbconv.dat file :run_dbconv.dat file correctly configured, dbconv can executed command line typing:Notes:run_dbconv.dat can file name, however correct file name must invoked run time.run_dbconv.dat can configured one file time.batch processing several .unf files, recommended run_dbconv.dat file created .unf converted dbconv.exe invoked run_dbconv.dat using batch file.","code":" Comment line, up to 64 characters\n .unf file name and path\n sparsedata.unf file name and path\n .nc netcdf output file name and path\n Start time step, -1 for beginning\n End time step, -1 for end of file\n Overwriting of .nc file? -  clobber for overwriting, no_clobber for no overwriting\n Output mapping info to text file? -  map for writing, no_map for no overwriting\n Output diagnosics to monitor?  -  echo to output to monitor, no_echo to not output to monitor Example dbconv\n unfiles/curtain.unf\n infiles/sparsedata.unf\n ncfiles/curtain.nc\n -1\n -1\n clobber\n no_map\n no_echodbconv.exe run_dbconv.dat"},{"path":"elcom.html","id":"save-and-restart-output-files","chapter":"Section 4 ELCOM Operartion","heading":"4.11 Save and Restart output files","text":"Save Restart output files Fortran unformatted (binary) files contain run configuration information used allow user restart ELCOM runs certain point. described run_elcom.dat section, kernel name output frequency save restart files defined run_elcom.dat file.save files created starting time step specified value assigned run_elcom.dat keyword start_output_save, subsequently intervals defined iter_out_save. file name save files begins user-specified kernel, given restart_save_file, appended time stamp, appended .unf.restart files created intervals defined iter_out_restart, starting first time step. Subsequent restart files overwrite existing restart files. file name restart files begins user-specified kernel, given restart_out_file, appended .unf. start restart files written outfiles directory specified run_elcom.dat file.restart ELCOM simulation using save restart file, user must place copy desired save restart file infiles directory specified run_elcom.dat file. run_elcom.dat file name desired save restart file must assigned restart_infile keyword, keyword irestart must assigned value 1.","code":""},{"path":"elcom.html","id":"culvert-outputs---dynamic-boundary-conditions","chapter":"Section 4 ELCOM Operartion","heading":"4.12 Culvert Outputs - Dynamic Boundary Conditions","text":"current implementation, flow rates scalars calculated pipe pairs dynamic boundary condition sets output ASCII file located outfile_txt_dir directory.output files named culvert_bcset_[$set$]., $set$ dynamic boundary condition sets present simulation.format files follows. 16 header lines explain format file.percentage symbols beginning text line used make easier load numeric data Matlab environment.next 7 lines give set pipe information.First line gives number pipes (n) dynamic boundary condition output set. information repeats n times easier loading Matlab.Second line gives first defined set reference number dynamic boundary condition output set ref 1. information repeats n times.Third line gives second defined set reference number dynamic boundary condition output set ref 2. information repeats n times.Fourth line gives bottom height pipes boundary condition set.Fifth line gives pipe diameter pipes dynamic boundary condition output set.Sixth line gives number transportable scalars used simulation. information repeats n times.Seventh line gives names transportable scalars used simulation. information repeats n times line preceded percentage symbol., time step simulation, 7 + number scalars lines output.First line gives time step output t. information repeats n times.Second line gives water height upstream cell dynamic boundary condition set time step t. Repeats n times.Third line gives water height downstream cell dynamic boundary condition set time step t. Repeats n times.Fourth line gives sum flow pipes dynamic boundary condition set time step t. Repeats n times.Fifth line tells shift direction flow. value 1 means shift (flow cells defined reference set ref 2 ref 1), value 0 means shift. Repeats n times.Sixth line gives flow regime pipes (see science manual description flow regimes).Seventh line gives flow pipes., number scalars lines output transportable scalars defined header.","code":" % number of pipes in set = n (repeats n times)\n % set ref 1 (repeats n times)\n % set ref 2 (repeats n times)\n % pipe heights 1 to n\n % pipe diameters 1 to n\n % number of scalars (repeats n times)\n % names of scalars (repeats n times)\n % Then, for each time step\n % time step (repeats n times)\n % height set upstream\n % height set downstream (repeats n times)\n % total flow (repeats n times)\n % shift in set (repeats n times)\n % regime pipe 1 to n\n % flow pipe 1 to n\n % each scalars flowing through the culverts (repeats n times) % flow pipe 1 to n\n % each scalar flowing through the culverts (repeats n times)"},{"path":"elcom.html","id":"tab:validScalars","chapter":"Section 4 ELCOM Operartion","heading":"4.13 ELCOM Valid Scalars","text":"","code":""},{"path":"notation.html","id":"notation","chapter":"Section 5 Notation","heading":"Section 5 Notation","text":"Table ?? shows variable notation used throughout.","code":""},{"path":"applications.html","id":"applications","chapter":"Section 6 Applications","heading":"Section 6 Applications","text":"significant applications demonstrated chapter.","code":""},{"path":"applications.html","id":"example-one","chapter":"Section 6 Applications","heading":"6.1 Example one","text":"","code":""},{"path":"applications.html","id":"example-two","chapter":"Section 6 Applications","heading":"6.2 Example two","text":"","code":""},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
